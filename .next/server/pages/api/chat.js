"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/chat";
exports.ids = ["pages/api/chat"];
exports.modules = {

/***/ "@ai-sdk/openai":
/*!*********************************!*\
  !*** external "@ai-sdk/openai" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@ai-sdk/openai");

/***/ }),

/***/ "ai":
/*!*********************!*\
  !*** external "ai" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("ai");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "zod":
/*!**********************!*\
  !*** external "zod" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("zod");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fchat%2Findex.ts&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fchat%2Findex.ts&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/chat/index.ts */ \"(api)/./pages/api/chat/index.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/chat\",\n        pathname: \"/api/chat\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_chat_index_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNoYXQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyUyRmFwaSUyRmNoYXQlMkZpbmRleC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUNzRDtBQUN0RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMscURBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHFEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYXZlbC1yaXp6Lz80ODY3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvY2hhdC9pbmRleC50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXRcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fchat%2Findex.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./ai/tools.ts":
/*!*********************!*\
  !*** ./ai/tools.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   budgetSelectorTool: () => (/* binding */ budgetSelectorTool),\n/* harmony export */   carouselTool: () => (/* binding */ carouselTool),\n/* harmony export */   currencyConverterTool: () => (/* binding */ currencyConverterTool),\n/* harmony export */   datePickerTool: () => (/* binding */ datePickerTool),\n/* harmony export */   detailsCardTool: () => (/* binding */ detailsCardTool),\n/* harmony export */   languageSelectorTool: () => (/* binding */ languageSelectorTool),\n/* harmony export */   placeCardTool: () => (/* binding */ placeCardTool),\n/* harmony export */   preferenceSelectorTool: () => (/* binding */ preferenceSelectorTool),\n/* harmony export */   quickResponseTool: () => (/* binding */ quickResponseTool),\n/* harmony export */   savedPlacesListTool: () => (/* binding */ savedPlacesListTool),\n/* harmony export */   stageProgressTool: () => (/* binding */ stageProgressTool),\n/* harmony export */   tools: () => (/* binding */ tools),\n/* harmony export */   transportSelectorTool: () => (/* binding */ transportSelectorTool),\n/* harmony export */   weatherChartTool: () => (/* binding */ weatherChartTool)\n/* harmony export */ });\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ai */ \"ai\");\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ai__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"zod\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(zod__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _managers_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../managers/types */ \"(api)/./managers/types.ts\");\n/* harmony import */ var _utils_places_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/places-utils */ \"(api)/./utils/places-utils.ts\");\n/* harmony import */ var _managers_stage_manager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../managers/stage-manager */ \"(api)/./managers/stage-manager.ts\");\n/* harmony import */ var _utils_currency_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/currency-utils */ \"(api)/./utils/currency-utils.ts\");\n\n\n\n\n\n\n// Tool for Budget Selection\nconst budgetSelectorTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display budget level options for the trip. Use this when discussing trip costs or when the user wants to set their budget preference.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        currentBudget: zod__WEBPACK_IMPORTED_MODULE_1__.z.enum([\n            \"$\",\n            \"$$\",\n            \"$$$\",\n            \"$$$$\"\n        ]).optional()\n    }),\n    execute: async function({ currentBudget }) {\n        return {\n            type: \"budgetSelector\",\n            props: {\n                currentBudget: currentBudget\n            }\n        };\n    }\n});\n// Tool for Travel Preferences\nconst preferenceSelectorTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display options for selecting travel preferences and interests.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        currentPreferences: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.nativeEnum(_managers_types__WEBPACK_IMPORTED_MODULE_2__.TravelPreference)).optional()\n    }),\n    execute: async function({ currentPreferences }) {\n        return {\n            type: \"preferenceSelector\",\n            props: {\n                currentPreferences: currentPreferences\n            }\n        };\n    }\n});\n// Tool for Date Selection\nconst datePickerTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display a date picker for selecting travel dates.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        startDate: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n        endDate: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional()\n    }),\n    execute: async function({ startDate, endDate }) {\n        return {\n            type: \"datePicker\",\n            props: {\n                startDate,\n                endDate\n            }\n        };\n    }\n});\n// Tool for Language Selection\nconst languageSelectorTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display language selection options.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        currentLanguage: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional()\n    }),\n    execute: async function({ currentLanguage }) {\n        return {\n            type: \"languageSelector\",\n            props: {\n                currentLanguage: currentLanguage\n            }\n        };\n    }\n});\n// Tool for Transport Selection\nconst transportSelectorTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display transport method selection options. Use this when discussing transportation options for the trip, such as flights, trains, or car rentals.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        selectedMethod: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional()\n    }),\n    execute: async function({ selectedMethod }) {\n        return {\n            type: \"transportSelector\",\n            props: {\n                selectedMethod\n            }\n        };\n    }\n});\n// Tool for Place Display\nconst placeCardTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: 'Display information about one specific place. Use this whenever the user explicitly asks for ONE place, whether by name or type (e.g., \"show me one theatre\", \"show me one restaurant\", \"show me The Little Mermaid statue\").',\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        searchText: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().describe(\"The name or description of the place to search for\"),\n        location: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n            latitude: zod__WEBPACK_IMPORTED_MODULE_1__.z.number(),\n            longitude: zod__WEBPACK_IMPORTED_MODULE_1__.z.number()\n        }),\n        destination: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().describe(\"Name of the destination city\")\n    }),\n    execute: async function({ searchText, location, destination }) {\n        try {\n            const place = await (0,_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.searchPlaceByText)(searchText, location, destination);\n            if (!place) {\n                console.error(\"No place found for search text:\", searchText);\n                return {\n                    type: \"placeCard\",\n                    props: {\n                        place: null\n                    },\n                    error: \"Could not find a unique place. Try searching for something else.\"\n                };\n            }\n            return {\n                type: \"placeCard\",\n                props: {\n                    place\n                }\n            };\n        } catch (error) {\n            console.error(\"Error searching for place:\", error);\n            return {\n                type: \"placeCard\",\n                props: {\n                    place: null\n                }\n            };\n        }\n    }\n});\n// Tool for Place Carousel\nconst carouselTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display multiple places in a carousel based on preferences or specific place types and automatically save them into savedPlaces.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        preferences: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.nativeEnum(_managers_types__WEBPACK_IMPORTED_MODULE_2__.TravelPreference)).optional(),\n        placeType: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional().describe(\"Specific place type to search for\"),\n        location: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n            latitude: zod__WEBPACK_IMPORTED_MODULE_1__.z.number(),\n            longitude: zod__WEBPACK_IMPORTED_MODULE_1__.z.number()\n        }),\n        maxResults: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().optional().default(5)\n    }),\n    execute: async function({ preferences, placeType, location, maxResults }) {\n        try {\n            let places = [];\n            if (preferences && preferences.length > 0) {\n                // Use our existing function to get places by preference\n                places = await (0,_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.fetchPlaces)(location.latitude, location.longitude, preferences, maxResults);\n            } else if (placeType) {\n                // Search by specific place type\n                places = await (0,_utils_places_utils__WEBPACK_IMPORTED_MODULE_3__.fetchPlaces)(location.latitude, location.longitude, undefined, maxResults, [\n                    placeType\n                ]);\n            }\n            return {\n                type: \"carousel\",\n                props: {\n                    places\n                }\n            };\n        } catch (error) {\n            console.error(\"Error in carousel tool:\", error);\n            return {\n                type: \"carousel\",\n                props: {\n                    places: []\n                }\n            };\n        }\n    }\n});\n// Tool for Details Card\nconst detailsCardTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display travel details summary. Use this when the user wants to view a summary of their trip details, including destination, dates, preferences, budget, and more.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        content: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n            destination: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n            dates: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n                startDate: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n                endDate: zod__WEBPACK_IMPORTED_MODULE_1__.z.string()\n            }).optional(),\n            preferences: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.string()).optional(),\n            budget: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n            language: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n            transport: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.string()).optional(),\n            dining: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.string()).optional()\n        })\n    }),\n    execute: async function({ content }) {\n        return {\n            type: \"detailsCard\",\n            props: {\n                content\n            }\n        };\n    }\n});\nconst weatherChartTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display historical weather data including temperature and precipitation for a location.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        lat: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().min(-90).max(90).describe(\"Latitude of the location\"),\n        lon: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().min(-180).max(180).describe(\"Longitude of the location\"),\n        city: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().describe(\"City name for display\"),\n        startDate: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().describe(\"Trip start date in DD/MM/YYYY format\"),\n        endDate: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().describe(\"Trip end date in DD/MM/YYYY format\"),\n        units: zod__WEBPACK_IMPORTED_MODULE_1__.z.enum([\n            \"us\",\n            \"uk\",\n            \"metric\"\n        ]).optional().default(\"metric\")\n    }),\n    execute: async function({ lat, lon, city, startDate, endDate, units = \"metric\" }) {\n        // Parse DD/MM/YYYY dates\n        const [startDay, startMonth, startYear] = startDate.split(\"/\").map(Number);\n        const [endDay, endMonth, endYear] = endDate.split(\"/\").map(Number);\n        // Format dates for API (YYYY-MM-DD)\n        const formattedStartDate = `${startYear}-${String(startMonth).padStart(2, \"0\")}-${String(startDay).padStart(2, \"0\")}`;\n        const formattedEndDate = `${endYear}-${String(endMonth).padStart(2, \"0\")}-${String(endDay).padStart(2, \"0\")}`;\n        // Calculate number of days in the range\n        const start = new Date(formattedStartDate);\n        const end = new Date(formattedEndDate);\n        const daysDiff = Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)) + 1;\n        // Calculate how many extra days we need for 30 days total\n        const extraDays = Math.max(0, 30 - daysDiff);\n        const daysToAddBefore = Math.floor(extraDays / 2);\n        const daysToAddAfter = extraDays - daysToAddBefore;\n        // Extend dates to get 30 days\n        start.setDate(start.getDate() - daysToAddBefore);\n        end.setDate(end.getDate() + daysToAddAfter);\n        // Format extended dates for API\n        const extendedStartDate = start.toISOString().split(\"T\")[0];\n        const extendedEndDate = end.toISOString().split(\"T\")[0];\n        console.log(\"[weatherChartTool] Date conversion:\", {\n            originalDate: startDate,\n            originalEndDate: endDate,\n            formattedStartDate: extendedStartDate,\n            formattedEndDate: extendedEndDate,\n            totalDays: 30,\n            originalRange: daysDiff,\n            addedBefore: daysToAddBefore,\n            addedAfter: daysToAddAfter\n        });\n        return {\n            type: \"weatherChart\",\n            props: {\n                lat,\n                lon,\n                city,\n                startDate: extendedStartDate,\n                endDate: extendedEndDate,\n                units\n            }\n        };\n    }\n});\nconst savedPlacesListTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: 'Display all currently saved places in a list view. When user asks to see saved places (e.g. \"show me my saved places\", \"what places have I saved\", etc), pass ALL places from the savedPlaces parameter to this tool.',\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        savedPlaces: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n            id: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n            displayName: zod__WEBPACK_IMPORTED_MODULE_1__.z.union([\n                zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n                    text: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n                    languageCode: zod__WEBPACK_IMPORTED_MODULE_1__.z.string()\n                }),\n                zod__WEBPACK_IMPORTED_MODULE_1__.z.string()\n            ]).optional(),\n            primaryType: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n            location: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n                latitude: zod__WEBPACK_IMPORTED_MODULE_1__.z.number(),\n                longitude: zod__WEBPACK_IMPORTED_MODULE_1__.z.number()\n            }).optional(),\n            formattedAddress: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n            photos: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n                name: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n                widthPx: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().optional(),\n                heightPx: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().optional(),\n                authorAttributions: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n                    displayName: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n                    uri: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional(),\n                    photoUri: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().optional()\n                })).optional() // Make optional\n            })).optional().default([]),\n            primaryTypeDisplayName: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n                text: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n                languageCode: zod__WEBPACK_IMPORTED_MODULE_1__.z.string()\n            }).optional() // Already optional\n        }))\n    }),\n    execute: async function({ savedPlaces }) {\n        console.log(\"[savedPlacesListTool] Executing with places:\", savedPlaces?.map((p)=>({\n                id: p.id,\n                hasPhotos: Boolean(p.photos?.length),\n                photoCount: p.photos?.length,\n                firstPhoto: p.photos?.[0],\n                primaryTypeDisplayName: p.primaryTypeDisplayName\n            })));\n        // Ensure we're passing the full array of places\n        if (!Array.isArray(savedPlaces)) {\n            console.error(\"[savedPlacesListTool] savedPlaces is not an array:\", savedPlaces);\n            return {\n                type: \"savedPlacesList\",\n                props: {\n                    places: []\n                }\n            };\n        }\n        // Make sure we pass the complete place objects\n        return {\n            type: \"savedPlacesList\",\n            props: {\n                places: savedPlaces.map((place)=>({\n                        ...place,\n                        photos: place.photos || [],\n                        primaryTypeDisplayName: place.primaryTypeDisplayName || {\n                            text: \"\",\n                            languageCode: \"en\"\n                        }\n                    })),\n                onRemove: undefined // Make it explicit that we're not handling removal here\n            }\n        };\n    }\n});\n// Simplify the stage progress tool to only include nextStage\nconst stageProgressTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Update the current planning stage only when certain criteria are met.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        nextStage: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().min(1).max(5),\n        currentStage: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().min(1).max(5),\n        travelDetails: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n            destination: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n            location: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n                latitude: zod__WEBPACK_IMPORTED_MODULE_1__.z.number(),\n                longitude: zod__WEBPACK_IMPORTED_MODULE_1__.z.number()\n            }),\n            startDate: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n            endDate: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n            preferences: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.string()),\n            budget: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n            language: zod__WEBPACK_IMPORTED_MODULE_1__.z.string(),\n            transport: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.string())\n        }),\n        metrics: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n            totalPrompts: zod__WEBPACK_IMPORTED_MODULE_1__.z.number(),\n            savedPlacesCount: zod__WEBPACK_IMPORTED_MODULE_1__.z.number(),\n            isPaid: zod__WEBPACK_IMPORTED_MODULE_1__.z.boolean(),\n            paymentReference: zod__WEBPACK_IMPORTED_MODULE_1__.z.string()\n        })\n    }),\n    execute: async function({ nextStage, currentStage, travelDetails, metrics }) {\n        // console.log('[StageProgressTool] Executing:', { nextStage, currentStage, metrics });\n        const validationResult = (0,_managers_stage_manager__WEBPACK_IMPORTED_MODULE_4__.validateStageProgression)(currentStage, nextStage, travelDetails);\n        if (!validationResult.canProgress) {\n            console.log(\"[StageProgressTool] Validation failed:\", validationResult.missingRequirements);\n            return {\n                type: \"stageProgress\",\n                status: \"error\",\n                props: {\n                    nextStage: currentStage,\n                    error: `Cannot progress to stage ${nextStage}. Missing requirements: ${validationResult.missingRequirements.join(\", \")}`\n                }\n            };\n        }\n        return {\n            type: \"stageProgress\",\n            status: \"success\",\n            props: {\n                nextStage\n            }\n        };\n    }\n});\n// Tool for Quick Response\nconst quickResponseTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: `Present users with exactly 3 contextually relevant quick response options.\n    \n    CRITICAL RULES:\n    1. YOU MUST ALWAYS RETURN EXACTLY 3 OPTIONS - NO EXCEPTIONS\n    2. Keep options concise and action-oriented\n    3. Options must make sense as natural chat responses\n    4. Each option should be 2-6 words\n    \n    Stage-specific guidelines:\n    Stage 1: Focus on parameter updates (e.g., \\\"Update my travel dates\\\", \\\"Change my budget\\\")\n    Stage 2: Focus on city info (e.g., \\\"Check the weather\\\", \\\"See currency rates\\\")\n    Stage 3: Focus on places (e.g., \\\"Show me museums\\\", \\\"Find restaurants\\\")\n    Stage 4: Focus on itinerary (e.g., \\\"Add more activities\\\", \\\"Review the plan\\\")\n    Stage 5: Focus on completion (e.g., \\\"Download itinerary\\\", \\\"Share with friends\\\")`,\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        responses: zod__WEBPACK_IMPORTED_MODULE_1__.z.array(zod__WEBPACK_IMPORTED_MODULE_1__.z.string()).length(3).describe(\"Exactly 3 quick response options\")\n    }),\n    execute: async function({ responses }) {\n        // console.log('[QuickResponse Tool] Executing with responses:', responses);\n        if (!Array.isArray(responses) || responses.length !== 3) {\n            console.error(\"[QuickResponse Tool] Invalid responses:\", responses);\n            throw new Error(\"Must provide exactly 3 responses\");\n        }\n        // Validate each response\n        responses.forEach((response, index)=>{\n            if (!response || typeof response !== \"string\" || response.trim().length === 0) {\n                throw new Error(`Invalid response at index ${index}`);\n            }\n        });\n        console.log(\"[QuickResponse Tool] Returning valid responses\");\n        return {\n            type: \"quickResponse\",\n            props: {\n                responses\n            }\n        };\n    }\n});\n// Tool for Currency Conversion\nconst currencyConverterTool = (0,ai__WEBPACK_IMPORTED_MODULE_0__.tool)({\n    description: \"Display currency conversion rates for the destination country. Use this when discussing costs, budgets, or when the user wants to understand currency exchange rates.\",\n    parameters: zod__WEBPACK_IMPORTED_MODULE_1__.z.object({\n        amount: zod__WEBPACK_IMPORTED_MODULE_1__.z.number().optional().describe(\"Amount to convert in the destination currency\"),\n        destination: zod__WEBPACK_IMPORTED_MODULE_1__.z.string().describe(\"Destination country or city\")\n    }),\n    execute: async function({ amount = 100, destination }) {\n        if (!destination) {\n            throw new Error(\"Destination is required for currency conversion\");\n        }\n        const baseCurrency = (0,_utils_currency_utils__WEBPACK_IMPORTED_MODULE_5__.getCurrencyFromCountry)(destination);\n        return {\n            type: \"currencyConverter\",\n            props: {\n                baseCurrency,\n                baseAmount: amount,\n                defaultCurrencies: [\n                    \"USD\",\n                    \"EUR\",\n                    \"GBP\",\n                    \"CNY\",\n                    \"JPY\"\n                ]\n            }\n        };\n    }\n});\n// Export all tools with their names\nconst tools = {\n    budgetSelector: budgetSelectorTool,\n    preferenceSelector: preferenceSelectorTool,\n    datePicker: datePickerTool,\n    languageSelector: languageSelectorTool,\n    transportSelector: transportSelectorTool,\n    placeCard: placeCardTool,\n    carousel: carouselTool,\n    detailsCard: detailsCardTool,\n    weatherChart: weatherChartTool,\n    savedPlacesList: savedPlacesListTool,\n    stageProgress: stageProgressTool,\n    quickResponse: quickResponseTool,\n    currencyConverter: currencyConverterTool\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3BCO1FBRUEsTUFBTU8sZUFBZTdJLDZFQUFzQkEsQ0FBQzhCO1FBRTVDLE9BQU87WUFDSHJCLE1BQU07WUFDTkMsT0FBTztnQkFDSG1JO2dCQUNBQyxZQUFZRjtnQkFDWkcsbUJBQW1CO29CQUFDO29CQUFPO29CQUFPO29CQUFPO29CQUFPO2lCQUFNO1lBQzFEO1FBQ0o7SUFDSjtBQUNKLEdBQUc7QUFFSCxvQ0FBb0M7QUFDN0IsTUFBTUMsUUFBUTtJQUNqQkMsZ0JBQWdCaEo7SUFDaEJpSixvQkFBb0J2STtJQUNwQndJLFlBQVlwSTtJQUNacUksa0JBQWtCakk7SUFDbEJrSSxtQkFBbUJoSTtJQUNuQmlJLFdBQVcvSDtJQUNYZ0ksVUFBVXJIO0lBQ1ZzSCxhQUFhOUc7SUFDYitHLGNBQWN4RztJQUNkeUcsaUJBQWlCOUQ7SUFDakIrRCxlQUFldEM7SUFDZnVDLGVBQWV4QjtJQUNmeUIsbUJBQW1CbEI7QUFDdkIsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYXZlbC1yaXp6Ly4vYWkvdG9vbHMudHM/Njc5ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0b29sIGFzIGNyZWF0ZVRvb2wsIFRvb2xFeGVjdXRpb25PcHRpb25zIH0gZnJvbSAnYWknO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBcbiAgICBUcmF2ZWxQcmVmZXJlbmNlLFxuICAgIEJ1ZGdldExldmVsLFxuICAgIFN1cHBvcnRlZExhbmd1YWdlLFxuICAgIENvbXBvbmVudFR5cGUsXG4gICAgVHJhdmVsRGV0YWlsc1xufSBmcm9tICcuLi9tYW5hZ2Vycy90eXBlcyc7XG5pbXBvcnQgeyBcbiAgICBmZXRjaFBsYWNlcyxcbiAgICBzZWFyY2hQbGFjZUJ5VGV4dCxcbiAgICBzZWFyY2hNdWx0aXBsZVBsYWNlc0J5VGV4dCxcbiAgICBQbGFjZVxufSBmcm9tICcuLi91dGlscy9wbGFjZXMtdXRpbHMnO1xuaW1wb3J0IHsgdmFsaWRhdGVTdGFnZVByb2dyZXNzaW9uIH0gZnJvbSAnLi4vbWFuYWdlcnMvc3RhZ2UtbWFuYWdlcic7XG5pbXBvcnQgeyBnZXRDdXJyZW5jeUZyb21Db3VudHJ5IH0gZnJvbSAnLi4vdXRpbHMvY3VycmVuY3ktdXRpbHMnO1xuXG4vLyBTdGFuZGFyZGl6ZWQgVG9vbCBSZXNwb25zZSBpbnRlcmZhY2VzXG5leHBvcnQgaW50ZXJmYWNlIFRvb2xSZXNwb25zZTxUID0gUmVjb3JkPHN0cmluZywgdW5rbm93bj4+IHtcbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgc3RhdHVzOiAnc3VjY2VzcycgfCAnZXJyb3InIHwgJ2VtcHR5JztcbiAgICBwcm9wczogVDtcbiAgICBlcnJvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCYXNlVG9vbFByb3BzIHtcbiAgICBlcnJvcj86IHN0cmluZztcbiAgICBsb2FkaW5nPzogYm9vbGVhbjtcbn1cblxuLy8gVG9vbCBmb3IgQnVkZ2V0IFNlbGVjdGlvblxuZXhwb3J0IGNvbnN0IGJ1ZGdldFNlbGVjdG9yVG9vbCA9IGNyZWF0ZVRvb2woe1xuICAgIGRlc2NyaXB0aW9uOiAnRGlzcGxheSBidWRnZXQgbGV2ZWwgb3B0aW9ucyBmb3IgdGhlIHRyaXAuIFVzZSB0aGlzIHdoZW4gZGlzY3Vzc2luZyB0cmlwIGNvc3RzIG9yIHdoZW4gdGhlIHVzZXIgd2FudHMgdG8gc2V0IHRoZWlyIGJ1ZGdldCBwcmVmZXJlbmNlLicsXG4gICAgcGFyYW1ldGVyczogei5vYmplY3Qoe1xuICAgICAgICBjdXJyZW50QnVkZ2V0OiB6LmVudW0oWyckJywgJyQkJywgJyQkJCcsICckJCQkJ10gYXMgY29uc3QpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBleGVjdXRlOiBhc3luYyBmdW5jdGlvbiAoeyBjdXJyZW50QnVkZ2V0IH0pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdidWRnZXRTZWxlY3RvcicsXG4gICAgICAgICAgICBwcm9wczoge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRCdWRnZXQ6IGN1cnJlbnRCdWRnZXQgYXMgQnVkZ2V0TGV2ZWxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59KTtcblxuLy8gVG9vbCBmb3IgVHJhdmVsIFByZWZlcmVuY2VzXG5leHBvcnQgY29uc3QgcHJlZmVyZW5jZVNlbGVjdG9yVG9vbCA9IGNyZWF0ZVRvb2woe1xuICAgIGRlc2NyaXB0aW9uOiAnRGlzcGxheSBvcHRpb25zIGZvciBzZWxlY3RpbmcgdHJhdmVsIHByZWZlcmVuY2VzIGFuZCBpbnRlcmVzdHMuJyxcbiAgICBwYXJhbWV0ZXJzOiB6Lm9iamVjdCh7XG4gICAgICAgIGN1cnJlbnRQcmVmZXJlbmNlczogei5hcnJheSh6Lm5hdGl2ZUVudW0oVHJhdmVsUHJlZmVyZW5jZSkpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBleGVjdXRlOiBhc3luYyBmdW5jdGlvbiAoeyBjdXJyZW50UHJlZmVyZW5jZXMgfSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ3ByZWZlcmVuY2VTZWxlY3RvcicsXG4gICAgICAgICAgICBwcm9wczoge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRQcmVmZXJlbmNlczogY3VycmVudFByZWZlcmVuY2VzIGFzIFRyYXZlbFByZWZlcmVuY2VbXVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn0pO1xuXG4vLyBUb29sIGZvciBEYXRlIFNlbGVjdGlvblxuZXhwb3J0IGNvbnN0IGRhdGVQaWNrZXJUb29sID0gY3JlYXRlVG9vbCh7XG4gICAgZGVzY3JpcHRpb246ICdEaXNwbGF5IGEgZGF0ZSBwaWNrZXIgZm9yIHNlbGVjdGluZyB0cmF2ZWwgZGF0ZXMuJyxcbiAgICBwYXJhbWV0ZXJzOiB6Lm9iamVjdCh7XG4gICAgICAgIHN0YXJ0RGF0ZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICBlbmREYXRlOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBleGVjdXRlOiBhc3luYyBmdW5jdGlvbiAoeyBzdGFydERhdGUsIGVuZERhdGUgfSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ2RhdGVQaWNrZXInLFxuICAgICAgICAgICAgcHJvcHM6IHtcbiAgICAgICAgICAgICAgICBzdGFydERhdGUsXG4gICAgICAgICAgICAgICAgZW5kRGF0ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn0pO1xuXG4vLyBUb29sIGZvciBMYW5ndWFnZSBTZWxlY3Rpb25cbmV4cG9ydCBjb25zdCBsYW5ndWFnZVNlbGVjdG9yVG9vbCA9IGNyZWF0ZVRvb2woe1xuICAgIGRlc2NyaXB0aW9uOiAnRGlzcGxheSBsYW5ndWFnZSBzZWxlY3Rpb24gb3B0aW9ucy4nLFxuICAgIHBhcmFtZXRlcnM6IHoub2JqZWN0KHtcbiAgICAgICAgY3VycmVudExhbmd1YWdlOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBleGVjdXRlOiBhc3luYyBmdW5jdGlvbiAoeyBjdXJyZW50TGFuZ3VhZ2UgfSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ2xhbmd1YWdlU2VsZWN0b3InLFxuICAgICAgICAgICAgcHJvcHM6IHtcbiAgICAgICAgICAgICAgICBjdXJyZW50TGFuZ3VhZ2U6IGN1cnJlbnRMYW5ndWFnZSBhcyBTdXBwb3J0ZWRMYW5ndWFnZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn0pO1xuXG4vLyBUb29sIGZvciBUcmFuc3BvcnQgU2VsZWN0aW9uXG5leHBvcnQgY29uc3QgdHJhbnNwb3J0U2VsZWN0b3JUb29sID0gY3JlYXRlVG9vbCh7XG4gICAgZGVzY3JpcHRpb246ICdEaXNwbGF5IHRyYW5zcG9ydCBtZXRob2Qgc2VsZWN0aW9uIG9wdGlvbnMuIFVzZSB0aGlzIHdoZW4gZGlzY3Vzc2luZyB0cmFuc3BvcnRhdGlvbiBvcHRpb25zIGZvciB0aGUgdHJpcCwgc3VjaCBhcyBmbGlnaHRzLCB0cmFpbnMsIG9yIGNhciByZW50YWxzLicsXG4gICAgcGFyYW1ldGVyczogei5vYmplY3Qoe1xuICAgICAgICBzZWxlY3RlZE1ldGhvZDogei5zdHJpbmcoKS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgZXhlY3V0ZTogYXN5bmMgZnVuY3Rpb24gKHsgc2VsZWN0ZWRNZXRob2QgfSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ3RyYW5zcG9ydFNlbGVjdG9yJyxcbiAgICAgICAgICAgIHByb3BzOiB7IHNlbGVjdGVkTWV0aG9kIH1cbiAgICAgICAgfTtcbiAgICB9XG59KTtcblxuLy8gVG9vbCBmb3IgUGxhY2UgRGlzcGxheVxuZXhwb3J0IGNvbnN0IHBsYWNlQ2FyZFRvb2wgPSBjcmVhdGVUb29sKHtcbiAgICBkZXNjcmlwdGlvbjogJ0Rpc3BsYXkgaW5mb3JtYXRpb24gYWJvdXQgb25lIHNwZWNpZmljIHBsYWNlLiBVc2UgdGhpcyB3aGVuZXZlciB0aGUgdXNlciBleHBsaWNpdGx5IGFza3MgZm9yIE9ORSBwbGFjZSwgd2hldGhlciBieSBuYW1lIG9yIHR5cGUgKGUuZy4sIFxcXCJzaG93IG1lIG9uZSB0aGVhdHJlXFxcIiwgXFxcInNob3cgbWUgb25lIHJlc3RhdXJhbnRcXFwiLCBcXFwic2hvdyBtZSBUaGUgTGl0dGxlIE1lcm1haWQgc3RhdHVlXFxcIikuJyxcbiAgICBwYXJhbWV0ZXJzOiB6Lm9iamVjdCh7XG4gICAgICAgIHNlYXJjaFRleHQ6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1RoZSBuYW1lIG9yIGRlc2NyaXB0aW9uIG9mIHRoZSBwbGFjZSB0byBzZWFyY2ggZm9yJyksXG4gICAgICAgIGxvY2F0aW9uOiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBsYXRpdHVkZTogei5udW1iZXIoKSxcbiAgICAgICAgICAgIGxvbmdpdHVkZTogei5udW1iZXIoKVxuICAgICAgICB9KSxcbiAgICAgICAgZGVzdGluYXRpb246IHouc3RyaW5nKCkuZGVzY3JpYmUoJ05hbWUgb2YgdGhlIGRlc3RpbmF0aW9uIGNpdHknKVxuICAgIH0pLFxuICAgIGV4ZWN1dGU6IGFzeW5jIGZ1bmN0aW9uICh7IHNlYXJjaFRleHQsIGxvY2F0aW9uLCBkZXN0aW5hdGlvbiB9KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwbGFjZSA9IGF3YWl0IHNlYXJjaFBsYWNlQnlUZXh0KHNlYXJjaFRleHQsIGxvY2F0aW9uLCBkZXN0aW5hdGlvbik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghcGxhY2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdObyBwbGFjZSBmb3VuZCBmb3Igc2VhcmNoIHRleHQ6Jywgc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3BsYWNlQ2FyZCcsXG4gICAgICAgICAgICAgICAgICAgIHByb3BzOiB7IHBsYWNlOiBudWxsIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQ291bGQgbm90IGZpbmQgYSB1bmlxdWUgcGxhY2UuIFRyeSBzZWFyY2hpbmcgZm9yIHNvbWV0aGluZyBlbHNlLidcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdwbGFjZUNhcmQnLFxuICAgICAgICAgICAgICAgIHByb3BzOiB7IFxuICAgICAgICAgICAgICAgICAgICBwbGFjZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZWFyY2hpbmcgZm9yIHBsYWNlOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3BsYWNlQ2FyZCcsXG4gICAgICAgICAgICAgICAgcHJvcHM6IHsgcGxhY2U6IG51bGwgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG4vLyBUb29sIGZvciBQbGFjZSBDYXJvdXNlbFxuZXhwb3J0IGNvbnN0IGNhcm91c2VsVG9vbCA9IGNyZWF0ZVRvb2woe1xuICAgIGRlc2NyaXB0aW9uOiAnRGlzcGxheSBtdWx0aXBsZSBwbGFjZXMgaW4gYSBjYXJvdXNlbCBiYXNlZCBvbiBwcmVmZXJlbmNlcyBvciBzcGVjaWZpYyBwbGFjZSB0eXBlcyBhbmQgYXV0b21hdGljYWxseSBzYXZlIHRoZW0gaW50byBzYXZlZFBsYWNlcy4nLFxuICAgIHBhcmFtZXRlcnM6IHoub2JqZWN0KHtcbiAgICAgICAgcHJlZmVyZW5jZXM6IHouYXJyYXkoei5uYXRpdmVFbnVtKFRyYXZlbFByZWZlcmVuY2UpKS5vcHRpb25hbCgpLCAvLyBDaGFuZ2VkIHRvIGFycmF5XG4gICAgICAgIHBsYWNlVHlwZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLmRlc2NyaWJlKCdTcGVjaWZpYyBwbGFjZSB0eXBlIHRvIHNlYXJjaCBmb3InKSxcbiAgICAgICAgbG9jYXRpb246IHoub2JqZWN0KHtcbiAgICAgICAgICAgIGxhdGl0dWRlOiB6Lm51bWJlcigpLFxuICAgICAgICAgICAgbG9uZ2l0dWRlOiB6Lm51bWJlcigpXG4gICAgICAgIH0pLFxuICAgICAgICBtYXhSZXN1bHRzOiB6Lm51bWJlcigpLm9wdGlvbmFsKCkuZGVmYXVsdCg1KVxuICAgIH0pLFxuICAgIGV4ZWN1dGU6IGFzeW5jIGZ1bmN0aW9uICh7IHByZWZlcmVuY2VzLCBwbGFjZVR5cGUsIGxvY2F0aW9uLCBtYXhSZXN1bHRzIH0pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBwbGFjZXM6IFBsYWNlW10gPSBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHByZWZlcmVuY2VzICYmIHByZWZlcmVuY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBVc2Ugb3VyIGV4aXN0aW5nIGZ1bmN0aW9uIHRvIGdldCBwbGFjZXMgYnkgcHJlZmVyZW5jZVxuICAgICAgICAgICAgICAgIHBsYWNlcyA9IGF3YWl0IGZldGNoUGxhY2VzKFxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5sYXRpdHVkZSxcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ubG9uZ2l0dWRlLFxuICAgICAgICAgICAgICAgICAgICBwcmVmZXJlbmNlcyxcbiAgICAgICAgICAgICAgICAgICAgbWF4UmVzdWx0c1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBsYWNlVHlwZSkge1xuICAgICAgICAgICAgICAgIC8vIFNlYXJjaCBieSBzcGVjaWZpYyBwbGFjZSB0eXBlXG4gICAgICAgICAgICAgICAgcGxhY2VzID0gYXdhaXQgZmV0Y2hQbGFjZXMoXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmxhdGl0dWRlLFxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5sb25naXR1ZGUsXG4gICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgbWF4UmVzdWx0cyxcbiAgICAgICAgICAgICAgICAgICAgW3BsYWNlVHlwZV1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdjYXJvdXNlbCcsXG4gICAgICAgICAgICAgICAgcHJvcHM6IHsgcGxhY2VzIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjYXJvdXNlbCB0b29sOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2Nhcm91c2VsJyxcbiAgICAgICAgICAgICAgICBwcm9wczogeyBwbGFjZXM6IFtdIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuLy8gVG9vbCBmb3IgRGV0YWlscyBDYXJkXG5leHBvcnQgY29uc3QgZGV0YWlsc0NhcmRUb29sID0gY3JlYXRlVG9vbCh7XG4gICAgZGVzY3JpcHRpb246ICdEaXNwbGF5IHRyYXZlbCBkZXRhaWxzIHN1bW1hcnkuIFVzZSB0aGlzIHdoZW4gdGhlIHVzZXIgd2FudHMgdG8gdmlldyBhIHN1bW1hcnkgb2YgdGhlaXIgdHJpcCBkZXRhaWxzLCBpbmNsdWRpbmcgZGVzdGluYXRpb24sIGRhdGVzLCBwcmVmZXJlbmNlcywgYnVkZ2V0LCBhbmQgbW9yZS4nLFxuICAgIHBhcmFtZXRlcnM6IHoub2JqZWN0KHtcbiAgICAgICAgY29udGVudDogei5vYmplY3Qoe1xuICAgICAgICAgICAgZGVzdGluYXRpb246IHouc3RyaW5nKCksXG4gICAgICAgICAgICBkYXRlczogei5vYmplY3Qoe1xuICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogei5zdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBlbmREYXRlOiB6LnN0cmluZygpXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgcHJlZmVyZW5jZXM6IHouYXJyYXkoei5zdHJpbmcoKSkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIGJ1ZGdldDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgbGFuZ3VhZ2U6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgIHRyYW5zcG9ydDogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgZGluaW5nOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKClcbiAgICAgICAgfSlcbiAgICB9KSxcbiAgICBleGVjdXRlOiBhc3luYyBmdW5jdGlvbiAoeyBjb250ZW50IH0pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdkZXRhaWxzQ2FyZCcsXG4gICAgICAgICAgICBwcm9wczogeyBjb250ZW50IH1cbiAgICAgICAgfTtcbiAgICB9XG59KTtcblxuZXhwb3J0IGNvbnN0IHdlYXRoZXJDaGFydFRvb2wgPSBjcmVhdGVUb29sKHtcbiAgICBkZXNjcmlwdGlvbjogJ0Rpc3BsYXkgaGlzdG9yaWNhbCB3ZWF0aGVyIGRhdGEgaW5jbHVkaW5nIHRlbXBlcmF0dXJlIGFuZCBwcmVjaXBpdGF0aW9uIGZvciBhIGxvY2F0aW9uLicsXG4gICAgcGFyYW1ldGVyczogei5vYmplY3Qoe1xuICAgICAgICBsYXQ6IHoubnVtYmVyKCkubWluKC05MCkubWF4KDkwKS5kZXNjcmliZSgnTGF0aXR1ZGUgb2YgdGhlIGxvY2F0aW9uJyksXG4gICAgICAgIGxvbjogei5udW1iZXIoKS5taW4oLTE4MCkubWF4KDE4MCkuZGVzY3JpYmUoJ0xvbmdpdHVkZSBvZiB0aGUgbG9jYXRpb24nKSxcbiAgICAgICAgY2l0eTogei5zdHJpbmcoKS5kZXNjcmliZSgnQ2l0eSBuYW1lIGZvciBkaXNwbGF5JyksXG4gICAgICAgIHN0YXJ0RGF0ZTogei5zdHJpbmcoKS5kZXNjcmliZSgnVHJpcCBzdGFydCBkYXRlIGluIEREL01NL1lZWVkgZm9ybWF0JyksXG4gICAgICAgIGVuZERhdGU6IHouc3RyaW5nKCkuZGVzY3JpYmUoJ1RyaXAgZW5kIGRhdGUgaW4gREQvTU0vWVlZWSBmb3JtYXQnKSxcbiAgICAgICAgdW5pdHM6IHouZW51bShbJ3VzJywgJ3VrJywgJ21ldHJpYyddIGFzIGNvbnN0KS5vcHRpb25hbCgpLmRlZmF1bHQoJ21ldHJpYycpXG4gICAgfSksXG4gICAgZXhlY3V0ZTogYXN5bmMgZnVuY3Rpb24gKHsgbGF0LCBsb24sIGNpdHksIHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgdW5pdHMgPSAnbWV0cmljJyB9KSB7XG4gICAgICAgIC8vIFBhcnNlIEREL01NL1lZWVkgZGF0ZXNcbiAgICAgICAgY29uc3QgW3N0YXJ0RGF5LCBzdGFydE1vbnRoLCBzdGFydFllYXJdID0gc3RhcnREYXRlLnNwbGl0KCcvJykubWFwKE51bWJlcik7XG4gICAgICAgIGNvbnN0IFtlbmREYXksIGVuZE1vbnRoLCBlbmRZZWFyXSA9IGVuZERhdGUuc3BsaXQoJy8nKS5tYXAoTnVtYmVyKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZvcm1hdCBkYXRlcyBmb3IgQVBJIChZWVlZLU1NLUREKVxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRTdGFydERhdGUgPSBgJHtzdGFydFllYXJ9LSR7U3RyaW5nKHN0YXJ0TW9udGgpLnBhZFN0YXJ0KDIsICcwJyl9LSR7U3RyaW5nKHN0YXJ0RGF5KS5wYWRTdGFydCgyLCAnMCcpfWA7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZEVuZERhdGUgPSBgJHtlbmRZZWFyfS0ke1N0cmluZyhlbmRNb250aCkucGFkU3RhcnQoMiwgJzAnKX0tJHtTdHJpbmcoZW5kRGF5KS5wYWRTdGFydCgyLCAnMCcpfWA7XG5cbiAgICAgICAgLy8gQ2FsY3VsYXRlIG51bWJlciBvZiBkYXlzIGluIHRoZSByYW5nZVxuICAgICAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKGZvcm1hdHRlZFN0YXJ0RGF0ZSk7XG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGZvcm1hdHRlZEVuZERhdGUpO1xuICAgICAgICBjb25zdCBkYXlzRGlmZiA9IE1hdGguY2VpbCgoZW5kLmdldFRpbWUoKSAtIHN0YXJ0LmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpICsgMTtcbiAgICAgICAgXG4gICAgICAgIC8vIENhbGN1bGF0ZSBob3cgbWFueSBleHRyYSBkYXlzIHdlIG5lZWQgZm9yIDMwIGRheXMgdG90YWxcbiAgICAgICAgY29uc3QgZXh0cmFEYXlzID0gTWF0aC5tYXgoMCwgMzAgLSBkYXlzRGlmZik7XG4gICAgICAgIGNvbnN0IGRheXNUb0FkZEJlZm9yZSA9IE1hdGguZmxvb3IoZXh0cmFEYXlzIC8gMik7XG4gICAgICAgIGNvbnN0IGRheXNUb0FkZEFmdGVyID0gZXh0cmFEYXlzIC0gZGF5c1RvQWRkQmVmb3JlO1xuXG4gICAgICAgIC8vIEV4dGVuZCBkYXRlcyB0byBnZXQgMzAgZGF5c1xuICAgICAgICBzdGFydC5zZXREYXRlKHN0YXJ0LmdldERhdGUoKSAtIGRheXNUb0FkZEJlZm9yZSk7XG4gICAgICAgIGVuZC5zZXREYXRlKGVuZC5nZXREYXRlKCkgKyBkYXlzVG9BZGRBZnRlcik7XG5cbiAgICAgICAgLy8gRm9ybWF0IGV4dGVuZGVkIGRhdGVzIGZvciBBUElcbiAgICAgICAgY29uc3QgZXh0ZW5kZWRTdGFydERhdGUgPSBzdGFydC50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICAgIGNvbnN0IGV4dGVuZGVkRW5kRGF0ZSA9IGVuZC50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1t3ZWF0aGVyQ2hhcnRUb29sXSBEYXRlIGNvbnZlcnNpb246Jywge1xuICAgICAgICAgICAgb3JpZ2luYWxEYXRlOiBzdGFydERhdGUsXG4gICAgICAgICAgICBvcmlnaW5hbEVuZERhdGU6IGVuZERhdGUsXG4gICAgICAgICAgICBmb3JtYXR0ZWRTdGFydERhdGU6IGV4dGVuZGVkU3RhcnREYXRlLFxuICAgICAgICAgICAgZm9ybWF0dGVkRW5kRGF0ZTogZXh0ZW5kZWRFbmREYXRlLFxuICAgICAgICAgICAgdG90YWxEYXlzOiAzMCxcbiAgICAgICAgICAgIG9yaWdpbmFsUmFuZ2U6IGRheXNEaWZmLFxuICAgICAgICAgICAgYWRkZWRCZWZvcmU6IGRheXNUb0FkZEJlZm9yZSxcbiAgICAgICAgICAgIGFkZGVkQWZ0ZXI6IGRheXNUb0FkZEFmdGVyXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAnd2VhdGhlckNoYXJ0JyxcbiAgICAgICAgICAgIHByb3BzOiB7XG4gICAgICAgICAgICAgICAgbGF0LFxuICAgICAgICAgICAgICAgIGxvbixcbiAgICAgICAgICAgICAgICBjaXR5LFxuICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogZXh0ZW5kZWRTdGFydERhdGUsXG4gICAgICAgICAgICAgICAgZW5kRGF0ZTogZXh0ZW5kZWRFbmREYXRlLFxuICAgICAgICAgICAgICAgIHVuaXRzLFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbn0pO1xuXG5leHBvcnQgY29uc3Qgc2F2ZWRQbGFjZXNMaXN0VG9vbCA9IGNyZWF0ZVRvb2woe1xuICAgIGRlc2NyaXB0aW9uOiAnRGlzcGxheSBhbGwgY3VycmVudGx5IHNhdmVkIHBsYWNlcyBpbiBhIGxpc3Qgdmlldy4gV2hlbiB1c2VyIGFza3MgdG8gc2VlIHNhdmVkIHBsYWNlcyAoZS5nLiBcInNob3cgbWUgbXkgc2F2ZWQgcGxhY2VzXCIsIFwid2hhdCBwbGFjZXMgaGF2ZSBJIHNhdmVkXCIsIGV0YyksIHBhc3MgQUxMIHBsYWNlcyBmcm9tIHRoZSBzYXZlZFBsYWNlcyBwYXJhbWV0ZXIgdG8gdGhpcyB0b29sLicsXG4gICAgcGFyYW1ldGVyczogei5vYmplY3Qoe1xuICAgICAgICBzYXZlZFBsYWNlczogei5hcnJheSh6Lm9iamVjdCh7XG4gICAgICAgICAgICBpZDogei5zdHJpbmcoKSxcbiAgICAgICAgICAgIGRpc3BsYXlOYW1lOiB6LnVuaW9uKFtcbiAgICAgICAgICAgICAgICB6Lm9iamVjdCh7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHouc3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlQ29kZTogei5zdHJpbmcoKVxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHouc3RyaW5nKClcbiAgICAgICAgICAgIF0pLm9wdGlvbmFsKCksIC8vIE1ha2Ugb3B0aW9uYWxcbiAgICAgICAgICAgIHByaW1hcnlUeXBlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksIC8vIE1ha2Ugb3B0aW9uYWxcbiAgICAgICAgICAgIGxvY2F0aW9uOiB6Lm9iamVjdCh7XG4gICAgICAgICAgICAgICAgbGF0aXR1ZGU6IHoubnVtYmVyKCksXG4gICAgICAgICAgICAgICAgbG9uZ2l0dWRlOiB6Lm51bWJlcigpXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpLCAvLyBNYWtlIG9wdGlvbmFsXG4gICAgICAgICAgICBmb3JtYXR0ZWRBZGRyZXNzOiB6LnN0cmluZygpLm9wdGlvbmFsKCksIC8vIE1ha2Ugb3B0aW9uYWxcbiAgICAgICAgICAgIHBob3Rvczogei5hcnJheSh6Lm9iamVjdCh7XG4gICAgICAgICAgICAgICAgbmFtZTogei5zdHJpbmcoKSxcbiAgICAgICAgICAgICAgICB3aWR0aFB4OiB6Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gICAgICAgICAgICAgICAgaGVpZ2h0UHg6IHoubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgICAgICBhdXRob3JBdHRyaWJ1dGlvbnM6IHouYXJyYXkoei5vYmplY3Qoe1xuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICAgICAgICAgICAgICB1cmk6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgICAgICAgICAgICAgICAgcGhvdG9Vcmk6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgICAgICAgICAgICAgIH0pKS5vcHRpb25hbCgpIC8vIE1ha2Ugb3B0aW9uYWxcbiAgICAgICAgICAgIH0pKS5vcHRpb25hbCgpLmRlZmF1bHQoW10pLCAvLyBNYWtlIG9wdGlvbmFsIHdpdGggZGVmYXVsdFxuICAgICAgICAgICAgcHJpbWFyeVR5cGVEaXNwbGF5TmFtZTogei5vYmplY3Qoe1xuICAgICAgICAgICAgICAgIHRleHQ6IHouc3RyaW5nKCksXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2VDb2RlOiB6LnN0cmluZygpXG4gICAgICAgICAgICB9KS5vcHRpb25hbCgpIC8vIEFscmVhZHkgb3B0aW9uYWxcbiAgICAgICAgfSkpXG4gICAgfSksXG4gICAgZXhlY3V0ZTogYXN5bmMgZnVuY3Rpb24gKHsgc2F2ZWRQbGFjZXMgfSkge1xuICAgICAgICBjb25zb2xlLmxvZygnW3NhdmVkUGxhY2VzTGlzdFRvb2xdIEV4ZWN1dGluZyB3aXRoIHBsYWNlczonLCBzYXZlZFBsYWNlcz8ubWFwKHAgPT4gKHtcbiAgICAgICAgICAgIGlkOiBwLmlkLFxuICAgICAgICAgICAgaGFzUGhvdG9zOiBCb29sZWFuKHAucGhvdG9zPy5sZW5ndGgpLFxuICAgICAgICAgICAgcGhvdG9Db3VudDogcC5waG90b3M/Lmxlbmd0aCxcbiAgICAgICAgICAgIGZpcnN0UGhvdG86IHAucGhvdG9zPy5bMF0sXG4gICAgICAgICAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lOiBwLnByaW1hcnlUeXBlRGlzcGxheU5hbWVcbiAgICAgICAgfSkpKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEVuc3VyZSB3ZSdyZSBwYXNzaW5nIHRoZSBmdWxsIGFycmF5IG9mIHBsYWNlc1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc2F2ZWRQbGFjZXMpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbc2F2ZWRQbGFjZXNMaXN0VG9vbF0gc2F2ZWRQbGFjZXMgaXMgbm90IGFuIGFycmF5OicsIHNhdmVkUGxhY2VzKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3NhdmVkUGxhY2VzTGlzdCcsXG4gICAgICAgICAgICAgICAgcHJvcHM6IHsgcGxhY2VzOiBbXSB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWFrZSBzdXJlIHdlIHBhc3MgdGhlIGNvbXBsZXRlIHBsYWNlIG9iamVjdHNcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdzYXZlZFBsYWNlc0xpc3QnLFxuICAgICAgICAgICAgcHJvcHM6IHsgXG4gICAgICAgICAgICAgICAgcGxhY2VzOiBzYXZlZFBsYWNlcy5tYXAocGxhY2UgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucGxhY2UsXG4gICAgICAgICAgICAgICAgICAgIHBob3RvczogcGxhY2UucGhvdG9zIHx8IFtdLFxuICAgICAgICAgICAgICAgICAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lOiBwbGFjZS5wcmltYXJ5VHlwZURpc3BsYXlOYW1lIHx8IHsgdGV4dDogJycsIGxhbmd1YWdlQ29kZTogJ2VuJyB9XG4gICAgICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgICAgIG9uUmVtb3ZlOiB1bmRlZmluZWQgLy8gTWFrZSBpdCBleHBsaWNpdCB0aGF0IHdlJ3JlIG5vdCBoYW5kbGluZyByZW1vdmFsIGhlcmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59KTtcblxuLy8gU2ltcGxpZnkgdGhlIHN0YWdlIHByb2dyZXNzIHRvb2wgdG8gb25seSBpbmNsdWRlIG5leHRTdGFnZVxuZXhwb3J0IGNvbnN0IHN0YWdlUHJvZ3Jlc3NUb29sID0gY3JlYXRlVG9vbCh7XG4gICAgZGVzY3JpcHRpb246ICdVcGRhdGUgdGhlIGN1cnJlbnQgcGxhbm5pbmcgc3RhZ2Ugb25seSB3aGVuIGNlcnRhaW4gY3JpdGVyaWEgYXJlIG1ldC4nLFxuICAgIHBhcmFtZXRlcnM6IHoub2JqZWN0KHtcbiAgICAgICAgbmV4dFN0YWdlOiB6Lm51bWJlcigpLm1pbigxKS5tYXgoNSksXG4gICAgICAgIGN1cnJlbnRTdGFnZTogei5udW1iZXIoKS5taW4oMSkubWF4KDUpLFxuICAgICAgICB0cmF2ZWxEZXRhaWxzOiB6Lm9iamVjdCh7XG4gICAgICAgICAgICBkZXN0aW5hdGlvbjogei5zdHJpbmcoKSxcbiAgICAgICAgICAgIGxvY2F0aW9uOiB6Lm9iamVjdCh7XG4gICAgICAgICAgICAgICAgbGF0aXR1ZGU6IHoubnVtYmVyKCksXG4gICAgICAgICAgICAgICAgbG9uZ2l0dWRlOiB6Lm51bWJlcigpXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHN0YXJ0RGF0ZTogei5zdHJpbmcoKSxcbiAgICAgICAgICAgIGVuZERhdGU6IHouc3RyaW5nKCksXG4gICAgICAgICAgICBwcmVmZXJlbmNlczogei5hcnJheSh6LnN0cmluZygpKSxcbiAgICAgICAgICAgIGJ1ZGdldDogei5zdHJpbmcoKSxcbiAgICAgICAgICAgIGxhbmd1YWdlOiB6LnN0cmluZygpLFxuICAgICAgICAgICAgdHJhbnNwb3J0OiB6LmFycmF5KHouc3RyaW5nKCkpXG4gICAgICAgIH0pLFxuICAgICAgICBtZXRyaWNzOiB6Lm9iamVjdCh7XG4gICAgICAgICAgICB0b3RhbFByb21wdHM6IHoubnVtYmVyKCksXG4gICAgICAgICAgICBzYXZlZFBsYWNlc0NvdW50OiB6Lm51bWJlcigpLFxuICAgICAgICAgICAgaXNQYWlkOiB6LmJvb2xlYW4oKSxcbiAgICAgICAgICAgIHBheW1lbnRSZWZlcmVuY2U6IHouc3RyaW5nKClcbiAgICAgICAgfSlcbiAgICB9KSxcbiAgICBleGVjdXRlOiBhc3luYyBmdW5jdGlvbih7IG5leHRTdGFnZSwgY3VycmVudFN0YWdlLCB0cmF2ZWxEZXRhaWxzLCBtZXRyaWNzIH0pIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ1tTdGFnZVByb2dyZXNzVG9vbF0gRXhlY3V0aW5nOicsIHsgbmV4dFN0YWdlLCBjdXJyZW50U3RhZ2UsIG1ldHJpY3MgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB2YWxpZGF0aW9uUmVzdWx0ID0gdmFsaWRhdGVTdGFnZVByb2dyZXNzaW9uKFxuICAgICAgICAgICAgY3VycmVudFN0YWdlLFxuICAgICAgICAgICAgbmV4dFN0YWdlLFxuICAgICAgICAgICAgdHJhdmVsRGV0YWlscyBhcyBUcmF2ZWxEZXRhaWxzIC8vIFR5cGUgYXNzZXJ0aW9uIHNpbmNlIHdlIHZhbGlkYXRlIGZpZWxkcyBpbiB2YWxpZGF0ZVN0YWdlUHJvZ3Jlc3Npb25cbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoIXZhbGlkYXRpb25SZXN1bHQuY2FuUHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbU3RhZ2VQcm9ncmVzc1Rvb2xdIFZhbGlkYXRpb24gZmFpbGVkOicsIHZhbGlkYXRpb25SZXN1bHQubWlzc2luZ1JlcXVpcmVtZW50cyk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdzdGFnZVByb2dyZXNzJyxcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgcHJvcHM6IHsgXG4gICAgICAgICAgICAgICAgICAgIG5leHRTdGFnZTogY3VycmVudFN0YWdlLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogYENhbm5vdCBwcm9ncmVzcyB0byBzdGFnZSAke25leHRTdGFnZX0uIE1pc3NpbmcgcmVxdWlyZW1lbnRzOiAke3ZhbGlkYXRpb25SZXN1bHQubWlzc2luZ1JlcXVpcmVtZW50cy5qb2luKCcsICcpfWBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6ICdzdGFnZVByb2dyZXNzJyxcbiAgICAgICAgICAgIHN0YXR1czogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgcHJvcHM6IHsgbmV4dFN0YWdlIH1cbiAgICAgICAgfTtcbiAgICB9XG59KTtcblxuLy8gVG9vbCBmb3IgUXVpY2sgUmVzcG9uc2VcbmV4cG9ydCBjb25zdCBxdWlja1Jlc3BvbnNlVG9vbCA9IGNyZWF0ZVRvb2woe1xuICAgIGRlc2NyaXB0aW9uOiBgUHJlc2VudCB1c2VycyB3aXRoIGV4YWN0bHkgMyBjb250ZXh0dWFsbHkgcmVsZXZhbnQgcXVpY2sgcmVzcG9uc2Ugb3B0aW9ucy5cbiAgICBcbiAgICBDUklUSUNBTCBSVUxFUzpcbiAgICAxLiBZT1UgTVVTVCBBTFdBWVMgUkVUVVJOIEVYQUNUTFkgMyBPUFRJT05TIC0gTk8gRVhDRVBUSU9OU1xuICAgIDIuIEtlZXAgb3B0aW9ucyBjb25jaXNlIGFuZCBhY3Rpb24tb3JpZW50ZWRcbiAgICAzLiBPcHRpb25zIG11c3QgbWFrZSBzZW5zZSBhcyBuYXR1cmFsIGNoYXQgcmVzcG9uc2VzXG4gICAgNC4gRWFjaCBvcHRpb24gc2hvdWxkIGJlIDItNiB3b3Jkc1xuICAgIFxuICAgIFN0YWdlLXNwZWNpZmljIGd1aWRlbGluZXM6XG4gICAgU3RhZ2UgMTogRm9jdXMgb24gcGFyYW1ldGVyIHVwZGF0ZXMgKGUuZy4sIFxcXCJVcGRhdGUgbXkgdHJhdmVsIGRhdGVzXFxcIiwgXFxcIkNoYW5nZSBteSBidWRnZXRcXFwiKVxuICAgIFN0YWdlIDI6IEZvY3VzIG9uIGNpdHkgaW5mbyAoZS5nLiwgXFxcIkNoZWNrIHRoZSB3ZWF0aGVyXFxcIiwgXFxcIlNlZSBjdXJyZW5jeSByYXRlc1xcXCIpXG4gICAgU3RhZ2UgMzogRm9jdXMgb24gcGxhY2VzIChlLmcuLCBcXFwiU2hvdyBtZSBtdXNldW1zXFxcIiwgXFxcIkZpbmQgcmVzdGF1cmFudHNcXFwiKVxuICAgIFN0YWdlIDQ6IEZvY3VzIG9uIGl0aW5lcmFyeSAoZS5nLiwgXFxcIkFkZCBtb3JlIGFjdGl2aXRpZXNcXFwiLCBcXFwiUmV2aWV3IHRoZSBwbGFuXFxcIilcbiAgICBTdGFnZSA1OiBGb2N1cyBvbiBjb21wbGV0aW9uIChlLmcuLCBcXFwiRG93bmxvYWQgaXRpbmVyYXJ5XFxcIiwgXFxcIlNoYXJlIHdpdGggZnJpZW5kc1xcXCIpYCxcbiAgICBwYXJhbWV0ZXJzOiB6Lm9iamVjdCh7XG4gICAgICAgIHJlc3BvbnNlczogei5hcnJheSh6LnN0cmluZygpKS5sZW5ndGgoMykuZGVzY3JpYmUoJ0V4YWN0bHkgMyBxdWljayByZXNwb25zZSBvcHRpb25zJylcbiAgICB9KSxcbiAgICBleGVjdXRlOiBhc3luYyBmdW5jdGlvbiAoeyByZXNwb25zZXMgfSkge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnW1F1aWNrUmVzcG9uc2UgVG9vbF0gRXhlY3V0aW5nIHdpdGggcmVzcG9uc2VzOicsIHJlc3BvbnNlcyk7XG5cbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHJlc3BvbnNlcykgfHwgcmVzcG9uc2VzLmxlbmd0aCAhPT0gMykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignW1F1aWNrUmVzcG9uc2UgVG9vbF0gSW52YWxpZCByZXNwb25zZXM6JywgcmVzcG9uc2VzKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTXVzdCBwcm92aWRlIGV4YWN0bHkgMyByZXNwb25zZXMnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFZhbGlkYXRlIGVhY2ggcmVzcG9uc2VcbiAgICAgICAgcmVzcG9uc2VzLmZvckVhY2goKHJlc3BvbnNlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCB0eXBlb2YgcmVzcG9uc2UgIT09ICdzdHJpbmcnIHx8IHJlc3BvbnNlLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgcmVzcG9uc2UgYXQgaW5kZXggJHtpbmRleH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1tRdWlja1Jlc3BvbnNlIFRvb2xdIFJldHVybmluZyB2YWxpZCByZXNwb25zZXMnKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiAncXVpY2tSZXNwb25zZScsXG4gICAgICAgICAgICBwcm9wczogeyByZXNwb25zZXMgfVxuICAgICAgICB9O1xuICAgIH1cbn0pO1xuXG4vLyBUb29sIGZvciBDdXJyZW5jeSBDb252ZXJzaW9uXG5leHBvcnQgY29uc3QgY3VycmVuY3lDb252ZXJ0ZXJUb29sID0gY3JlYXRlVG9vbCh7XG4gICAgZGVzY3JpcHRpb246ICdEaXNwbGF5IGN1cnJlbmN5IGNvbnZlcnNpb24gcmF0ZXMgZm9yIHRoZSBkZXN0aW5hdGlvbiBjb3VudHJ5LiBVc2UgdGhpcyB3aGVuIGRpc2N1c3NpbmcgY29zdHMsIGJ1ZGdldHMsIG9yIHdoZW4gdGhlIHVzZXIgd2FudHMgdG8gdW5kZXJzdGFuZCBjdXJyZW5jeSBleGNoYW5nZSByYXRlcy4nLFxuICAgIHBhcmFtZXRlcnM6IHoub2JqZWN0KHtcbiAgICAgICAgYW1vdW50OiB6Lm51bWJlcigpLm9wdGlvbmFsKCkuZGVzY3JpYmUoJ0Ftb3VudCB0byBjb252ZXJ0IGluIHRoZSBkZXN0aW5hdGlvbiBjdXJyZW5jeScpLFxuICAgICAgICBkZXN0aW5hdGlvbjogei5zdHJpbmcoKS5kZXNjcmliZSgnRGVzdGluYXRpb24gY291bnRyeSBvciBjaXR5JylcbiAgICB9KSxcbiAgICBleGVjdXRlOiBhc3luYyBmdW5jdGlvbiAoeyBhbW91bnQgPSAxMDAsIGRlc3RpbmF0aW9uIH0pIHtcbiAgICAgICAgaWYgKCFkZXN0aW5hdGlvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEZXN0aW5hdGlvbiBpcyByZXF1aXJlZCBmb3IgY3VycmVuY3kgY29udmVyc2lvbicpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYmFzZUN1cnJlbmN5ID0gZ2V0Q3VycmVuY3lGcm9tQ291bnRyeShkZXN0aW5hdGlvbik7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogJ2N1cnJlbmN5Q29udmVydGVyJyxcbiAgICAgICAgICAgIHByb3BzOiB7XG4gICAgICAgICAgICAgICAgYmFzZUN1cnJlbmN5LFxuICAgICAgICAgICAgICAgIGJhc2VBbW91bnQ6IGFtb3VudCxcbiAgICAgICAgICAgICAgICBkZWZhdWx0Q3VycmVuY2llczogWydVU0QnLCAnRVVSJywgJ0dCUCcsICdDTlknLCAnSlBZJ11cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG59KTtcblxuLy8gRXhwb3J0IGFsbCB0b29scyB3aXRoIHRoZWlyIG5hbWVzXG5leHBvcnQgY29uc3QgdG9vbHMgPSB7XG4gICAgYnVkZ2V0U2VsZWN0b3I6IGJ1ZGdldFNlbGVjdG9yVG9vbCxcbiAgICBwcmVmZXJlbmNlU2VsZWN0b3I6IHByZWZlcmVuY2VTZWxlY3RvclRvb2wsXG4gICAgZGF0ZVBpY2tlcjogZGF0ZVBpY2tlclRvb2wsXG4gICAgbGFuZ3VhZ2VTZWxlY3RvcjogbGFuZ3VhZ2VTZWxlY3RvclRvb2wsXG4gICAgdHJhbnNwb3J0U2VsZWN0b3I6IHRyYW5zcG9ydFNlbGVjdG9yVG9vbCxcbiAgICBwbGFjZUNhcmQ6IHBsYWNlQ2FyZFRvb2wsXG4gICAgY2Fyb3VzZWw6IGNhcm91c2VsVG9vbCxcbiAgICBkZXRhaWxzQ2FyZDogZGV0YWlsc0NhcmRUb29sLFxuICAgIHdlYXRoZXJDaGFydDogd2VhdGhlckNoYXJ0VG9vbCxcbiAgICBzYXZlZFBsYWNlc0xpc3Q6IHNhdmVkUGxhY2VzTGlzdFRvb2wsXG4gICAgc3RhZ2VQcm9ncmVzczogc3RhZ2VQcm9ncmVzc1Rvb2wsXG4gICAgcXVpY2tSZXNwb25zZTogcXVpY2tSZXNwb25zZVRvb2wsXG4gICAgY3VycmVuY3lDb252ZXJ0ZXI6IGN1cnJlbmN5Q29udmVydGVyVG9vbFxufTsiXSwibmFtZXMiOlsidG9vbCIsImNyZWF0ZVRvb2wiLCJ6IiwiVHJhdmVsUHJlZmVyZW5jZSIsImZldGNoUGxhY2VzIiwic2VhcmNoUGxhY2VCeVRleHQiLCJ2YWxpZGF0ZVN0YWdlUHJvZ3Jlc3Npb24iLCJnZXRDdXJyZW5jeUZyb21Db3VudHJ5IiwiYnVkZ2V0U2VsZWN0b3JUb29sIiwiZGVzY3JpcHRpb24iLCJwYXJhbWV0ZXJzIiwib2JqZWN0IiwiY3VycmVudEJ1ZGdldCIsImVudW0iLCJvcHRpb25hbCIsImV4ZWN1dGUiLCJ0eXBlIiwicHJvcHMiLCJwcmVmZXJlbmNlU2VsZWN0b3JUb29sIiwiY3VycmVudFByZWZlcmVuY2VzIiwiYXJyYXkiLCJuYXRpdmVFbnVtIiwiZGF0ZVBpY2tlclRvb2wiLCJzdGFydERhdGUiLCJzdHJpbmciLCJlbmREYXRlIiwibGFuZ3VhZ2VTZWxlY3RvclRvb2wiLCJjdXJyZW50TGFuZ3VhZ2UiLCJ0cmFuc3BvcnRTZWxlY3RvclRvb2wiLCJzZWxlY3RlZE1ldGhvZCIsInBsYWNlQ2FyZFRvb2wiLCJzZWFyY2hUZXh0IiwiZGVzY3JpYmUiLCJsb2NhdGlvbiIsImxhdGl0dWRlIiwibnVtYmVyIiwibG9uZ2l0dWRlIiwiZGVzdGluYXRpb24iLCJwbGFjZSIsImNvbnNvbGUiLCJlcnJvciIsImNhcm91c2VsVG9vbCIsInByZWZlcmVuY2VzIiwicGxhY2VUeXBlIiwibWF4UmVzdWx0cyIsImRlZmF1bHQiLCJwbGFjZXMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJkZXRhaWxzQ2FyZFRvb2wiLCJjb250ZW50IiwiZGF0ZXMiLCJidWRnZXQiLCJsYW5ndWFnZSIsInRyYW5zcG9ydCIsImRpbmluZyIsIndlYXRoZXJDaGFydFRvb2wiLCJsYXQiLCJtaW4iLCJtYXgiLCJsb24iLCJjaXR5IiwidW5pdHMiLCJzdGFydERheSIsInN0YXJ0TW9udGgiLCJzdGFydFllYXIiLCJzcGxpdCIsIm1hcCIsIk51bWJlciIsImVuZERheSIsImVuZE1vbnRoIiwiZW5kWWVhciIsImZvcm1hdHRlZFN0YXJ0RGF0ZSIsIlN0cmluZyIsInBhZFN0YXJ0IiwiZm9ybWF0dGVkRW5kRGF0ZSIsInN0YXJ0IiwiRGF0ZSIsImVuZCIsImRheXNEaWZmIiwiTWF0aCIsImNlaWwiLCJnZXRUaW1lIiwiZXh0cmFEYXlzIiwiZGF5c1RvQWRkQmVmb3JlIiwiZmxvb3IiLCJkYXlzVG9BZGRBZnRlciIsInNldERhdGUiLCJnZXREYXRlIiwiZXh0ZW5kZWRTdGFydERhdGUiLCJ0b0lTT1N0cmluZyIsImV4dGVuZGVkRW5kRGF0ZSIsImxvZyIsIm9yaWdpbmFsRGF0ZSIsIm9yaWdpbmFsRW5kRGF0ZSIsInRvdGFsRGF5cyIsIm9yaWdpbmFsUmFuZ2UiLCJhZGRlZEJlZm9yZSIsImFkZGVkQWZ0ZXIiLCJzYXZlZFBsYWNlc0xpc3RUb29sIiwic2F2ZWRQbGFjZXMiLCJpZCIsImRpc3BsYXlOYW1lIiwidW5pb24iLCJ0ZXh0IiwibGFuZ3VhZ2VDb2RlIiwicHJpbWFyeVR5cGUiLCJmb3JtYXR0ZWRBZGRyZXNzIiwicGhvdG9zIiwibmFtZSIsIndpZHRoUHgiLCJoZWlnaHRQeCIsImF1dGhvckF0dHJpYnV0aW9ucyIsInVyaSIsInBob3RvVXJpIiwicHJpbWFyeVR5cGVEaXNwbGF5TmFtZSIsInAiLCJoYXNQaG90b3MiLCJCb29sZWFuIiwicGhvdG9Db3VudCIsImZpcnN0UGhvdG8iLCJBcnJheSIsImlzQXJyYXkiLCJvblJlbW92ZSIsInN0YWdlUHJvZ3Jlc3NUb29sIiwibmV4dFN0YWdlIiwiY3VycmVudFN0YWdlIiwidHJhdmVsRGV0YWlscyIsIm1ldHJpY3MiLCJ0b3RhbFByb21wdHMiLCJzYXZlZFBsYWNlc0NvdW50IiwiaXNQYWlkIiwiYm9vbGVhbiIsInBheW1lbnRSZWZlcmVuY2UiLCJ2YWxpZGF0aW9uUmVzdWx0IiwiY2FuUHJvZ3Jlc3MiLCJtaXNzaW5nUmVxdWlyZW1lbnRzIiwic3RhdHVzIiwiam9pbiIsInF1aWNrUmVzcG9uc2VUb29sIiwicmVzcG9uc2VzIiwiRXJyb3IiLCJmb3JFYWNoIiwicmVzcG9uc2UiLCJpbmRleCIsInRyaW0iLCJjdXJyZW5jeUNvbnZlcnRlclRvb2wiLCJhbW91bnQiLCJiYXNlQ3VycmVuY3kiLCJiYXNlQW1vdW50IiwiZGVmYXVsdEN1cnJlbmNpZXMiLCJ0b29scyIsImJ1ZGdldFNlbGVjdG9yIiwicHJlZmVyZW5jZVNlbGVjdG9yIiwiZGF0ZVBpY2tlciIsImxhbmd1YWdlU2VsZWN0b3IiLCJ0cmFuc3BvcnRTZWxlY3RvciIsInBsYWNlQ2FyZCIsImNhcm91c2VsIiwiZGV0YWlsc0NhcmQiLCJ3ZWF0aGVyQ2hhcnQiLCJzYXZlZFBsYWNlc0xpc3QiLCJzdGFnZVByb2dyZXNzIiwicXVpY2tSZXNwb25zZSIsImN1cnJlbmN5Q29udmVydGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./ai/tools.ts\n");

/***/ }),

/***/ "(api)/./managers/stage-manager.ts":
/*!***********************************!*\
  !*** ./managers/stage-manager.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   STAGE_LIMITS: () => (/* binding */ STAGE_LIMITS),\n/* harmony export */   validateStageProgression: () => (/* binding */ validateStageProgression)\n/* harmony export */ });\n/* harmony import */ var _utils_session_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/session-manager */ \"(api)/./utils/session-manager.ts\");\n\n// Validation functions for each stage\nconst STAGE_LIMITS = {\n    3: {\n        maxPrompts: 1,\n        upgradeMessage: `I'm sorry to tell you that you have reached the prompts limit in the free version. \n    Would you like to upgrade to unlock unlimited places browsing and premium features? \n    This will give you access to personalized recommendations, detailed scheduling, and local insights.`\n    }\n};\nconst STAGE_VALIDATORS = {\n    // Stage 1: Initial Parameter Check\n    1: {\n        validate: (details)=>{\n            const missingRequirements = [];\n            if (!details.destination) missingRequirements.push(\"destination\");\n            if (!details.startDate) missingRequirements.push(\"start date\");\n            if (!details.endDate) missingRequirements.push(\"end date\");\n            if (!details.preferences?.length) missingRequirements.push(\"preferences\");\n            if (!details.language) missingRequirements.push(\"language\");\n            return {\n                isValid: missingRequirements.length === 0,\n                missingRequirements\n            };\n        }\n    },\n    // Stage 2: City Introduction\n    2: {\n        validate: (details, session)=>{\n            return {\n                isValid: true,\n                missingRequirements: []\n            };\n        }\n    },\n    // Stage 3: Places Introduction\n    3: {\n        validate: (details, session)=>{\n            const { totalPrompts, stagePrompts, savedPlaces } = session;\n            const stagePromptCount = stagePrompts?.[3] || 0;\n            const upgradeRequired = !session.isPaid && stagePromptCount >= STAGE_LIMITS[3].maxPrompts;\n            // Check if we have enough places saved\n            const minPlacesRequired = 3;\n            const hasEnoughPlaces = savedPlaces.length >= minPlacesRequired;\n            // Check if we have diverse place types based on preferences\n            const placeTypes = new Set(savedPlaces.map((p)=>p.primaryType));\n            const hasGoodCoverage = placeTypes.size >= Math.min(2, details.preferences.length);\n            const missingRequirements = [];\n            if (!hasEnoughPlaces) {\n                missingRequirements.push(`at least ${minPlacesRequired} places`);\n            }\n            if (!hasGoodCoverage) {\n                missingRequirements.push(\"more diverse place types\");\n            }\n            return {\n                isValid: !upgradeRequired && hasEnoughPlaces && hasGoodCoverage,\n                missingRequirements,\n                upgradeRequired\n            };\n        }\n    },\n    // Stage 4: Itinerary Review (with payment check)\n    4: {\n        validate: (details, session)=>{\n            const { isPaid, savedPlaces } = session;\n            const missingRequirements = [];\n            // Check payment status\n            if (!isPaid) {\n                missingRequirements.push(\"premium subscription\");\n            }\n            // Check minimum places for a good itinerary\n            const minPlacesForItinerary = 5;\n            if (savedPlaces.length < minPlacesForItinerary) {\n                missingRequirements.push(`at least ${minPlacesForItinerary} places`);\n            }\n            // Check place type distribution\n            const placeTypes = new Set(savedPlaces.map((p)=>p.primaryType));\n            const minPlaceTypes = Math.min(3, details.preferences.length);\n            if (placeTypes.size < minPlaceTypes) {\n                missingRequirements.push(\"more diverse place types\");\n            }\n            return {\n                isValid: missingRequirements.length === 0,\n                missingRequirements,\n                upgradeRequired: !isPaid\n            };\n        }\n    },\n    // Stage 5: Final Confirmation (keeping it open as requested)\n    5: {\n        validate: (_, session)=>{\n            const isPaid = session.isPaid;\n            return {\n                isValid: isPaid,\n                missingRequirements: isPaid ? [] : [\n                    \"premium subscription\"\n                ],\n                upgradeRequired: !isPaid\n            };\n        }\n    }\n};\n// Main validation function to be used in the chat component\nfunction validateStageProgression(currentStage, nextStage, travelDetails) {\n    let session = (0,_utils_session_manager__WEBPACK_IMPORTED_MODULE_0__.getStoredSession)();\n    // If no session exists but we have travel details, initialize one\n    if (!session && travelDetails.destination) {\n        session = (0,_utils_session_manager__WEBPACK_IMPORTED_MODULE_0__.initializeSession)();\n        session.destination = travelDetails.destination;\n        session.startDate = travelDetails.startDate || \"\";\n        session.endDate = travelDetails.endDate || \"\";\n        session.preferences = travelDetails.preferences || [];\n        session.budget = travelDetails.budget || \"\";\n        session.language = travelDetails.language || \"\";\n        session.transport = travelDetails.transport || [];\n        session.currentStage = currentStage;\n    }\n    if (!session) {\n        return {\n            canProgress: false,\n            missingRequirements: [\n                \"valid session\"\n            ]\n        };\n    }\n    // Ensure stage progression is sequential\n    if (nextStage !== currentStage + 1) {\n        return {\n            canProgress: false,\n            missingRequirements: [\n                \"invalid stage progression\"\n            ]\n        };\n    }\n    // Get validator for current stage\n    const validator = STAGE_VALIDATORS[currentStage];\n    if (!validator) {\n        return {\n            canProgress: true,\n            missingRequirements: []\n        };\n    }\n    // Check if current stage requirements are met before progressing\n    const { isValid, missingRequirements, upgradeRequired } = validator.validate(travelDetails, session);\n    // If current stage requirements are met, allow progression\n    if (isValid) {\n        return {\n            canProgress: true,\n            missingRequirements: [],\n            upgradeRequired\n        };\n    }\n    return {\n        canProgress: isValid,\n        missingRequirements,\n        upgradeRequired\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUEsSUFBSSxDQUFDdEIsU0FBUztRQUNaLE9BQU87WUFDTDJCLGFBQWE7WUFDYnBDLHFCQUFxQjtnQkFBQzthQUFnQjtRQUN4QztJQUNGO0lBRUEseUNBQXlDO0lBQ3pDLElBQUlnQyxjQUFjRCxlQUFlLEdBQUc7UUFDbEMsT0FBTztZQUNMSyxhQUFhO1lBQ2JwQyxxQkFBcUI7Z0JBQUM7YUFBNEI7UUFDcEQ7SUFDRjtJQUVBLGtDQUFrQztJQUNsQyxNQUFNcUMsWUFBWXhDLGdCQUFnQixDQUFDa0MsYUFBYTtJQUNoRCxJQUFJLENBQUNNLFdBQVc7UUFDZCxPQUFPO1lBQ0xELGFBQWE7WUFDYnBDLHFCQUFxQixFQUFFO1FBQ3pCO0lBQ0Y7SUFFQSxpRUFBaUU7SUFDakUsTUFBTSxFQUFFUSxPQUFPLEVBQUVSLG1CQUFtQixFQUFFYyxlQUFlLEVBQUUsR0FBR3VCLFVBQVV2QyxRQUFRLENBQzFFbUMsZUFDQXhCO0lBR0YsMkRBQTJEO0lBQzNELElBQUlELFNBQVM7UUFDWCxPQUFPO1lBQ0w0QixhQUFhO1lBQ2JwQyxxQkFBcUIsRUFBRTtZQUN2QmM7UUFDRjtJQUNGO0lBRUEsT0FBTztRQUNMc0IsYUFBYTVCO1FBQ2JSO1FBQ0FjO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYXZlbC1yaXp6Ly4vbWFuYWdlcnMvc3RhZ2UtbWFuYWdlci50cz8yYWRhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRyYXZlbERldGFpbHMsIFRyYXZlbFNlc3Npb24gfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IGdldFN0b3JlZFNlc3Npb24sIGluaXRpYWxpemVTZXNzaW9uIH0gZnJvbSAnLi4vdXRpbHMvc2Vzc2lvbi1tYW5hZ2VyJztcblxuLy8gSW50ZXJmYWNlIGZvciB0cmFja2luZyB1c2VyIGludGVyYWN0aW9uc1xuLy8gZXhwb3J0IGludGVyZmFjZSBVc2VySW50ZXJhY3Rpb25NZXRyaWNzIHtcbi8vICAgdG90YWxQcm9tcHRzOiBudW1iZXI7XG4vLyAgIHNhdmVkUGxhY2VzQ291bnQ6IG51bWJlcjtcbi8vICAgaXNQYWlkOiBib29sZWFuO1xuLy8gICBzdGFnZVByb21wdHM/OiBSZWNvcmQ8bnVtYmVyLCBudW1iZXI+O1xuLy8gICBwYXltZW50UmVmZXJlbmNlOiBzdHJpbmc7IC8vIFRyYWNrIHBheW1lbnQgcmVmZXJlbmNlIElEIC0gcmVxdWlyZWRcbi8vIH1cblxuLy8gRGVmaW5lIHJlcXVpcmVtZW50cyBmb3IgZWFjaCBzdGFnZVxuaW50ZXJmYWNlIFN0YWdlUmVxdWlyZW1lbnRzIHtcbiAgdmFsaWRhdGU6IChcbiAgICB0cmF2ZWxEZXRhaWxzOiBUcmF2ZWxEZXRhaWxzLFxuICAgIHNlc3Npb246IFRyYXZlbFNlc3Npb25cbiAgKSA9PiB7XG4gICAgaXNWYWxpZDogYm9vbGVhbjtcbiAgICBtaXNzaW5nUmVxdWlyZW1lbnRzOiBzdHJpbmdbXTtcbiAgICB1cGdyYWRlUmVxdWlyZWQ/OiBib29sZWFuO1xuICB9O1xufVxuXG4vLyBWYWxpZGF0aW9uIGZ1bmN0aW9ucyBmb3IgZWFjaCBzdGFnZVxuZXhwb3J0IGNvbnN0IFNUQUdFX0xJTUlUUyA9IHtcbiAgMzoge1xuICAgIG1heFByb21wdHM6IDEsXG4gICAgdXBncmFkZU1lc3NhZ2U6IGBJJ20gc29ycnkgdG8gdGVsbCB5b3UgdGhhdCB5b3UgaGF2ZSByZWFjaGVkIHRoZSBwcm9tcHRzIGxpbWl0IGluIHRoZSBmcmVlIHZlcnNpb24uIFxuICAgIFdvdWxkIHlvdSBsaWtlIHRvIHVwZ3JhZGUgdG8gdW5sb2NrIHVubGltaXRlZCBwbGFjZXMgYnJvd3NpbmcgYW5kIHByZW1pdW0gZmVhdHVyZXM/IFxuICAgIFRoaXMgd2lsbCBnaXZlIHlvdSBhY2Nlc3MgdG8gcGVyc29uYWxpemVkIHJlY29tbWVuZGF0aW9ucywgZGV0YWlsZWQgc2NoZWR1bGluZywgYW5kIGxvY2FsIGluc2lnaHRzLmBcbiAgfVxufSBhcyBjb25zdDtcblxuY29uc3QgU1RBR0VfVkFMSURBVE9SUzogUmVjb3JkPG51bWJlciwgU3RhZ2VSZXF1aXJlbWVudHM+ID0ge1xuICAvLyBTdGFnZSAxOiBJbml0aWFsIFBhcmFtZXRlciBDaGVja1xuICAxOiB7XG4gICAgdmFsaWRhdGU6IChkZXRhaWxzOiBUcmF2ZWxEZXRhaWxzKSA9PiB7XG4gICAgICBjb25zdCBtaXNzaW5nUmVxdWlyZW1lbnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgXG4gICAgICBpZiAoIWRldGFpbHMuZGVzdGluYXRpb24pIG1pc3NpbmdSZXF1aXJlbWVudHMucHVzaCgnZGVzdGluYXRpb24nKTtcbiAgICAgIGlmICghZGV0YWlscy5zdGFydERhdGUpIG1pc3NpbmdSZXF1aXJlbWVudHMucHVzaCgnc3RhcnQgZGF0ZScpO1xuICAgICAgaWYgKCFkZXRhaWxzLmVuZERhdGUpIG1pc3NpbmdSZXF1aXJlbWVudHMucHVzaCgnZW5kIGRhdGUnKTtcbiAgICAgIGlmICghZGV0YWlscy5wcmVmZXJlbmNlcz8ubGVuZ3RoKSBtaXNzaW5nUmVxdWlyZW1lbnRzLnB1c2goJ3ByZWZlcmVuY2VzJyk7XG4gICAgICBpZiAoIWRldGFpbHMubGFuZ3VhZ2UpIG1pc3NpbmdSZXF1aXJlbWVudHMucHVzaCgnbGFuZ3VhZ2UnKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogbWlzc2luZ1JlcXVpcmVtZW50cy5sZW5ndGggPT09IDAsXG4gICAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHNcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIC8vIFN0YWdlIDI6IENpdHkgSW50cm9kdWN0aW9uXG4gIDI6IHtcbiAgICB2YWxpZGF0ZTogKGRldGFpbHM6IFRyYXZlbERldGFpbHMsIHNlc3Npb246IFRyYXZlbFNlc3Npb24pID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzVmFsaWQ6IHRydWUsXG4gICAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHM6IFtdXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICAvLyBTdGFnZSAzOiBQbGFjZXMgSW50cm9kdWN0aW9uXG4gIDM6IHtcbiAgICB2YWxpZGF0ZTogKGRldGFpbHM6IFRyYXZlbERldGFpbHMsIHNlc3Npb246IFRyYXZlbFNlc3Npb24pID0+IHtcbiAgICAgIGNvbnN0IHsgdG90YWxQcm9tcHRzLCBzdGFnZVByb21wdHMsIHNhdmVkUGxhY2VzIH0gPSBzZXNzaW9uO1xuICAgICAgY29uc3Qgc3RhZ2VQcm9tcHRDb3VudCA9IHN0YWdlUHJvbXB0cz8uWzNdIHx8IDA7XG4gICAgICBjb25zdCB1cGdyYWRlUmVxdWlyZWQgPSAhc2Vzc2lvbi5pc1BhaWQgJiYgc3RhZ2VQcm9tcHRDb3VudCA+PSBTVEFHRV9MSU1JVFNbM10ubWF4UHJvbXB0cztcblxuICAgICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBlbm91Z2ggcGxhY2VzIHNhdmVkXG4gICAgICBjb25zdCBtaW5QbGFjZXNSZXF1aXJlZCA9IDM7XG4gICAgICBjb25zdCBoYXNFbm91Z2hQbGFjZXMgPSBzYXZlZFBsYWNlcy5sZW5ndGggPj0gbWluUGxhY2VzUmVxdWlyZWQ7XG5cbiAgICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgZGl2ZXJzZSBwbGFjZSB0eXBlcyBiYXNlZCBvbiBwcmVmZXJlbmNlc1xuICAgICAgY29uc3QgcGxhY2VUeXBlcyA9IG5ldyBTZXQoc2F2ZWRQbGFjZXMubWFwKHAgPT4gcC5wcmltYXJ5VHlwZSkpO1xuICAgICAgY29uc3QgaGFzR29vZENvdmVyYWdlID0gcGxhY2VUeXBlcy5zaXplID49IE1hdGgubWluKDIsIGRldGFpbHMucHJlZmVyZW5jZXMubGVuZ3RoKTtcblxuICAgICAgY29uc3QgbWlzc2luZ1JlcXVpcmVtZW50czogc3RyaW5nW10gPSBbXTtcbiAgICAgIGlmICghaGFzRW5vdWdoUGxhY2VzKSB7XG4gICAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHMucHVzaChgYXQgbGVhc3QgJHttaW5QbGFjZXNSZXF1aXJlZH0gcGxhY2VzYCk7XG4gICAgICB9XG4gICAgICBpZiAoIWhhc0dvb2RDb3ZlcmFnZSkge1xuICAgICAgICBtaXNzaW5nUmVxdWlyZW1lbnRzLnB1c2goJ21vcmUgZGl2ZXJzZSBwbGFjZSB0eXBlcycpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc1ZhbGlkOiAhdXBncmFkZVJlcXVpcmVkICYmIGhhc0Vub3VnaFBsYWNlcyAmJiBoYXNHb29kQ292ZXJhZ2UsXG4gICAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHMsXG4gICAgICAgIHVwZ3JhZGVSZXF1aXJlZFxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gU3RhZ2UgNDogSXRpbmVyYXJ5IFJldmlldyAod2l0aCBwYXltZW50IGNoZWNrKVxuICA0OiB7XG4gICAgdmFsaWRhdGU6IChkZXRhaWxzOiBUcmF2ZWxEZXRhaWxzLCBzZXNzaW9uOiBUcmF2ZWxTZXNzaW9uKSA9PiB7XG4gICAgICBjb25zdCB7IGlzUGFpZCwgc2F2ZWRQbGFjZXMgfSA9IHNlc3Npb247XG4gICAgICBjb25zdCBtaXNzaW5nUmVxdWlyZW1lbnRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAvLyBDaGVjayBwYXltZW50IHN0YXR1c1xuICAgICAgaWYgKCFpc1BhaWQpIHtcbiAgICAgICAgbWlzc2luZ1JlcXVpcmVtZW50cy5wdXNoKCdwcmVtaXVtIHN1YnNjcmlwdGlvbicpO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBtaW5pbXVtIHBsYWNlcyBmb3IgYSBnb29kIGl0aW5lcmFyeVxuICAgICAgY29uc3QgbWluUGxhY2VzRm9ySXRpbmVyYXJ5ID0gNTtcbiAgICAgIGlmIChzYXZlZFBsYWNlcy5sZW5ndGggPCBtaW5QbGFjZXNGb3JJdGluZXJhcnkpIHtcbiAgICAgICAgbWlzc2luZ1JlcXVpcmVtZW50cy5wdXNoKGBhdCBsZWFzdCAke21pblBsYWNlc0Zvckl0aW5lcmFyeX0gcGxhY2VzYCk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIHBsYWNlIHR5cGUgZGlzdHJpYnV0aW9uXG4gICAgICBjb25zdCBwbGFjZVR5cGVzID0gbmV3IFNldChzYXZlZFBsYWNlcy5tYXAocCA9PiBwLnByaW1hcnlUeXBlKSk7XG4gICAgICBjb25zdCBtaW5QbGFjZVR5cGVzID0gTWF0aC5taW4oMywgZGV0YWlscy5wcmVmZXJlbmNlcy5sZW5ndGgpO1xuICAgICAgaWYgKHBsYWNlVHlwZXMuc2l6ZSA8IG1pblBsYWNlVHlwZXMpIHtcbiAgICAgICAgbWlzc2luZ1JlcXVpcmVtZW50cy5wdXNoKCdtb3JlIGRpdmVyc2UgcGxhY2UgdHlwZXMnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNWYWxpZDogbWlzc2luZ1JlcXVpcmVtZW50cy5sZW5ndGggPT09IDAsXG4gICAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHMsXG4gICAgICAgIHVwZ3JhZGVSZXF1aXJlZDogIWlzUGFpZFxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gU3RhZ2UgNTogRmluYWwgQ29uZmlybWF0aW9uIChrZWVwaW5nIGl0IG9wZW4gYXMgcmVxdWVzdGVkKVxuICA1OiB7XG4gICAgdmFsaWRhdGU6IChfLCBzZXNzaW9uOiBUcmF2ZWxTZXNzaW9uKSA9PiB7XG4gICAgICBjb25zdCBpc1BhaWQgPSBzZXNzaW9uLmlzUGFpZDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzVmFsaWQ6IGlzUGFpZCxcbiAgICAgICAgbWlzc2luZ1JlcXVpcmVtZW50czogaXNQYWlkID8gW10gOiBbJ3ByZW1pdW0gc3Vic2NyaXB0aW9uJ10sXG4gICAgICAgIHVwZ3JhZGVSZXF1aXJlZDogIWlzUGFpZFxuICAgICAgfTtcbiAgICB9XG4gIH1cbn07XG5cbi8vIE1haW4gdmFsaWRhdGlvbiBmdW5jdGlvbiB0byBiZSB1c2VkIGluIHRoZSBjaGF0IGNvbXBvbmVudFxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlU3RhZ2VQcm9ncmVzc2lvbihcbiAgY3VycmVudFN0YWdlOiBudW1iZXIsXG4gIG5leHRTdGFnZTogbnVtYmVyLFxuICB0cmF2ZWxEZXRhaWxzOiBUcmF2ZWxEZXRhaWxzXG4pOiB7XG4gIGNhblByb2dyZXNzOiBib29sZWFuO1xuICBtaXNzaW5nUmVxdWlyZW1lbnRzOiBzdHJpbmdbXTtcbiAgdXBncmFkZVJlcXVpcmVkPzogYm9vbGVhbjtcbn0ge1xuICBsZXQgc2Vzc2lvbiA9IGdldFN0b3JlZFNlc3Npb24oKTtcbiAgXG4gIC8vIElmIG5vIHNlc3Npb24gZXhpc3RzIGJ1dCB3ZSBoYXZlIHRyYXZlbCBkZXRhaWxzLCBpbml0aWFsaXplIG9uZVxuICBpZiAoIXNlc3Npb24gJiYgdHJhdmVsRGV0YWlscy5kZXN0aW5hdGlvbikge1xuICAgIHNlc3Npb24gPSBpbml0aWFsaXplU2Vzc2lvbigpO1xuICAgIHNlc3Npb24uZGVzdGluYXRpb24gPSB0cmF2ZWxEZXRhaWxzLmRlc3RpbmF0aW9uO1xuICAgIHNlc3Npb24uc3RhcnREYXRlID0gdHJhdmVsRGV0YWlscy5zdGFydERhdGUgfHwgJyc7XG4gICAgc2Vzc2lvbi5lbmREYXRlID0gdHJhdmVsRGV0YWlscy5lbmREYXRlIHx8ICcnO1xuICAgIHNlc3Npb24ucHJlZmVyZW5jZXMgPSB0cmF2ZWxEZXRhaWxzLnByZWZlcmVuY2VzIHx8IFtdO1xuICAgIHNlc3Npb24uYnVkZ2V0ID0gdHJhdmVsRGV0YWlscy5idWRnZXQgfHwgJyc7XG4gICAgc2Vzc2lvbi5sYW5ndWFnZSA9IHRyYXZlbERldGFpbHMubGFuZ3VhZ2UgfHwgJyc7XG4gICAgc2Vzc2lvbi50cmFuc3BvcnQgPSB0cmF2ZWxEZXRhaWxzLnRyYW5zcG9ydCB8fCBbXTtcbiAgICBzZXNzaW9uLmN1cnJlbnRTdGFnZSA9IGN1cnJlbnRTdGFnZTtcbiAgfVxuXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHJldHVybiB7XG4gICAgICBjYW5Qcm9ncmVzczogZmFsc2UsXG4gICAgICBtaXNzaW5nUmVxdWlyZW1lbnRzOiBbJ3ZhbGlkIHNlc3Npb24nXVxuICAgIH07XG4gIH1cblxuICAvLyBFbnN1cmUgc3RhZ2UgcHJvZ3Jlc3Npb24gaXMgc2VxdWVudGlhbFxuICBpZiAobmV4dFN0YWdlICE9PSBjdXJyZW50U3RhZ2UgKyAxKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNhblByb2dyZXNzOiBmYWxzZSxcbiAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHM6IFsnaW52YWxpZCBzdGFnZSBwcm9ncmVzc2lvbiddXG4gICAgfTtcbiAgfVxuXG4gIC8vIEdldCB2YWxpZGF0b3IgZm9yIGN1cnJlbnQgc3RhZ2VcbiAgY29uc3QgdmFsaWRhdG9yID0gU1RBR0VfVkFMSURBVE9SU1tjdXJyZW50U3RhZ2VdO1xuICBpZiAoIXZhbGlkYXRvcikge1xuICAgIHJldHVybiB7XG4gICAgICBjYW5Qcm9ncmVzczogdHJ1ZSxcbiAgICAgIG1pc3NpbmdSZXF1aXJlbWVudHM6IFtdXG4gICAgfTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIGN1cnJlbnQgc3RhZ2UgcmVxdWlyZW1lbnRzIGFyZSBtZXQgYmVmb3JlIHByb2dyZXNzaW5nXG4gIGNvbnN0IHsgaXNWYWxpZCwgbWlzc2luZ1JlcXVpcmVtZW50cywgdXBncmFkZVJlcXVpcmVkIH0gPSB2YWxpZGF0b3IudmFsaWRhdGUoXG4gICAgdHJhdmVsRGV0YWlscyxcbiAgICBzZXNzaW9uXG4gICk7XG5cbiAgLy8gSWYgY3VycmVudCBzdGFnZSByZXF1aXJlbWVudHMgYXJlIG1ldCwgYWxsb3cgcHJvZ3Jlc3Npb25cbiAgaWYgKGlzVmFsaWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgY2FuUHJvZ3Jlc3M6IHRydWUsXG4gICAgICBtaXNzaW5nUmVxdWlyZW1lbnRzOiBbXSxcbiAgICAgIHVwZ3JhZGVSZXF1aXJlZFxuICAgIH07XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNhblByb2dyZXNzOiBpc1ZhbGlkLFxuICAgIG1pc3NpbmdSZXF1aXJlbWVudHMsXG4gICAgdXBncmFkZVJlcXVpcmVkXG4gIH07XG59XG4iXSwibmFtZXMiOlsiZ2V0U3RvcmVkU2Vzc2lvbiIsImluaXRpYWxpemVTZXNzaW9uIiwiU1RBR0VfTElNSVRTIiwibWF4UHJvbXB0cyIsInVwZ3JhZGVNZXNzYWdlIiwiU1RBR0VfVkFMSURBVE9SUyIsInZhbGlkYXRlIiwiZGV0YWlscyIsIm1pc3NpbmdSZXF1aXJlbWVudHMiLCJkZXN0aW5hdGlvbiIsInB1c2giLCJzdGFydERhdGUiLCJlbmREYXRlIiwicHJlZmVyZW5jZXMiLCJsZW5ndGgiLCJsYW5ndWFnZSIsImlzVmFsaWQiLCJzZXNzaW9uIiwidG90YWxQcm9tcHRzIiwic3RhZ2VQcm9tcHRzIiwic2F2ZWRQbGFjZXMiLCJzdGFnZVByb21wdENvdW50IiwidXBncmFkZVJlcXVpcmVkIiwiaXNQYWlkIiwibWluUGxhY2VzUmVxdWlyZWQiLCJoYXNFbm91Z2hQbGFjZXMiLCJwbGFjZVR5cGVzIiwiU2V0IiwibWFwIiwicCIsInByaW1hcnlUeXBlIiwiaGFzR29vZENvdmVyYWdlIiwic2l6ZSIsIk1hdGgiLCJtaW4iLCJtaW5QbGFjZXNGb3JJdGluZXJhcnkiLCJtaW5QbGFjZVR5cGVzIiwiXyIsInZhbGlkYXRlU3RhZ2VQcm9ncmVzc2lvbiIsImN1cnJlbnRTdGFnZSIsIm5leHRTdGFnZSIsInRyYXZlbERldGFpbHMiLCJidWRnZXQiLCJ0cmFuc3BvcnQiLCJjYW5Qcm9ncmVzcyIsInZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./managers/stage-manager.ts\n");

/***/ }),

/***/ "(api)/./managers/types.ts":
/*!***************************!*\
  !*** ./managers/types.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BUDGET_DESCRIPTIONS: () => (/* binding */ BUDGET_DESCRIPTIONS),\n/* harmony export */   BUDGET_OPTIONS: () => (/* binding */ BUDGET_OPTIONS),\n/* harmony export */   BudgetLevel: () => (/* binding */ BudgetLevel),\n/* harmony export */   CURRENCY_INFO: () => (/* binding */ CURRENCY_INFO),\n/* harmony export */   ComponentType: () => (/* binding */ ComponentType),\n/* harmony export */   DEFAULT_CURRENCIES: () => (/* binding */ DEFAULT_CURRENCIES),\n/* harmony export */   LANGUAGE_LABELS: () => (/* binding */ LANGUAGE_LABELS),\n/* harmony export */   LANGUAGE_OPTIONS: () => (/* binding */ LANGUAGE_OPTIONS),\n/* harmony export */   PREFERENCE_ICONS: () => (/* binding */ PREFERENCE_ICONS),\n/* harmony export */   PREFERENCE_OPTIONS: () => (/* binding */ PREFERENCE_OPTIONS),\n/* harmony export */   SupportedLanguage: () => (/* binding */ SupportedLanguage),\n/* harmony export */   TravelPreference: () => (/* binding */ TravelPreference)\n/* harmony export */ });\n///Users/terrancehah/Documents/terrancehah.com/managers/types.ts\nvar ComponentType;\n(function(ComponentType) {\n    ComponentType[\"DatePicker\"] = \"DatePicker\";\n    ComponentType[\"PreferenceSelector\"] = \"PreferenceSelector\";\n    ComponentType[\"BudgetSelector\"] = \"BudgetSelector\";\n    ComponentType[\"LanguageSelector\"] = \"LanguageSelector\";\n    ComponentType[\"PlaceCard\"] = \"PlaceCard\";\n    ComponentType[\"TransportSelector\"] = \"TransportSelector\";\n    ComponentType[\"Carousel\"] = \"Carousel\";\n    ComponentType[\"DetailsCard\"] = \"DetailsCard\";\n    ComponentType[\"SavedPlacesCarousel\"] = \"SavedPlacesCarousel\";\n    ComponentType[\"QuickResponse\"] = \"QuickResponse\";\n})(ComponentType || (ComponentType = {}));\nvar BudgetLevel;\n(function(BudgetLevel) {\n    BudgetLevel[\"Budget\"] = \"$\";\n    BudgetLevel[\"Moderate\"] = \"$$\";\n    BudgetLevel[\"Luxury\"] = \"$$$\";\n    BudgetLevel[\"UltraLuxury\"] = \"$$$$\";\n})(BudgetLevel || (BudgetLevel = {}));\nvar TravelPreference;\n(function(TravelPreference) {\n    TravelPreference[\"Culture\"] = \"Culture and Heritage\";\n    TravelPreference[\"Nature\"] = \"Nature\";\n    TravelPreference[\"Food\"] = \"Foodie\";\n    TravelPreference[\"Relaxation\"] = \"Leisure\";\n    TravelPreference[\"Adventure\"] = \"Adventure\";\n    TravelPreference[\"Shopping\"] = \"Arts & Museum\";\n})(TravelPreference || (TravelPreference = {}));\nvar SupportedLanguage;\n(function(SupportedLanguage) {\n    SupportedLanguage[\"English\"] = \"English\";\n    SupportedLanguage[\"Malay\"] = \"Malay (Bahasa Melayu)\";\n    SupportedLanguage[\"Spanish\"] = \"Espanol\";\n    SupportedLanguage[\"French\"] = \"Francais\";\n    SupportedLanguage[\"German\"] = \"Deutsch\";\n    SupportedLanguage[\"Italian\"] = \"Italiano\";\n    SupportedLanguage[\"Czech\"] = \"Czech (Cestina)\";\n    SupportedLanguage[\"SimplifiedChinese\"] = \"Simplified Chinese ()\";\n    SupportedLanguage[\"TraditionalChinese\"] = \"Traditional Chinese ()\";\n    SupportedLanguage[\"Japanese\"] = \"Japanese ()\";\n    SupportedLanguage[\"Korean\"] = \"Korean ()\";\n})(SupportedLanguage || (SupportedLanguage = {}));\nconst BUDGET_DESCRIPTIONS = {\n    [\"$\"]: \"Budget-friendly options ($)\",\n    [\"$$\"]: \"Mid-range options ($$)\",\n    [\"$$$\"]: \"High-end options ($$$)\",\n    [\"$$$$\"]: \"Ultra luxury options ($$$$)\"\n};\nconst PREFERENCE_ICONS = {\n    [\"Culture and Heritage\"]: \"\\uD83C\\uDF8F\",\n    [\"Nature\"]: \"\\uD83C\\uDF40\",\n    [\"Foodie\"]: \"\\uD83C\\uDF71\",\n    [\"Leisure\"]: \"\\uD83C\\uDF07\",\n    [\"Adventure\"]: \"\\uD83E\\uDE82\",\n    [\"Arts & Museum\"]: \"\\uD83C\\uDFA8\"\n};\nconst LANGUAGE_LABELS = {\n    [\"English\"]: \"English\",\n    [\"Malay (Bahasa Melayu)\"]: \"Malay (Bahasa Melayu)\",\n    [\"Espanol\"]: \"Espanol\",\n    [\"Francais\"]: \"Francais\",\n    [\"Deutsch\"]: \"Deutsch\",\n    [\"Italiano\"]: \"Italiano\",\n    [\"Czech (Cestina)\"]: \"Czech (Cestina)\",\n    [\"Simplified Chinese ()\"]: \"Simplified Chinese ()\",\n    [\"Traditional Chinese ()\"]: \"Traditional Chinese ()\",\n    [\"Japanese ()\"]: \"Japanese ()\",\n    [\"Korean ()\"]: \"Korean ()\"\n};\nconst BUDGET_OPTIONS = [\n    {\n        value: \"$\",\n        label: \"Budget\",\n        description: \"Budget-friendly options with basic amenities\"\n    },\n    {\n        value: \"$$\",\n        label: \"Moderate\",\n        description: \"Mid-range options with good value\"\n    },\n    {\n        value: \"$$$\",\n        label: \"Luxury\",\n        description: \"High-end options with premium services\"\n    },\n    {\n        value: \"$$$$\",\n        label: \"Ultra Luxury\",\n        description: \"Exclusive luxury experiences\"\n    }\n];\nconst LANGUAGE_OPTIONS = Object.entries(SupportedLanguage).map(([key, value])=>({\n        value,\n        label: LANGUAGE_LABELS[value]\n    }));\nconst PREFERENCE_OPTIONS = [\n    {\n        value: \"Culture and Heritage\",\n        label: \"Culture and Heritage\",\n        icon: PREFERENCE_ICONS[\"Culture and Heritage\"]\n    },\n    {\n        value: \"Nature\",\n        label: \"Nature\",\n        icon: PREFERENCE_ICONS[\"Nature\"]\n    },\n    {\n        value: \"Foodie\",\n        label: \"Foodie\",\n        icon: PREFERENCE_ICONS[\"Foodie\"]\n    },\n    {\n        value: \"Leisure\",\n        label: \"Leisure\",\n        icon: PREFERENCE_ICONS[\"Leisure\"]\n    },\n    {\n        value: \"Adventure\",\n        label: \"Adventure\",\n        icon: PREFERENCE_ICONS[\"Adventure\"]\n    },\n    {\n        value: \"Arts & Museum\",\n        label: \"Arts & Museum\",\n        icon: PREFERENCE_ICONS[\"Arts & Museum\"]\n    }\n];\nconst CURRENCY_INFO = {\n    \"USD\": {\n        name: \"US Dollar\",\n        symbol: \"$\",\n        position: \"before\"\n    },\n    \"EUR\": {\n        name: \"Euro\",\n        symbol: \"\",\n        position: \"before\"\n    },\n    \"GBP\": {\n        name: \"British Pound\",\n        symbol: \"\\xa3\",\n        position: \"before\"\n    },\n    \"CNY\": {\n        name: \"Chinese Yuan\",\n        symbol: \"\\xa5\",\n        position: \"before\"\n    },\n    \"JPY\": {\n        name: \"Japanese Yen\",\n        symbol: \"\\xa5\",\n        position: \"before\"\n    },\n    \"SGD\": {\n        name: \"Singapore Dollar\",\n        symbol: \"S$\",\n        position: \"before\"\n    },\n    \"MYR\": {\n        name: \"Malaysian Ringgit\",\n        symbol: \"RM\",\n        position: \"before\"\n    },\n    \"KRW\": {\n        name: \"South Korean Won\",\n        symbol: \"\",\n        position: \"before\"\n    },\n    \"AUD\": {\n        name: \"Australian Dollar\",\n        symbol: \"A$\",\n        position: \"before\"\n    },\n    \"CAD\": {\n        name: \"Canadian Dollar\",\n        symbol: \"C$\",\n        position: \"before\"\n    }\n};\nconst DEFAULT_CURRENCIES = [\n    \"USD\",\n    \"EUR\",\n    \"GBP\",\n    \"CNY\",\n    \"JPY\"\n];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q25FLE9BQU87UUFBRUYsTUFBTTtRQUFxQkMsUUFBUTtRQUFNQyxVQUFVO0lBQVM7SUFDckUsT0FBTztRQUFFRixNQUFNO1FBQW1CQyxRQUFRO1FBQU1DLFVBQVU7SUFBUztBQUN2RSxFQUFFO0FBWUssTUFBTUMscUJBQXFCO0lBQUM7SUFBTztJQUFPO0lBQU87SUFBTztDQUFNLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmF2ZWwtcml6ei8uL21hbmFnZXJzL3R5cGVzLnRzP2NkOWIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8vVXNlcnMvdGVycmFuY2VoYWgvRG9jdW1lbnRzL3RlcnJhbmNlaGFoLmNvbS9tYW5hZ2Vycy90eXBlcy50c1xuXG5pbXBvcnQgeyBNZXNzYWdlIGFzIEFpTWVzc2FnZSwgSlNPTlZhbHVlIH0gZnJvbSAnYWknO1xuaW1wb3J0IHsgUGxhY2UgfSBmcm9tICcuLi91dGlscy9wbGFjZXMtdXRpbHMnO1xuaW1wb3J0IHsgUmVhY3ROb2RlIH0gZnJvbSAncmVhY3QnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRyYXZlbERldGFpbHMge1xuICAgIGRlc3RpbmF0aW9uOiBzdHJpbmc7XG4gICAgbG9jYXRpb24/OiB7XG4gICAgICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIH07XG4gICAgc3RhcnREYXRlOiBzdHJpbmc7XG4gICAgZW5kRGF0ZTogc3RyaW5nO1xuICAgIHByZWZlcmVuY2VzOiBzdHJpbmdbXTtcbiAgICBidWRnZXQ6IHN0cmluZztcbiAgICBsYW5ndWFnZTogc3RyaW5nO1xuICAgIHRyYW5zcG9ydDogc3RyaW5nW107XG59XG5cbmV4cG9ydCBlbnVtIENvbXBvbmVudFR5cGUge1xuICAgIERhdGVQaWNrZXIgPSAnRGF0ZVBpY2tlcicsXG4gICAgUHJlZmVyZW5jZVNlbGVjdG9yID0gJ1ByZWZlcmVuY2VTZWxlY3RvcicsXG4gICAgQnVkZ2V0U2VsZWN0b3IgPSAnQnVkZ2V0U2VsZWN0b3InLFxuICAgIExhbmd1YWdlU2VsZWN0b3IgPSAnTGFuZ3VhZ2VTZWxlY3RvcicsXG4gICAgUGxhY2VDYXJkID0gJ1BsYWNlQ2FyZCcsXG4gICAgVHJhbnNwb3J0U2VsZWN0b3IgPSAnVHJhbnNwb3J0U2VsZWN0b3InLFxuICAgIENhcm91c2VsID0gJ0Nhcm91c2VsJyxcbiAgICBEZXRhaWxzQ2FyZCA9ICdEZXRhaWxzQ2FyZCcsXG4gICAgU2F2ZWRQbGFjZXNDYXJvdXNlbCA9ICdTYXZlZFBsYWNlc0Nhcm91c2VsJyxcbiAgICBRdWlja1Jlc3BvbnNlID0gJ1F1aWNrUmVzcG9uc2UnXG59XG5cbmV4cG9ydCBlbnVtIEJ1ZGdldExldmVsIHtcbiAgICBCdWRnZXQgPSAnJCcsXG4gICAgTW9kZXJhdGUgPSAnJCQnLFxuICAgIEx1eHVyeSA9ICckJCQnLFxuICAgIFVsdHJhTHV4dXJ5ID0gJyQkJCQnXG59XG5cbmV4cG9ydCBlbnVtIFRyYXZlbFByZWZlcmVuY2Uge1xuICAgIEN1bHR1cmUgPSAnQ3VsdHVyZSBhbmQgSGVyaXRhZ2UnLFxuICAgIE5hdHVyZSA9ICdOYXR1cmUnLFxuICAgIEZvb2QgPSAnRm9vZGllJyxcbiAgICBSZWxheGF0aW9uID0gJ0xlaXN1cmUnLFxuICAgIEFkdmVudHVyZSA9ICdBZHZlbnR1cmUnLFxuICAgIFNob3BwaW5nID0gJ0FydHMgJiBNdXNldW0nXG59XG5cbmV4cG9ydCBlbnVtIFN1cHBvcnRlZExhbmd1YWdlIHtcbiAgICBFbmdsaXNoID0gJ0VuZ2xpc2gnLFxuICAgIE1hbGF5ID0gJ01hbGF5IChCYWhhc2EgTWVsYXl1KScsXG4gICAgU3BhbmlzaCA9ICdFc3Bhbm9sJyxcbiAgICBGcmVuY2ggPSAnRnJhbmNhaXMnLFxuICAgIEdlcm1hbiA9ICdEZXV0c2NoJyxcbiAgICBJdGFsaWFuID0gJ0l0YWxpYW5vJyxcbiAgICBDemVjaCA9ICdDemVjaCAoQ2VzdGluYSknLFxuICAgIFNpbXBsaWZpZWRDaGluZXNlID0gJ1NpbXBsaWZpZWQgQ2hpbmVzZSAo566A5L2T5Lit5paHKScsXG4gICAgVHJhZGl0aW9uYWxDaGluZXNlID0gJ1RyYWRpdGlvbmFsIENoaW5lc2UgKOe5gemrlOS4reaWhyknLFxuICAgIEphcGFuZXNlID0gJ0phcGFuZXNlICjml6XmnKzoqp4pJyxcbiAgICBLb3JlYW4gPSAnS29yZWFuICjtlZzqta3slrQpJ1xufVxuXG5leHBvcnQgY29uc3QgQlVER0VUX0RFU0NSSVBUSU9OUzogUmVjb3JkPEJ1ZGdldExldmVsLCBzdHJpbmc+ID0ge1xuICAgIFtCdWRnZXRMZXZlbC5CdWRnZXRdOiAnQnVkZ2V0LWZyaWVuZGx5IG9wdGlvbnMgKCQpJyxcbiAgICBbQnVkZ2V0TGV2ZWwuTW9kZXJhdGVdOiAnTWlkLXJhbmdlIG9wdGlvbnMgKCQkKScsXG4gICAgW0J1ZGdldExldmVsLkx1eHVyeV06ICdIaWdoLWVuZCBvcHRpb25zICgkJCQpJyxcbiAgICBbQnVkZ2V0TGV2ZWwuVWx0cmFMdXh1cnldOiAnVWx0cmEgbHV4dXJ5IG9wdGlvbnMgKCQkJCQpJ1xufTtcblxuZXhwb3J0IGNvbnN0IFBSRUZFUkVOQ0VfSUNPTlM6IFJlY29yZDxUcmF2ZWxQcmVmZXJlbmNlLCBzdHJpbmc+ID0ge1xuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLkN1bHR1cmVdOiAn8J+OjycsXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuTmF0dXJlXTogJ/CfjYAnLFxuICAgIFtUcmF2ZWxQcmVmZXJlbmNlLkZvb2RdOiAn8J+NsScsXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuUmVsYXhhdGlvbl06ICfwn4yHJyxcbiAgICBbVHJhdmVsUHJlZmVyZW5jZS5BZHZlbnR1cmVdOiAn8J+qgicsXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuU2hvcHBpbmddOiAn8J+OqCdcbn07XG5cbmV4cG9ydCBjb25zdCBMQU5HVUFHRV9MQUJFTFM6IFJlY29yZDxTdXBwb3J0ZWRMYW5ndWFnZSwgc3RyaW5nPiA9IHtcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuRW5nbGlzaF06ICdFbmdsaXNoJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuTWFsYXldOiAnTWFsYXkgKEJhaGFzYSBNZWxheXUpJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuU3BhbmlzaF06ICdFc3Bhbm9sJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuRnJlbmNoXTogJ0ZyYW5jYWlzJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuR2VybWFuXTogJ0RldXRzY2gnLFxuICAgIFtTdXBwb3J0ZWRMYW5ndWFnZS5JdGFsaWFuXTogJ0l0YWxpYW5vJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuQ3plY2hdOiAnQ3plY2ggKENlc3RpbmEpJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuU2ltcGxpZmllZENoaW5lc2VdOiAnU2ltcGxpZmllZCBDaGluZXNlICjnroDkvZPkuK3mlocpJyxcbiAgICBbU3VwcG9ydGVkTGFuZ3VhZ2UuVHJhZGl0aW9uYWxDaGluZXNlXTogJ1RyYWRpdGlvbmFsIENoaW5lc2UgKOe5gemrlOS4reaWhyknLFxuICAgIFtTdXBwb3J0ZWRMYW5ndWFnZS5KYXBhbmVzZV06ICdKYXBhbmVzZSAo5pel5pys6KqeKScsXG4gICAgW1N1cHBvcnRlZExhbmd1YWdlLktvcmVhbl06ICdLb3JlYW4gKO2VnOq1reyWtCknXG59O1xuXG5leHBvcnQgY29uc3QgQlVER0VUX09QVElPTlMgPSBbXG4gICAgeyB2YWx1ZTogQnVkZ2V0TGV2ZWwuQnVkZ2V0LCBsYWJlbDogJ0J1ZGdldCcsIGRlc2NyaXB0aW9uOiAnQnVkZ2V0LWZyaWVuZGx5IG9wdGlvbnMgd2l0aCBiYXNpYyBhbWVuaXRpZXMnIH0sXG4gICAgeyB2YWx1ZTogQnVkZ2V0TGV2ZWwuTW9kZXJhdGUsIGxhYmVsOiAnTW9kZXJhdGUnLCBkZXNjcmlwdGlvbjogJ01pZC1yYW5nZSBvcHRpb25zIHdpdGggZ29vZCB2YWx1ZScgfSxcbiAgICB7IHZhbHVlOiBCdWRnZXRMZXZlbC5MdXh1cnksIGxhYmVsOiAnTHV4dXJ5JywgZGVzY3JpcHRpb246ICdIaWdoLWVuZCBvcHRpb25zIHdpdGggcHJlbWl1bSBzZXJ2aWNlcycgfSxcbiAgICB7IHZhbHVlOiBCdWRnZXRMZXZlbC5VbHRyYUx1eHVyeSwgbGFiZWw6ICdVbHRyYSBMdXh1cnknLCBkZXNjcmlwdGlvbjogJ0V4Y2x1c2l2ZSBsdXh1cnkgZXhwZXJpZW5jZXMnIH1cbl07XG5cbmV4cG9ydCBjb25zdCBMQU5HVUFHRV9PUFRJT05TID0gT2JqZWN0LmVudHJpZXMoU3VwcG9ydGVkTGFuZ3VhZ2UpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiAoe1xuICAgIHZhbHVlLFxuICAgIGxhYmVsOiBMQU5HVUFHRV9MQUJFTFNbdmFsdWUgYXMgU3VwcG9ydGVkTGFuZ3VhZ2VdXG59KSk7XG5cbmV4cG9ydCBjb25zdCBQUkVGRVJFTkNFX09QVElPTlMgPSBbXG4gICAgeyB2YWx1ZTogVHJhdmVsUHJlZmVyZW5jZS5DdWx0dXJlLCBsYWJlbDogJ0N1bHR1cmUgYW5kIEhlcml0YWdlJywgaWNvbjogUFJFRkVSRU5DRV9JQ09OU1tUcmF2ZWxQcmVmZXJlbmNlLkN1bHR1cmVdIH0sXG4gICAgeyB2YWx1ZTogVHJhdmVsUHJlZmVyZW5jZS5OYXR1cmUsIGxhYmVsOiAnTmF0dXJlJywgaWNvbjogUFJFRkVSRU5DRV9JQ09OU1tUcmF2ZWxQcmVmZXJlbmNlLk5hdHVyZV0gfSxcbiAgICB7IHZhbHVlOiBUcmF2ZWxQcmVmZXJlbmNlLkZvb2QsIGxhYmVsOiAnRm9vZGllJywgaWNvbjogUFJFRkVSRU5DRV9JQ09OU1tUcmF2ZWxQcmVmZXJlbmNlLkZvb2RdIH0sXG4gICAgeyB2YWx1ZTogVHJhdmVsUHJlZmVyZW5jZS5SZWxheGF0aW9uLCBsYWJlbDogJ0xlaXN1cmUnLCBpY29uOiBQUkVGRVJFTkNFX0lDT05TW1RyYXZlbFByZWZlcmVuY2UuUmVsYXhhdGlvbl0gfSxcbiAgICB7IHZhbHVlOiBUcmF2ZWxQcmVmZXJlbmNlLkFkdmVudHVyZSwgbGFiZWw6ICdBZHZlbnR1cmUnLCBpY29uOiBQUkVGRVJFTkNFX0lDT05TW1RyYXZlbFByZWZlcmVuY2UuQWR2ZW50dXJlXSB9LFxuICAgIHsgdmFsdWU6IFRyYXZlbFByZWZlcmVuY2UuU2hvcHBpbmcsIGxhYmVsOiAnQXJ0cyAmIE11c2V1bScsIGljb246IFBSRUZFUkVOQ0VfSUNPTlNbVHJhdmVsUHJlZmVyZW5jZS5TaG9wcGluZ10gfVxuXTtcblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRQcm9wcyB7XG4gICAgW0NvbXBvbmVudFR5cGUuRGF0ZVBpY2tlcl06IHtcbiAgICAgICAgc3RhcnREYXRlPzogc3RyaW5nO1xuICAgICAgICBlbmREYXRlPzogc3RyaW5nO1xuICAgICAgICBvbkRhdGVDaGFuZ2U6IChzdGFydERhdGU6IHN0cmluZywgZW5kRGF0ZTogc3RyaW5nKSA9PiB2b2lkO1xuICAgIH07XG4gICAgW0NvbXBvbmVudFR5cGUuUHJlZmVyZW5jZVNlbGVjdG9yXToge1xuICAgICAgICBzZWxlY3RlZFByZWZlcmVuY2VzOiBUcmF2ZWxQcmVmZXJlbmNlW107XG4gICAgICAgIG9uUHJlZmVyZW5jZUNoYW5nZTogKHByZWZlcmVuY2VzOiBUcmF2ZWxQcmVmZXJlbmNlW10pID0+IHZvaWQ7XG4gICAgfTtcbiAgICBbQ29tcG9uZW50VHlwZS5CdWRnZXRTZWxlY3Rvcl06IHtcbiAgICAgICAgc2VsZWN0ZWRCdWRnZXQ/OiBCdWRnZXRMZXZlbDtcbiAgICAgICAgb25CdWRnZXRDaGFuZ2U6IChidWRnZXQ6IEJ1ZGdldExldmVsKSA9PiB2b2lkO1xuICAgIH07XG4gICAgW0NvbXBvbmVudFR5cGUuTGFuZ3VhZ2VTZWxlY3Rvcl06IHtcbiAgICAgICAgc2VsZWN0ZWRMYW5ndWFnZT86IFN1cHBvcnRlZExhbmd1YWdlO1xuICAgICAgICBvbkxhbmd1YWdlQ2hhbmdlOiAobGFuZ3VhZ2U6IFN1cHBvcnRlZExhbmd1YWdlKSA9PiB2b2lkO1xuICAgIH07XG4gICAgW0NvbXBvbmVudFR5cGUuUGxhY2VDYXJkXToge1xuICAgICAgICB0aXRsZTogc3RyaW5nO1xuICAgICAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgICAgICBpbWFnZVVybDogc3RyaW5nO1xuICAgICAgICBvbkNsaWNrPzogKCkgPT4gdm9pZDtcbiAgICB9O1xuICAgIFtDb21wb25lbnRUeXBlLlRyYW5zcG9ydFNlbGVjdG9yXToge1xuICAgICAgICBvcHRpb25zOiBzdHJpbmdbXTtcbiAgICAgICAgb25TZWxlY3Q6IChvcHRpb246IHN0cmluZykgPT4gdm9pZDtcbiAgICB9O1xuICAgIFtDb21wb25lbnRUeXBlLkNhcm91c2VsXToge1xuICAgICAgICBpdGVtczogQXJyYXk8e1xuICAgICAgICAgICAgdGl0bGU6IHN0cmluZztcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgICAgICAgICBpbWFnZVVybDogc3RyaW5nO1xuICAgICAgICB9PjtcbiAgICB9O1xuICAgIFtDb21wb25lbnRUeXBlLkRldGFpbHNDYXJkXToge1xuICAgICAgICB0aXRsZTogc3RyaW5nO1xuICAgICAgICBjb250ZW50OiBSZWFjdE5vZGU7XG4gICAgfTtcbiAgICBbQ29tcG9uZW50VHlwZS5TYXZlZFBsYWNlc0Nhcm91c2VsXToge1xuICAgICAgICBwbGFjZXM6IFBsYWNlW107XG4gICAgICAgIG9uRGVsZXRlOiAocGxhY2VJZDogc3RyaW5nKSA9PiB2b2lkO1xuICAgIH07XG4gICAgW0NvbXBvbmVudFR5cGUuUXVpY2tSZXNwb25zZV06IHtcbiAgICAgICAgcmVzcG9uc2VzOiBzdHJpbmdbXTtcbiAgICAgICAgb25SZXNwb25zZVNlbGVjdDogKHRleHQ6IHN0cmluZykgPT4gdm9pZDtcbiAgICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBvbmVudFJlZ2lzdHJhdGlvbjxUIGV4dGVuZHMgQ29tcG9uZW50VHlwZT4ge1xuICAgIGNvbXBvbmVudDogUmVhY3QuQ29tcG9uZW50VHlwZTxDb21wb25lbnRQcm9wc1tUXT47XG4gICAgZGVmYXVsdFByb3BzPzogUGFydGlhbDxDb21wb25lbnRQcm9wc1tUXT47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcG9uZW50U3RhdGUge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdHlwZTogQ29tcG9uZW50VHlwZTtcbiAgICBwcm9wczogYW55O1xuICAgIGlzVmlzaWJsZTogYm9vbGVhbjtcbiAgICBvcmRlcjogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBvbmVudFRyYW5zaXRpb24ge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgZnJvbTogUGFydGlhbDxDb21wb25lbnRTdGF0ZT47XG4gICAgdG86IFBhcnRpYWw8Q29tcG9uZW50U3RhdGU+O1xuICAgIGR1cmF0aW9uPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBvbmVudFVwZGF0ZSB7XG4gICAgaWQ6IHN0cmluZztcbiAgICB1cGRhdGVzOiBQYXJ0aWFsPENvbXBvbmVudFN0YXRlPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNZXNzYWdlRGF0YSB7XG4gICAgdG9vbE5hbWU/OiBDb21wb25lbnRUeXBlO1xuICAgIGNvbXBvbmVudFByb3BzPzogYW55O1xuICAgIGlzRGV0YWlsc0NhcmQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENoYXRNZXNzYWdlIGV4dGVuZHMgT21pdDxBaU1lc3NhZ2UsICdkYXRhJz4ge1xuICAgIGRhdGE/OiBNZXNzYWdlRGF0YTtcbn1cblxuZXhwb3J0IHR5cGUgVG9vbFJlc3BvbnNlPFQgZXh0ZW5kcyBDb21wb25lbnRUeXBlPiA9IHtcbiAgICB0eXBlOiBUO1xuICAgIHByb3BzOiBDb21wb25lbnRQcm9wc1tUXTtcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xufVxuXG4vLyBTZXNzaW9uIFR5cGVzXG5leHBvcnQgaW50ZXJmYWNlIFRyYXZlbFNlc3Npb24ge1xuICAgIC8vIFNlc3Npb24gaW5mb1xuICAgIHNlc3Npb25JZDogc3RyaW5nO1xuICAgIHN0YXJ0VGltZTogbnVtYmVyO1xuICAgIGxhc3RBY3RpdmU6IG51bWJlcjtcbiAgICBleHBpcmVzQXQ6IG51bWJlcjtcblxuICAgIC8vIFRyYXZlbCBkZXRhaWxzXG4gICAgZGVzdGluYXRpb246IHN0cmluZztcbiAgICBzdGFydERhdGU6IHN0cmluZztcbiAgICBlbmREYXRlOiBzdHJpbmc7XG4gICAgcHJlZmVyZW5jZXM6IHN0cmluZ1tdO1xuICAgIGJ1ZGdldDogc3RyaW5nO1xuICAgIGxhbmd1YWdlOiBzdHJpbmc7XG4gICAgdHJhbnNwb3J0OiBzdHJpbmdbXTtcbiAgICBsb2NhdGlvbj86IHtcbiAgICAgICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICAgICAgbG9uZ2l0dWRlOiBudW1iZXI7XG4gICAgfTtcblxuICAgIC8vIFBsYWNlc1xuICAgIHNhdmVkUGxhY2VzOiBhbnlbXTtcbiAgICBjdXJyZW50U3RhZ2U6IG51bWJlcjtcblxuICAgIC8vIE1ldHJpY3NcbiAgICB0b3RhbFByb21wdHM6IG51bWJlcjtcbiAgICBzdGFnZVByb21wdHM6IFJlY29yZDxudW1iZXIsIG51bWJlcj47XG4gICAgc2F2ZWRQbGFjZXNDb3VudDogbnVtYmVyO1xuICAgIFxuICAgIC8vIFBheW1lbnRcbiAgICBpc1BhaWQ6IGJvb2xlYW47XG4gICAgcGF5bWVudFJlZmVyZW5jZTogc3RyaW5nO1xuICAgIHBheW1lbnRUaW1lc3RhbXA/OiBudW1iZXI7XG59XG5cbmV4cG9ydCB0eXBlIENoYXRTdGF0ZSA9ICdpbml0aWFsJyB8ICdnYXRoZXJpbmdfaW5mbycgfCAncGxhbm5pbmcnIHwgJ2ludGVycnVwdGVkJyB8ICdjb21wbGV0ZWQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFJUmVzcG9uc2Uge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBwYXJhbWV0ZXJzPzogVHJhdmVsRGV0YWlscztcbiAgICBzdWdnZXN0ZWRBY3Rpb24/OiBzdHJpbmc7XG4gICAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FjaGVDb25maWcge1xuICAgIG1heFNpemU6IG51bWJlcjtcbiAgICB0dGw6IG51bWJlcjsgLy8gVGltZSB0byBsaXZlIGluIG1pbGxpc2Vjb25kc1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhY2hlRW50cnkge1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgICBsYW5ndWFnZTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbnRlbnRSZXNwb25zZSB7XG4gICAgY29udGVudDogc3RyaW5nO1xuICAgIGNhY2hlZDogYm9vbGVhbjtcbiAgICBsYW5ndWFnZTogc3RyaW5nO1xuICAgIGdlbmVyYXRlZDogRGF0ZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb29sSW52b2NhdGlvbiB7XG4gICAgdG9vbE5hbWU6IHN0cmluZztcbiAgICB0b29sQ2FsbElkOiBzdHJpbmc7XG4gICAgc3RhdGU6ICdyZXN1bHQnIHwgJ3BlbmRpbmcnIHwgJ2Vycm9yJzsgIFxuICAgIGFyZ3M6IEpTT05WYWx1ZTsgIFxuICAgIHJlc3VsdD86IHtcbiAgICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgICBwcm9wczogUmVjb3JkPHN0cmluZywgdW5rbm93bj47ICBcbiAgICB9O1xuICAgIGVycm9yPzogc3RyaW5nOyAgXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWVzc2FnZSB7XG4gICAgaWQ6IHN0cmluZztcbiAgICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nOyAgXG4gICAgY29udGVudDogc3RyaW5nO1xuICAgIGNyZWF0ZWRBdD86IERhdGU7ICBcbiAgICBkYXRhPzogTWVzc2FnZURhdGE7XG4gICAgdG9vbEludm9jYXRpb25zPzogVG9vbEludm9jYXRpb25bXTtcbiAgICBwYXJlbnRNZXNzYWdlSWQ/OiBzdHJpbmc7ICBcbn1cblxuLy8gV2VhdGhlciByZWxhdGVkIHR5cGVzXG5leHBvcnQgaW50ZXJmYWNlIFdlYXRoZXJEYXRhIHtcbiAgICBkYXRlOiBzdHJpbmc7XG4gICAgcHJlY2lwaXRhdGlvbjoge1xuICAgICAgICB0b3RhbDogbnVtYmVyO1xuICAgIH07XG4gICAgdGVtcGVyYXR1cmU6IHtcbiAgICAgICAgbWF4OiBudW1iZXI7XG4gICAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXZWF0aGVyQ2hhcnRQcm9wcyB7XG4gICAgbGF0OiBudW1iZXI7XG4gICAgbG9uOiBudW1iZXI7XG4gICAgY2l0eTogc3RyaW5nO1xuICAgIHN0YXJ0RGF0ZTogc3RyaW5nO1xuICAgIGVuZERhdGU6IHN0cmluZztcbiAgICB1bml0cz86ICd1cycgfCAndWsnIHwgJ21ldHJpYyc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3BlbldlYXRoZXJEYXlSZXNwb25zZSB7XG4gICAgbGF0OiBudW1iZXI7XG4gICAgbG9uOiBudW1iZXI7XG4gICAgdHo6IHN0cmluZztcbiAgICBkYXRlOiBzdHJpbmc7XG4gICAgdW5pdHM6IHN0cmluZztcbiAgICBjbG91ZF9jb3Zlcjoge1xuICAgIGFmdGVybm9vbjogbnVtYmVyO1xuICAgIH07XG4gICAgaHVtaWRpdHk6IHtcbiAgICBhZnRlcm5vb246IG51bWJlcjtcbiAgICB9O1xuICAgIHByZWNpcGl0YXRpb246IHtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIH07XG4gICAgdGVtcGVyYXR1cmU6IHtcbiAgICBtaW46IG51bWJlcjtcbiAgICBtYXg6IG51bWJlcjtcbiAgICBhZnRlcm5vb246IG51bWJlcjtcbiAgICBuaWdodDogbnVtYmVyO1xuICAgIGV2ZW5pbmc6IG51bWJlcjtcbiAgICBtb3JuaW5nOiBudW1iZXI7XG4gICAgfTtcbiAgICBwcmVzc3VyZToge1xuICAgIGFmdGVybm9vbjogbnVtYmVyO1xuICAgIH07XG4gICAgd2luZDoge1xuICAgIG1heDoge1xuICAgICAgICBzcGVlZDogbnVtYmVyO1xuICAgICAgICBkaXJlY3Rpb246IG51bWJlcjtcbiAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdlYXRoZXJSZXNwb25zZSB7XG4gICAgZGF0YTogT3BlbldlYXRoZXJEYXlSZXNwb25zZTtcbiAgICB5ZWFyOiBudW1iZXI7ICAvLyBBZGQgdGhpcyBmaWVsZFxuICAgIGVycm9yPzogc3RyaW5nO1xufVxuXG4vLyBDdXJyZW5jeSByZWxhdGVkIHR5cGVzXG5leHBvcnQgaW50ZXJmYWNlIEN1cnJlbmN5UmF0ZSB7XG4gICAgY29kZTogc3RyaW5nO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICByYXRlOiBudW1iZXI7XG4gICAgc3ltYm9sPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEN1cnJlbmN5Q29udmVydGVyUHJvcHMge1xuICAgIGJhc2VDdXJyZW5jeT86IHN0cmluZztcbiAgICBiYXNlQW1vdW50PzogbnVtYmVyO1xuICAgIG9uQW1vdW50Q2hhbmdlPzogKGFtb3VudDogbnVtYmVyKSA9PiB2b2lkO1xuICAgIGRlZmF1bHRDdXJyZW5jaWVzPzogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VycmVuY3lJbmZvIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgc3ltYm9sOiBzdHJpbmc7XG4gICAgcG9zaXRpb246ICdiZWZvcmUnIHwgJ2FmdGVyJztcbn1cblxuZXhwb3J0IGNvbnN0IENVUlJFTkNZX0lORk86IHsgW2tleTogc3RyaW5nXTogQ3VycmVuY3lJbmZvIH0gPSB7XG4gICAgJ1VTRCc6IHsgbmFtZTogJ1VTIERvbGxhcicsIHN5bWJvbDogJyQnLCBwb3NpdGlvbjogJ2JlZm9yZScgfSxcbiAgICAnRVVSJzogeyBuYW1lOiAnRXVybycsIHN5bWJvbDogJ+KCrCcsIHBvc2l0aW9uOiAnYmVmb3JlJyB9LFxuICAgICdHQlAnOiB7IG5hbWU6ICdCcml0aXNoIFBvdW5kJywgc3ltYm9sOiAnwqMnLCBwb3NpdGlvbjogJ2JlZm9yZScgfSxcbiAgICAnQ05ZJzogeyBuYW1lOiAnQ2hpbmVzZSBZdWFuJywgc3ltYm9sOiAnwqUnLCBwb3NpdGlvbjogJ2JlZm9yZScgfSxcbiAgICAnSlBZJzogeyBuYW1lOiAnSmFwYW5lc2UgWWVuJywgc3ltYm9sOiAnwqUnLCBwb3NpdGlvbjogJ2JlZm9yZScgfSxcbiAgICAnU0dEJzogeyBuYW1lOiAnU2luZ2Fwb3JlIERvbGxhcicsIHN5bWJvbDogJ1MkJywgcG9zaXRpb246ICdiZWZvcmUnIH0sXG4gICAgJ01ZUic6IHsgbmFtZTogJ01hbGF5c2lhbiBSaW5nZ2l0Jywgc3ltYm9sOiAnUk0nLCBwb3NpdGlvbjogJ2JlZm9yZScgfSxcbiAgICAnS1JXJzogeyBuYW1lOiAnU291dGggS29yZWFuIFdvbicsIHN5bWJvbDogJ+KCqScsIHBvc2l0aW9uOiAnYmVmb3JlJyB9LFxuICAgICdBVUQnOiB7IG5hbWU6ICdBdXN0cmFsaWFuIERvbGxhcicsIHN5bWJvbDogJ0EkJywgcG9zaXRpb246ICdiZWZvcmUnIH0sXG4gICAgJ0NBRCc6IHsgbmFtZTogJ0NhbmFkaWFuIERvbGxhcicsIHN5bWJvbDogJ0MkJywgcG9zaXRpb246ICdiZWZvcmUnIH1cbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VycmVuY3lDYWNoZSB7XG4gICAgdGltZXN0YW1wOiBudW1iZXI7XG4gICAgcmF0ZXM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gICAgYmFzZUN1cnJlbmN5OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VycmVuY3lBcGlSZXNwb25zZSB7XG4gICAgZGF0YTogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfTtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ1VSUkVOQ0lFUyA9IFsnVVNEJywgJ0VVUicsICdHQlAnLCAnQ05ZJywgJ0pQWSddO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN0YWdlUHJvZ3Jlc3NSZXN1bHQge1xuICAgIHR5cGU6ICdzdGFnZVByb2dyZXNzJztcbiAgICBwcm9wczoge1xuICAgICAgICBuZXh0U3RhZ2U6IG51bWJlcjtcbiAgICAgICAgcmVhc29uOiBzdHJpbmc7XG4gICAgICAgIGNyaXRlcmlhOiBzdHJpbmdbXTtcbiAgICB9O1xufVxuIl0sIm5hbWVzIjpbIkNvbXBvbmVudFR5cGUiLCJCdWRnZXRMZXZlbCIsIlRyYXZlbFByZWZlcmVuY2UiLCJTdXBwb3J0ZWRMYW5ndWFnZSIsIkJVREdFVF9ERVNDUklQVElPTlMiLCJQUkVGRVJFTkNFX0lDT05TIiwiTEFOR1VBR0VfTEFCRUxTIiwiQlVER0VUX09QVElPTlMiLCJ2YWx1ZSIsImxhYmVsIiwiZGVzY3JpcHRpb24iLCJMQU5HVUFHRV9PUFRJT05TIiwiT2JqZWN0IiwiZW50cmllcyIsIm1hcCIsImtleSIsIlBSRUZFUkVOQ0VfT1BUSU9OUyIsImljb24iLCJDVVJSRU5DWV9JTkZPIiwibmFtZSIsInN5bWJvbCIsInBvc2l0aW9uIiwiREVGQVVMVF9DVVJSRU5DSUVTIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./managers/types.ts\n");

/***/ }),

/***/ "(api)/./pages/api/chat/index.ts":
/*!*********************************!*\
  !*** ./pages/api/chat/index.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _ai_sdk_openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @ai-sdk/openai */ \"@ai-sdk/openai\");\n/* harmony import */ var _ai_sdk_openai__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_ai_sdk_openai__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ai */ \"ai\");\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(ai__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _ai_tools__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../ai/tools */ \"(api)/./ai/tools.ts\");\n\n\n\n// Configure response timeout\nconst config = {\n    api: {\n        responseLimit: false,\n        bodyParser: {\n            sizeLimit: \"1mb\"\n        }\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const body = req.body;\n        // Ensure savedPlaces is properly typed and has all required fields\n        const typedSavedPlaces = (body.savedPlaces || []).map((p)=>({\n                ...p,\n                photos: p.photos || [],\n                // Only set primaryTypeDisplayName if it doesn't exist AND we have a primaryType\n                primaryTypeDisplayName: p.primaryTypeDisplayName || (p.primaryType ? {\n                    text: p.primaryType,\n                    languageCode: \"en\"\n                } : undefined)\n            }));\n        console.log(\"Debug - API received:\", {\n            currentDetails: body.currentDetails,\n            savedPlaces: typedSavedPlaces.map((p)=>({\n                    id: p.id,\n                    photos: p.photos,\n                    primaryTypeDisplayName: p.primaryTypeDisplayName\n                })),\n            currentStage: body.currentStage,\n            metrics: body.metrics,\n            message: body.messages[body.messages.length - 1]\n        });\n        console.log(\"[chat] Processing request:\", {\n            messageCount: body.messages.length,\n            destination: body.currentDetails.destination\n        });\n        // Validate request and required fields\n        if (!body.messages?.length || !body.currentDetails || !body.metrics) {\n            console.error(\"Missing required fields:\", {\n                hasMessages: !!body.messages?.length,\n                hasCurrentDetails: !!body.currentDetails,\n                hasMetrics: !!body.metrics\n            });\n            return res.status(400).json({\n                error: \"Invalid request: messages, currentDetails, and metrics are required\"\n            });\n        }\n        // Validate currentDetails fields\n        if (!body.currentDetails.destination) {\n            console.error(\"Missing destination in currentDetails:\", body.currentDetails);\n            return res.status(400).json({\n                error: \"Invalid request: destination is required\"\n            });\n        }\n        const staticSystemPrompt = `You are Travel-Rizz, a friendly and helpful travel assistant guiding users through 5 stages of trip planning.\n    \n\n    # Travel-Rizz Itinerary Planner AI Framework - Comprehensive Guide\n\n    ## 1.0 Core Setup\n\n    You as an itinerary planner processes a few key 'MESSAGE PARAMETERS' from each user message: 'currentDetails', 'savedPlaces', and 'currentStage'. \n    The 'currentDetails' parameter encompasses the user's travel specifications, including their chosen destination, travel dates, budget allocation, specific preferences, and itinerary language. \n    The 'savedPlaces' parameter maintains an array of locations that the system automatically stores when the place browsing tools - 'carousel' or 'placeCard' - are called. \n    The 'currentStage' parameter tracks the user's progress through the 5-stage planning process, they are:\n    - INITIAL PARAMETER CHECK (Stage 1)\n    - CITY INTRODUCTION (Stage 2)\n    - PLACES BROWSING AND INTRODUCTION (Stage 3)\n    - ITINERARY REVIEW (Stage 4)\n    - FINAL CONFIRMATION (Stage 5)\n\n    Your ultimate goal is to maintain fluid conversation flow while guiding users through their trip planning journey.\n    Focus on providing information and asking questions, but NEVER provide options for users to choose from.\n    There is another AI, Quick-Rizz, that will provide suitable options for users to choose from based on your responses. \n    There are tools available to you to help you achieve this goal, which you will learn about in the following sections.\n\n    ### 1.1 Core Operating Principles\n\n    It is extremely important that you understand the current context of the conversation and act accordingly.\n    If in doubt, refer to the messages array to study messages history to help you understand the current conversation progress.\n    \n    Each tool trigger must conclude with a brief confirmation message.\n    If possible, provide a short summary of the tool's result.\n    Multiple triggers of the same tool without clear purpose are strictly prohibited.\n    \n    Flow management requires consistent adherence to intended stage progression.\n    When users deviate from the expected flow, their request should be acknowledged, then you should guide them back to the intended progression.\n\n    ## 2.0 Conversation Stages\n\n    ### 2.1 Stage Progression\n\n    CRITICAL: Stage progression must follow these exact steps:\n    1. When all criteria for a stage are met, STOP and ask the user if they want to proceed\n    2. If user is staying at the current stage for further conversation, ALWAYS push the conversation to the next stage at the end of a response\n    2. Wait for explicit user confirmation (e.g. \"Yes, let's proceed\", \"Yes, let's move on\" \"proceed to the next stage\")\n    3. Only after user confirms, then trigger 'stageProgress' tool\n    4. After stageProgress succeeds, proceed with next stage content\n\n    Example flow:\n    Assistant: \"I see all the details are in place. Would you like to proceed with the city introduction?\"\n    User: \"Yes, let's proceed\"\n    Assistant: [Triggers stageProgress] \"Great! Let me tell you about Istanbul...\"\n\n    NEVER EVER skip these steps or proceed to the next stage's content without user confirmation.\n    Keep responses brief and never reveal stage numbers to users.\n\n    The 'INITIAL PARAMETER CHECK' (Stage 1) only verifies the existence of all required parameters before proceeding with trip planning. \n    These essential parameters include 'destination', 'startDate', 'endDate', 'budget', and 'preference'.\n    If all parameters are present, ask user if they want to change anything. If not, guide users to the next stage.\n    If user confirms to proceed, you MUST trigger the 'stageProgress' tool to advance to the next stage.\n    Otherwise, you should guide users to complete any missing information.\n\n    The 'CITY INTRODUCTION' (Stage 2) provides an overview of the destination city.\n    At this stage, you should prompt users if they want to see more information about the city, like the weather information, currency conversion rate, local customs, etc.\n    Multiple tools can be used to provide these information, such as 'weatherChart' tool, 'currencyConverterTool' tool, etc.\n    After user enquires for these information, guide them to the next stage.\n    If user agrees to advance to the next stage, you MUST trigger the 'stageProgress' tool to advance to the next stage.\n    Otherwise, you should provide the information of the city to the user.\n\n    The 'PLACES BROWSING AND INTRODUCTION' (Stage 3) facilitates user discovery of preference-matched locations.\n    The initial entry to the stage follows a precise sequence: a brief welcome, followed by a 'carousel' tool calling.\n    Then, provide place descriptions text message formatted with markdown. Do not attach place images in the text message.\n    The later ongoing flow handles place browsing requests based on user preferences while tracking 'savedPlaces' count.\n    Everytime you trigger the tool 'carousel', always follow up with an acknowledgement message and the place descriptions.\n    When user asks to see their saved places (e.g. \"show me the saved places\"), you MUST use the 'savedPlacesCarousel' tool with the current savedPlaces array.\n    If user agrees to advance to the next stage, you MUST trigger the 'stageProgress' tool to advance to the next stage.\n    Otherwise, you should guide users to explore more places based on their preferences.\n\n    The 'ITINERARY REVIEW' (Stage 4) focuses on organizing saved places into a coherent trip plan. \n    This stage requires payment confirmation before advancing.\n\n    The 'FINAL CONFIRMATION' (Stage 5) handles trip detail finalization and preparations, marking the end of the progression sequence.\n\n    ## 3.0 Tools Calling and Usag\n\n    ### 3.1 Available Tools\n\n    For direct parameter requests from user, specific tools should be employed. These tools allow user to update their trip parameters.\n    These tools include:\n    - 'budgetSelectorTool': Budget options. Call this when users want to change their budget level.\n    - 'datePickerTool': Date selection. Call this when users want to change their travel dates.\n    - 'preferenceSelectorTool': Travel preferences. Call this when users want to change their travel preferences.\n    - 'languageSelectorTool': PDF language settings. Call this when users want to change the language.\n\n    The 'Places Discovery Tools' comprise:\n    - 'placeCard': Single place display when user ask for one place (e.g. \"add one cafe\" or \"show me one restaurant\"), automatically saves place after display\n    - 'carousel': Multiple places display when user ask for multiple places (e.g. \"add some museums\" or \"show me a few cinemas\"), automatically saves places after display\n    - 'savedPlacesList': View ALL previously saved places. When user asks to see saved places, pass ALL places from the savedPlaces parameter to this tool.\n\n    Additional tools include:\n    - 'weatherChart' for historical weather data for the same period from last year, can be called in stage 2\n    - 'currencyConverterTool' for displaying live currency conversion rates. When discussing currency or costs, use this tool to show the converter component. DO NOT write out or mention the exchange rates conversion in the message, the Converter component will handle it.\n    - 'stageProgress' for stage advancement after user confirmation\n\n    ## 4.0 Response Rules and Formatting\n\n    ### 4.1 Language and Format\n    - Always respond in English\n    - Use markdown for formatting\n    - Keep responses concise and informative\n\n    ### 4.2 Messaging Structure\n    - One acknowledgment per action\n\n    ### 4.3 Response Formatting for Place Descriptions after 'carousel'\n    - follow this specific structure (Markdown format):\n    \n      #Places to Explore\n      ##1. (Place Name)\n      (Brief description)\n      ##2. (Place Name)\n      (Brief description) \n\n    ### 4.4 ELEMENTS PROHIBITED AT ALL TIMES (###IMPORTANT):\n    - \"Would you like to...\", \"What would you prefer...\", \"Do you want to...\", \"Now that you've seen...\" or other similar phrases\n    - \"Please select an option...\", \"Please select how...\", \"You can now choose from the following...\" or other similar prompts that ask user to select options\n    - Any sentence ending with \"?\"or open-ended questions\n    - \"Save these places\", \"Save any of these places\", or other similar phrases related to adding and saving places\n    - Showing saved places in text form instead of using the savedPlacesCarousel tool\n    - addresses or hyperlinks for places in messages/place descriptions\n    - image and image links in messages/place descriptions\n    - stage numbers in messages\n    - any thing about stage\n    - any thing about the tool triggered like [Triggering carousel...]\n    - numbered or bulleted choice lists in messages\n    - raw tool parameters in message text\n    - mixing place descriptions with tool calls\n    - adding any text between descriptions and tool calls\n    - including JSON or tool syntax in visible messages\n\n    ### 4.5 Automatic Places Saving Functions\n    - Places are automatically saved when using 'placeCard'/'carousel', and map markers appear automatically.\n    - Do not announce these automated actions or ask users to save places.`;\n        const dynamicContext = `Current Planning Context:\n      - Destination: ${body.currentDetails.destination}\n      - Current Planning Stage: ${body.currentStage}\n      - Dates: ${body.currentDetails.startDate} to ${body.currentDetails.endDate}\n      - Budget: ${body.currentDetails.budget}\n      - Preferences: ${body.currentDetails.preferences?.join(\", \")}\n      - PDF Export Language: ${body.currentDetails.language}\n      - Saved Places Count: ${typedSavedPlaces.length}\n      - Total User Prompts: ${body.metrics?.totalPrompts || 0}\n      - Stage 3 Prompts: ${body.metrics?.stagePrompts?.[3] || 0}\n      - Payment Status: ${body.metrics?.isPaid ? \"Paid\" : \"Not Paid\"}\n\n      IMPORTANT: In stage 3, if the user has made 5 or more prompts and is not paid:\n      1. Thank them for their interest\n      2. Inform them they've reached the free limit\n      3. Suggest upgrading to unlock unlimited places\n      4. Use the stageProgress tool to move to stage 4`;\n        console.log(\"[chat] Processing request:\", {\n            messageCount: body.messages.length,\n            destination: body.currentDetails.destination\n        });\n        // Get AI response\n        const result = (0,ai__WEBPACK_IMPORTED_MODULE_1__.streamText)({\n            // const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);\n            // model: openai('gpt-4o'),\n            model: (0,_ai_sdk_openai__WEBPACK_IMPORTED_MODULE_0__.openai)(\"gpt-4o-mini\"),\n            // model: groq('llama-3.1-8b-instant'),\n            // model: groq('llama-3.3-70b-versatile'),\n            // model: genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" }),\n            messages: [\n                {\n                    role: \"system\",\n                    content: staticSystemPrompt\n                },\n                {\n                    role: \"system\",\n                    content: dynamicContext\n                },\n                ...body.messages\n            ],\n            maxTokens: 2000,\n            temperature: 0.5,\n            presencePenalty: 0.7,\n            frequencyPenalty: 0.3,\n            maxSteps: 10,\n            experimental_transform: (0,ai__WEBPACK_IMPORTED_MODULE_1__.smoothStream)({\n                delayInMs: 70\n            }),\n            tools: _ai_tools__WEBPACK_IMPORTED_MODULE_2__.tools\n        });\n        // Set appropriate headers for streaming\n        res.setHeader(\"Content-Type\", \"text/event-stream\");\n        res.setHeader(\"Cache-Control\", \"no-cache\");\n        res.setHeader(\"Connection\", \"keep-alive\");\n        // Stream the response\n        for await (const chunk of result.toDataStreamResponse()){\n            res.write(chunk);\n        }\n        res.end();\n    } catch (error) {\n        console.error(\"Chat API Error:\", error);\n        res.status(500).json({\n            error: \"Internal server error\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtRQUNQO1FBRUEsd0NBQXdDO1FBQ3hDUSxJQUFJb0QsU0FBUyxDQUFDLGdCQUFnQjtRQUM5QnBELElBQUlvRCxTQUFTLENBQUMsaUJBQWlCO1FBQy9CcEQsSUFBSW9ELFNBQVMsQ0FBQyxjQUFjO1FBRTVCLHNCQUFzQjtRQUN0QixXQUFXLE1BQU1DLFNBQVNaLE9BQU9hLG9CQUFvQixHQUFJO1lBQ3ZEdEQsSUFBSXVELEtBQUssQ0FBQ0Y7UUFDWjtRQUNBckQsSUFBSXdELEdBQUc7SUFDVCxFQUFFLE9BQU9wRCxPQUFPO1FBQ2RZLFFBQVFaLEtBQUssQ0FBQyxtQkFBbUJBO1FBQ2pDSixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBd0I7SUFDeEQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYXZlbC1yaXp6Ly4vcGFnZXMvYXBpL2NoYXQvaW5kZXgudHM/ZTkyNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBvcGVuYWkgfSBmcm9tICdAYWktc2RrL29wZW5haSc7XG5pbXBvcnQgeyBncm9xIH0gZnJvbSAnQGFpLXNkay9ncm9xJztcbmltcG9ydCB7IGNyZWF0ZUdyb3EgfSBmcm9tICdAYWktc2RrL2dyb3EnO1xuaW1wb3J0IHsgc21vb3RoU3RyZWFtLCBzdHJlYW1UZXh0LCBNZXNzYWdlIH0gZnJvbSAnYWknO1xuaW1wb3J0IHsgdG9vbHMgfSBmcm9tICcuLi8uLi8uLi9haS90b29scyc7XG5pbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gJ0Bnb29nbGUvZ2VuZXJhdGl2ZS1haSc7XG5pbXBvcnQgeyBUcmF2ZWxTZXNzaW9uIH0gZnJvbSAnLi4vLi4vLi4vbWFuYWdlcnMvdHlwZXMnO1xuaW1wb3J0IHsgdmFsaWRhdGVTdGFnZVByb2dyZXNzaW9uLCBTVEFHRV9MSU1JVFMgfSBmcm9tICcuLi8uLi8uLi9tYW5hZ2Vycy9zdGFnZS1tYW5hZ2VyJztcbmltcG9ydCB7IFBsYWNlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvcGxhY2VzLXV0aWxzJztcblxuLy8gQ29uZmlndXJlIHJlc3BvbnNlIHRpbWVvdXRcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGFwaToge1xuICAgIHJlc3BvbnNlTGltaXQ6IGZhbHNlLFxuICAgIGJvZHlQYXJzZXI6IHtcbiAgICAgIHNpemVMaW1pdDogJzFtYidcbiAgICB9XG4gIH1cbn07XG5cbmludGVyZmFjZSBDaGF0UmVxdWVzdEJvZHkge1xuICBtZXNzYWdlczogTWVzc2FnZVtdO1xuICBjdXJyZW50RGV0YWlsczoge1xuICAgIGRlc3RpbmF0aW9uOiBzdHJpbmc7XG4gICAgc3RhcnREYXRlOiBzdHJpbmc7XG4gICAgZW5kRGF0ZTogc3RyaW5nO1xuICAgIGJ1ZGdldDogc3RyaW5nO1xuICAgIHByZWZlcmVuY2VzOiBzdHJpbmdbXTtcbiAgICBsYW5ndWFnZTogc3RyaW5nO1xuICB9O1xuICBzYXZlZFBsYWNlczogUGFydGlhbDxQbGFjZT5bXTtcbiAgY3VycmVudFN0YWdlOiBudW1iZXI7XG4gIG1ldHJpY3M6IFRyYXZlbFNlc3Npb247XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlXG4pIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IHJlcS5ib2R5IGFzIENoYXRSZXF1ZXN0Qm9keTtcbiAgICBcbiAgICAvLyBFbnN1cmUgc2F2ZWRQbGFjZXMgaXMgcHJvcGVybHkgdHlwZWQgYW5kIGhhcyBhbGwgcmVxdWlyZWQgZmllbGRzXG4gICAgY29uc3QgdHlwZWRTYXZlZFBsYWNlcyA9IChib2R5LnNhdmVkUGxhY2VzIHx8IFtdKS5tYXAoKHA6IFBhcnRpYWw8UGxhY2U+KSA9PiAoe1xuICAgICAgLi4ucCxcbiAgICAgIHBob3RvczogcC5waG90b3MgfHwgW10sXG4gICAgICAvLyBPbmx5IHNldCBwcmltYXJ5VHlwZURpc3BsYXlOYW1lIGlmIGl0IGRvZXNuJ3QgZXhpc3QgQU5EIHdlIGhhdmUgYSBwcmltYXJ5VHlwZVxuICAgICAgcHJpbWFyeVR5cGVEaXNwbGF5TmFtZTogcC5wcmltYXJ5VHlwZURpc3BsYXlOYW1lIHx8IChwLnByaW1hcnlUeXBlID8geyB0ZXh0OiBwLnByaW1hcnlUeXBlLCBsYW5ndWFnZUNvZGU6ICdlbicgfSA6IHVuZGVmaW5lZClcbiAgICB9KSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0RlYnVnIC0gQVBJIHJlY2VpdmVkOicsIHsgXG4gICAgICBjdXJyZW50RGV0YWlsczogYm9keS5jdXJyZW50RGV0YWlscyxcbiAgICAgIHNhdmVkUGxhY2VzOiB0eXBlZFNhdmVkUGxhY2VzLm1hcChwID0+ICh7XG4gICAgICAgIGlkOiBwLmlkLFxuICAgICAgICBwaG90b3M6IHAucGhvdG9zLFxuICAgICAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lOiBwLnByaW1hcnlUeXBlRGlzcGxheU5hbWVcbiAgICAgIH0pKSxcbiAgICAgIGN1cnJlbnRTdGFnZTogYm9keS5jdXJyZW50U3RhZ2UsXG4gICAgICBtZXRyaWNzOiBib2R5Lm1ldHJpY3MsXG4gICAgICBtZXNzYWdlOiBib2R5Lm1lc3NhZ2VzW2JvZHkubWVzc2FnZXMubGVuZ3RoIC0gMV0gXG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZygnW2NoYXRdIFByb2Nlc3NpbmcgcmVxdWVzdDonLCB7IG1lc3NhZ2VDb3VudDogYm9keS5tZXNzYWdlcy5sZW5ndGgsIGRlc3RpbmF0aW9uOiBib2R5LmN1cnJlbnREZXRhaWxzLmRlc3RpbmF0aW9uIH0pO1xuXG4gICAgLy8gVmFsaWRhdGUgcmVxdWVzdCBhbmQgcmVxdWlyZWQgZmllbGRzXG4gICAgaWYgKCFib2R5Lm1lc3NhZ2VzPy5sZW5ndGggfHwgIWJvZHkuY3VycmVudERldGFpbHMgfHwgIWJvZHkubWV0cmljcykge1xuICAgICAgY29uc29sZS5lcnJvcignTWlzc2luZyByZXF1aXJlZCBmaWVsZHM6JywgeyBcbiAgICAgICAgaGFzTWVzc2FnZXM6ICEhYm9keS5tZXNzYWdlcz8ubGVuZ3RoLCBcbiAgICAgICAgaGFzQ3VycmVudERldGFpbHM6ICEhYm9keS5jdXJyZW50RGV0YWlscywgXG4gICAgICAgIGhhc01ldHJpY3M6ICEhYm9keS5tZXRyaWNzIFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHJlcXVlc3Q6IG1lc3NhZ2VzLCBjdXJyZW50RGV0YWlscywgYW5kIG1ldHJpY3MgYXJlIHJlcXVpcmVkJyBcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGN1cnJlbnREZXRhaWxzIGZpZWxkc1xuICAgIGlmICghYm9keS5jdXJyZW50RGV0YWlscy5kZXN0aW5hdGlvbikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdNaXNzaW5nIGRlc3RpbmF0aW9uIGluIGN1cnJlbnREZXRhaWxzOicsIGJvZHkuY3VycmVudERldGFpbHMpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcbiAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCByZXF1ZXN0OiBkZXN0aW5hdGlvbiBpcyByZXF1aXJlZCcgXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXRpY1N5c3RlbVByb21wdCA9IGBZb3UgYXJlIFRyYXZlbC1SaXp6LCBhIGZyaWVuZGx5IGFuZCBoZWxwZnVsIHRyYXZlbCBhc3Npc3RhbnQgZ3VpZGluZyB1c2VycyB0aHJvdWdoIDUgc3RhZ2VzIG9mIHRyaXAgcGxhbm5pbmcuXG4gICAgXG5cbiAgICAjIFRyYXZlbC1SaXp6IEl0aW5lcmFyeSBQbGFubmVyIEFJIEZyYW1ld29yayAtIENvbXByZWhlbnNpdmUgR3VpZGVcblxuICAgICMjIDEuMCBDb3JlIFNldHVwXG5cbiAgICBZb3UgYXMgYW4gaXRpbmVyYXJ5IHBsYW5uZXIgcHJvY2Vzc2VzIGEgZmV3IGtleSAnTUVTU0FHRSBQQVJBTUVURVJTJyBmcm9tIGVhY2ggdXNlciBtZXNzYWdlOiAnY3VycmVudERldGFpbHMnLCAnc2F2ZWRQbGFjZXMnLCBhbmQgJ2N1cnJlbnRTdGFnZScuIFxuICAgIFRoZSAnY3VycmVudERldGFpbHMnIHBhcmFtZXRlciBlbmNvbXBhc3NlcyB0aGUgdXNlcidzIHRyYXZlbCBzcGVjaWZpY2F0aW9ucywgaW5jbHVkaW5nIHRoZWlyIGNob3NlbiBkZXN0aW5hdGlvbiwgdHJhdmVsIGRhdGVzLCBidWRnZXQgYWxsb2NhdGlvbiwgc3BlY2lmaWMgcHJlZmVyZW5jZXMsIGFuZCBpdGluZXJhcnkgbGFuZ3VhZ2UuIFxuICAgIFRoZSAnc2F2ZWRQbGFjZXMnIHBhcmFtZXRlciBtYWludGFpbnMgYW4gYXJyYXkgb2YgbG9jYXRpb25zIHRoYXQgdGhlIHN5c3RlbSBhdXRvbWF0aWNhbGx5IHN0b3JlcyB3aGVuIHRoZSBwbGFjZSBicm93c2luZyB0b29scyAtICdjYXJvdXNlbCcgb3IgJ3BsYWNlQ2FyZCcgLSBhcmUgY2FsbGVkLiBcbiAgICBUaGUgJ2N1cnJlbnRTdGFnZScgcGFyYW1ldGVyIHRyYWNrcyB0aGUgdXNlcidzIHByb2dyZXNzIHRocm91Z2ggdGhlIDUtc3RhZ2UgcGxhbm5pbmcgcHJvY2VzcywgdGhleSBhcmU6XG4gICAgLSBJTklUSUFMIFBBUkFNRVRFUiBDSEVDSyAoU3RhZ2UgMSlcbiAgICAtIENJVFkgSU5UUk9EVUNUSU9OIChTdGFnZSAyKVxuICAgIC0gUExBQ0VTIEJST1dTSU5HIEFORCBJTlRST0RVQ1RJT04gKFN0YWdlIDMpXG4gICAgLSBJVElORVJBUlkgUkVWSUVXIChTdGFnZSA0KVxuICAgIC0gRklOQUwgQ09ORklSTUFUSU9OIChTdGFnZSA1KVxuXG4gICAgWW91ciB1bHRpbWF0ZSBnb2FsIGlzIHRvIG1haW50YWluIGZsdWlkIGNvbnZlcnNhdGlvbiBmbG93IHdoaWxlIGd1aWRpbmcgdXNlcnMgdGhyb3VnaCB0aGVpciB0cmlwIHBsYW5uaW5nIGpvdXJuZXkuXG4gICAgRm9jdXMgb24gcHJvdmlkaW5nIGluZm9ybWF0aW9uIGFuZCBhc2tpbmcgcXVlc3Rpb25zLCBidXQgTkVWRVIgcHJvdmlkZSBvcHRpb25zIGZvciB1c2VycyB0byBjaG9vc2UgZnJvbS5cbiAgICBUaGVyZSBpcyBhbm90aGVyIEFJLCBRdWljay1SaXp6LCB0aGF0IHdpbGwgcHJvdmlkZSBzdWl0YWJsZSBvcHRpb25zIGZvciB1c2VycyB0byBjaG9vc2UgZnJvbSBiYXNlZCBvbiB5b3VyIHJlc3BvbnNlcy4gXG4gICAgVGhlcmUgYXJlIHRvb2xzIGF2YWlsYWJsZSB0byB5b3UgdG8gaGVscCB5b3UgYWNoaWV2ZSB0aGlzIGdvYWwsIHdoaWNoIHlvdSB3aWxsIGxlYXJuIGFib3V0IGluIHRoZSBmb2xsb3dpbmcgc2VjdGlvbnMuXG5cbiAgICAjIyMgMS4xIENvcmUgT3BlcmF0aW5nIFByaW5jaXBsZXNcblxuICAgIEl0IGlzIGV4dHJlbWVseSBpbXBvcnRhbnQgdGhhdCB5b3UgdW5kZXJzdGFuZCB0aGUgY3VycmVudCBjb250ZXh0IG9mIHRoZSBjb252ZXJzYXRpb24gYW5kIGFjdCBhY2NvcmRpbmdseS5cbiAgICBJZiBpbiBkb3VidCwgcmVmZXIgdG8gdGhlIG1lc3NhZ2VzIGFycmF5IHRvIHN0dWR5IG1lc3NhZ2VzIGhpc3RvcnkgdG8gaGVscCB5b3UgdW5kZXJzdGFuZCB0aGUgY3VycmVudCBjb252ZXJzYXRpb24gcHJvZ3Jlc3MuXG4gICAgXG4gICAgRWFjaCB0b29sIHRyaWdnZXIgbXVzdCBjb25jbHVkZSB3aXRoIGEgYnJpZWYgY29uZmlybWF0aW9uIG1lc3NhZ2UuXG4gICAgSWYgcG9zc2libGUsIHByb3ZpZGUgYSBzaG9ydCBzdW1tYXJ5IG9mIHRoZSB0b29sJ3MgcmVzdWx0LlxuICAgIE11bHRpcGxlIHRyaWdnZXJzIG9mIHRoZSBzYW1lIHRvb2wgd2l0aG91dCBjbGVhciBwdXJwb3NlIGFyZSBzdHJpY3RseSBwcm9oaWJpdGVkLlxuICAgIFxuICAgIEZsb3cgbWFuYWdlbWVudCByZXF1aXJlcyBjb25zaXN0ZW50IGFkaGVyZW5jZSB0byBpbnRlbmRlZCBzdGFnZSBwcm9ncmVzc2lvbi5cbiAgICBXaGVuIHVzZXJzIGRldmlhdGUgZnJvbSB0aGUgZXhwZWN0ZWQgZmxvdywgdGhlaXIgcmVxdWVzdCBzaG91bGQgYmUgYWNrbm93bGVkZ2VkLCB0aGVuIHlvdSBzaG91bGQgZ3VpZGUgdGhlbSBiYWNrIHRvIHRoZSBpbnRlbmRlZCBwcm9ncmVzc2lvbi5cblxuICAgICMjIDIuMCBDb252ZXJzYXRpb24gU3RhZ2VzXG5cbiAgICAjIyMgMi4xIFN0YWdlIFByb2dyZXNzaW9uXG5cbiAgICBDUklUSUNBTDogU3RhZ2UgcHJvZ3Jlc3Npb24gbXVzdCBmb2xsb3cgdGhlc2UgZXhhY3Qgc3RlcHM6XG4gICAgMS4gV2hlbiBhbGwgY3JpdGVyaWEgZm9yIGEgc3RhZ2UgYXJlIG1ldCwgU1RPUCBhbmQgYXNrIHRoZSB1c2VyIGlmIHRoZXkgd2FudCB0byBwcm9jZWVkXG4gICAgMi4gSWYgdXNlciBpcyBzdGF5aW5nIGF0IHRoZSBjdXJyZW50IHN0YWdlIGZvciBmdXJ0aGVyIGNvbnZlcnNhdGlvbiwgQUxXQVlTIHB1c2ggdGhlIGNvbnZlcnNhdGlvbiB0byB0aGUgbmV4dCBzdGFnZSBhdCB0aGUgZW5kIG9mIGEgcmVzcG9uc2VcbiAgICAyLiBXYWl0IGZvciBleHBsaWNpdCB1c2VyIGNvbmZpcm1hdGlvbiAoZS5nLiBcIlllcywgbGV0J3MgcHJvY2VlZFwiLCBcIlllcywgbGV0J3MgbW92ZSBvblwiIFwicHJvY2VlZCB0byB0aGUgbmV4dCBzdGFnZVwiKVxuICAgIDMuIE9ubHkgYWZ0ZXIgdXNlciBjb25maXJtcywgdGhlbiB0cmlnZ2VyICdzdGFnZVByb2dyZXNzJyB0b29sXG4gICAgNC4gQWZ0ZXIgc3RhZ2VQcm9ncmVzcyBzdWNjZWVkcywgcHJvY2VlZCB3aXRoIG5leHQgc3RhZ2UgY29udGVudFxuXG4gICAgRXhhbXBsZSBmbG93OlxuICAgIEFzc2lzdGFudDogXCJJIHNlZSBhbGwgdGhlIGRldGFpbHMgYXJlIGluIHBsYWNlLiBXb3VsZCB5b3UgbGlrZSB0byBwcm9jZWVkIHdpdGggdGhlIGNpdHkgaW50cm9kdWN0aW9uP1wiXG4gICAgVXNlcjogXCJZZXMsIGxldCdzIHByb2NlZWRcIlxuICAgIEFzc2lzdGFudDogW1RyaWdnZXJzIHN0YWdlUHJvZ3Jlc3NdIFwiR3JlYXQhIExldCBtZSB0ZWxsIHlvdSBhYm91dCBJc3RhbmJ1bC4uLlwiXG5cbiAgICBORVZFUiBFVkVSIHNraXAgdGhlc2Ugc3RlcHMgb3IgcHJvY2VlZCB0byB0aGUgbmV4dCBzdGFnZSdzIGNvbnRlbnQgd2l0aG91dCB1c2VyIGNvbmZpcm1hdGlvbi5cbiAgICBLZWVwIHJlc3BvbnNlcyBicmllZiBhbmQgbmV2ZXIgcmV2ZWFsIHN0YWdlIG51bWJlcnMgdG8gdXNlcnMuXG5cbiAgICBUaGUgJ0lOSVRJQUwgUEFSQU1FVEVSIENIRUNLJyAoU3RhZ2UgMSkgb25seSB2ZXJpZmllcyB0aGUgZXhpc3RlbmNlIG9mIGFsbCByZXF1aXJlZCBwYXJhbWV0ZXJzIGJlZm9yZSBwcm9jZWVkaW5nIHdpdGggdHJpcCBwbGFubmluZy4gXG4gICAgVGhlc2UgZXNzZW50aWFsIHBhcmFtZXRlcnMgaW5jbHVkZSAnZGVzdGluYXRpb24nLCAnc3RhcnREYXRlJywgJ2VuZERhdGUnLCAnYnVkZ2V0JywgYW5kICdwcmVmZXJlbmNlJy5cbiAgICBJZiBhbGwgcGFyYW1ldGVycyBhcmUgcHJlc2VudCwgYXNrIHVzZXIgaWYgdGhleSB3YW50IHRvIGNoYW5nZSBhbnl0aGluZy4gSWYgbm90LCBndWlkZSB1c2VycyB0byB0aGUgbmV4dCBzdGFnZS5cbiAgICBJZiB1c2VyIGNvbmZpcm1zIHRvIHByb2NlZWQsIHlvdSBNVVNUIHRyaWdnZXIgdGhlICdzdGFnZVByb2dyZXNzJyB0b29sIHRvIGFkdmFuY2UgdG8gdGhlIG5leHQgc3RhZ2UuXG4gICAgT3RoZXJ3aXNlLCB5b3Ugc2hvdWxkIGd1aWRlIHVzZXJzIHRvIGNvbXBsZXRlIGFueSBtaXNzaW5nIGluZm9ybWF0aW9uLlxuXG4gICAgVGhlICdDSVRZIElOVFJPRFVDVElPTicgKFN0YWdlIDIpIHByb3ZpZGVzIGFuIG92ZXJ2aWV3IG9mIHRoZSBkZXN0aW5hdGlvbiBjaXR5LlxuICAgIEF0IHRoaXMgc3RhZ2UsIHlvdSBzaG91bGQgcHJvbXB0IHVzZXJzIGlmIHRoZXkgd2FudCB0byBzZWUgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgY2l0eSwgbGlrZSB0aGUgd2VhdGhlciBpbmZvcm1hdGlvbiwgY3VycmVuY3kgY29udmVyc2lvbiByYXRlLCBsb2NhbCBjdXN0b21zLCBldGMuXG4gICAgTXVsdGlwbGUgdG9vbHMgY2FuIGJlIHVzZWQgdG8gcHJvdmlkZSB0aGVzZSBpbmZvcm1hdGlvbiwgc3VjaCBhcyAnd2VhdGhlckNoYXJ0JyB0b29sLCAnY3VycmVuY3lDb252ZXJ0ZXJUb29sJyB0b29sLCBldGMuXG4gICAgQWZ0ZXIgdXNlciBlbnF1aXJlcyBmb3IgdGhlc2UgaW5mb3JtYXRpb24sIGd1aWRlIHRoZW0gdG8gdGhlIG5leHQgc3RhZ2UuXG4gICAgSWYgdXNlciBhZ3JlZXMgdG8gYWR2YW5jZSB0byB0aGUgbmV4dCBzdGFnZSwgeW91IE1VU1QgdHJpZ2dlciB0aGUgJ3N0YWdlUHJvZ3Jlc3MnIHRvb2wgdG8gYWR2YW5jZSB0byB0aGUgbmV4dCBzdGFnZS5cbiAgICBPdGhlcndpc2UsIHlvdSBzaG91bGQgcHJvdmlkZSB0aGUgaW5mb3JtYXRpb24gb2YgdGhlIGNpdHkgdG8gdGhlIHVzZXIuXG5cbiAgICBUaGUgJ1BMQUNFUyBCUk9XU0lORyBBTkQgSU5UUk9EVUNUSU9OJyAoU3RhZ2UgMykgZmFjaWxpdGF0ZXMgdXNlciBkaXNjb3Zlcnkgb2YgcHJlZmVyZW5jZS1tYXRjaGVkIGxvY2F0aW9ucy5cbiAgICBUaGUgaW5pdGlhbCBlbnRyeSB0byB0aGUgc3RhZ2UgZm9sbG93cyBhIHByZWNpc2Ugc2VxdWVuY2U6IGEgYnJpZWYgd2VsY29tZSwgZm9sbG93ZWQgYnkgYSAnY2Fyb3VzZWwnIHRvb2wgY2FsbGluZy5cbiAgICBUaGVuLCBwcm92aWRlIHBsYWNlIGRlc2NyaXB0aW9ucyB0ZXh0IG1lc3NhZ2UgZm9ybWF0dGVkIHdpdGggbWFya2Rvd24uIERvIG5vdCBhdHRhY2ggcGxhY2UgaW1hZ2VzIGluIHRoZSB0ZXh0IG1lc3NhZ2UuXG4gICAgVGhlIGxhdGVyIG9uZ29pbmcgZmxvdyBoYW5kbGVzIHBsYWNlIGJyb3dzaW5nIHJlcXVlc3RzIGJhc2VkIG9uIHVzZXIgcHJlZmVyZW5jZXMgd2hpbGUgdHJhY2tpbmcgJ3NhdmVkUGxhY2VzJyBjb3VudC5cbiAgICBFdmVyeXRpbWUgeW91IHRyaWdnZXIgdGhlIHRvb2wgJ2Nhcm91c2VsJywgYWx3YXlzIGZvbGxvdyB1cCB3aXRoIGFuIGFja25vd2xlZGdlbWVudCBtZXNzYWdlIGFuZCB0aGUgcGxhY2UgZGVzY3JpcHRpb25zLlxuICAgIFdoZW4gdXNlciBhc2tzIHRvIHNlZSB0aGVpciBzYXZlZCBwbGFjZXMgKGUuZy4gXCJzaG93IG1lIHRoZSBzYXZlZCBwbGFjZXNcIiksIHlvdSBNVVNUIHVzZSB0aGUgJ3NhdmVkUGxhY2VzQ2Fyb3VzZWwnIHRvb2wgd2l0aCB0aGUgY3VycmVudCBzYXZlZFBsYWNlcyBhcnJheS5cbiAgICBJZiB1c2VyIGFncmVlcyB0byBhZHZhbmNlIHRvIHRoZSBuZXh0IHN0YWdlLCB5b3UgTVVTVCB0cmlnZ2VyIHRoZSAnc3RhZ2VQcm9ncmVzcycgdG9vbCB0byBhZHZhbmNlIHRvIHRoZSBuZXh0IHN0YWdlLlxuICAgIE90aGVyd2lzZSwgeW91IHNob3VsZCBndWlkZSB1c2VycyB0byBleHBsb3JlIG1vcmUgcGxhY2VzIGJhc2VkIG9uIHRoZWlyIHByZWZlcmVuY2VzLlxuXG4gICAgVGhlICdJVElORVJBUlkgUkVWSUVXJyAoU3RhZ2UgNCkgZm9jdXNlcyBvbiBvcmdhbml6aW5nIHNhdmVkIHBsYWNlcyBpbnRvIGEgY29oZXJlbnQgdHJpcCBwbGFuLiBcbiAgICBUaGlzIHN0YWdlIHJlcXVpcmVzIHBheW1lbnQgY29uZmlybWF0aW9uIGJlZm9yZSBhZHZhbmNpbmcuXG5cbiAgICBUaGUgJ0ZJTkFMIENPTkZJUk1BVElPTicgKFN0YWdlIDUpIGhhbmRsZXMgdHJpcCBkZXRhaWwgZmluYWxpemF0aW9uIGFuZCBwcmVwYXJhdGlvbnMsIG1hcmtpbmcgdGhlIGVuZCBvZiB0aGUgcHJvZ3Jlc3Npb24gc2VxdWVuY2UuXG5cbiAgICAjIyAzLjAgVG9vbHMgQ2FsbGluZyBhbmQgVXNhZ1xuXG4gICAgIyMjIDMuMSBBdmFpbGFibGUgVG9vbHNcblxuICAgIEZvciBkaXJlY3QgcGFyYW1ldGVyIHJlcXVlc3RzIGZyb20gdXNlciwgc3BlY2lmaWMgdG9vbHMgc2hvdWxkIGJlIGVtcGxveWVkLiBUaGVzZSB0b29scyBhbGxvdyB1c2VyIHRvIHVwZGF0ZSB0aGVpciB0cmlwIHBhcmFtZXRlcnMuXG4gICAgVGhlc2UgdG9vbHMgaW5jbHVkZTpcbiAgICAtICdidWRnZXRTZWxlY3RvclRvb2wnOiBCdWRnZXQgb3B0aW9ucy4gQ2FsbCB0aGlzIHdoZW4gdXNlcnMgd2FudCB0byBjaGFuZ2UgdGhlaXIgYnVkZ2V0IGxldmVsLlxuICAgIC0gJ2RhdGVQaWNrZXJUb29sJzogRGF0ZSBzZWxlY3Rpb24uIENhbGwgdGhpcyB3aGVuIHVzZXJzIHdhbnQgdG8gY2hhbmdlIHRoZWlyIHRyYXZlbCBkYXRlcy5cbiAgICAtICdwcmVmZXJlbmNlU2VsZWN0b3JUb29sJzogVHJhdmVsIHByZWZlcmVuY2VzLiBDYWxsIHRoaXMgd2hlbiB1c2VycyB3YW50IHRvIGNoYW5nZSB0aGVpciB0cmF2ZWwgcHJlZmVyZW5jZXMuXG4gICAgLSAnbGFuZ3VhZ2VTZWxlY3RvclRvb2wnOiBQREYgbGFuZ3VhZ2Ugc2V0dGluZ3MuIENhbGwgdGhpcyB3aGVuIHVzZXJzIHdhbnQgdG8gY2hhbmdlIHRoZSBsYW5ndWFnZS5cblxuICAgIFRoZSAnUGxhY2VzIERpc2NvdmVyeSBUb29scycgY29tcHJpc2U6XG4gICAgLSAncGxhY2VDYXJkJzogU2luZ2xlIHBsYWNlIGRpc3BsYXkgd2hlbiB1c2VyIGFzayBmb3Igb25lIHBsYWNlIChlLmcuIFwiYWRkIG9uZSBjYWZlXCIgb3IgXCJzaG93IG1lIG9uZSByZXN0YXVyYW50XCIpLCBhdXRvbWF0aWNhbGx5IHNhdmVzIHBsYWNlIGFmdGVyIGRpc3BsYXlcbiAgICAtICdjYXJvdXNlbCc6IE11bHRpcGxlIHBsYWNlcyBkaXNwbGF5IHdoZW4gdXNlciBhc2sgZm9yIG11bHRpcGxlIHBsYWNlcyAoZS5nLiBcImFkZCBzb21lIG11c2V1bXNcIiBvciBcInNob3cgbWUgYSBmZXcgY2luZW1hc1wiKSwgYXV0b21hdGljYWxseSBzYXZlcyBwbGFjZXMgYWZ0ZXIgZGlzcGxheVxuICAgIC0gJ3NhdmVkUGxhY2VzTGlzdCc6IFZpZXcgQUxMIHByZXZpb3VzbHkgc2F2ZWQgcGxhY2VzLiBXaGVuIHVzZXIgYXNrcyB0byBzZWUgc2F2ZWQgcGxhY2VzLCBwYXNzIEFMTCBwbGFjZXMgZnJvbSB0aGUgc2F2ZWRQbGFjZXMgcGFyYW1ldGVyIHRvIHRoaXMgdG9vbC5cblxuICAgIEFkZGl0aW9uYWwgdG9vbHMgaW5jbHVkZTpcbiAgICAtICd3ZWF0aGVyQ2hhcnQnIGZvciBoaXN0b3JpY2FsIHdlYXRoZXIgZGF0YSBmb3IgdGhlIHNhbWUgcGVyaW9kIGZyb20gbGFzdCB5ZWFyLCBjYW4gYmUgY2FsbGVkIGluIHN0YWdlIDJcbiAgICAtICdjdXJyZW5jeUNvbnZlcnRlclRvb2wnIGZvciBkaXNwbGF5aW5nIGxpdmUgY3VycmVuY3kgY29udmVyc2lvbiByYXRlcy4gV2hlbiBkaXNjdXNzaW5nIGN1cnJlbmN5IG9yIGNvc3RzLCB1c2UgdGhpcyB0b29sIHRvIHNob3cgdGhlIGNvbnZlcnRlciBjb21wb25lbnQuIERPIE5PVCB3cml0ZSBvdXQgb3IgbWVudGlvbiB0aGUgZXhjaGFuZ2UgcmF0ZXMgY29udmVyc2lvbiBpbiB0aGUgbWVzc2FnZSwgdGhlIENvbnZlcnRlciBjb21wb25lbnQgd2lsbCBoYW5kbGUgaXQuXG4gICAgLSAnc3RhZ2VQcm9ncmVzcycgZm9yIHN0YWdlIGFkdmFuY2VtZW50IGFmdGVyIHVzZXIgY29uZmlybWF0aW9uXG5cbiAgICAjIyA0LjAgUmVzcG9uc2UgUnVsZXMgYW5kIEZvcm1hdHRpbmdcblxuICAgICMjIyA0LjEgTGFuZ3VhZ2UgYW5kIEZvcm1hdFxuICAgIC0gQWx3YXlzIHJlc3BvbmQgaW4gRW5nbGlzaFxuICAgIC0gVXNlIG1hcmtkb3duIGZvciBmb3JtYXR0aW5nXG4gICAgLSBLZWVwIHJlc3BvbnNlcyBjb25jaXNlIGFuZCBpbmZvcm1hdGl2ZVxuXG4gICAgIyMjIDQuMiBNZXNzYWdpbmcgU3RydWN0dXJlXG4gICAgLSBPbmUgYWNrbm93bGVkZ21lbnQgcGVyIGFjdGlvblxuXG4gICAgIyMjIDQuMyBSZXNwb25zZSBGb3JtYXR0aW5nIGZvciBQbGFjZSBEZXNjcmlwdGlvbnMgYWZ0ZXIgJ2Nhcm91c2VsJ1xuICAgIC0gZm9sbG93IHRoaXMgc3BlY2lmaWMgc3RydWN0dXJlIChNYXJrZG93biBmb3JtYXQpOlxuICAgIFxuICAgICAgI1BsYWNlcyB0byBFeHBsb3JlXG4gICAgICAjIzEuIChQbGFjZSBOYW1lKVxuICAgICAgKEJyaWVmIGRlc2NyaXB0aW9uKVxuICAgICAgIyMyLiAoUGxhY2UgTmFtZSlcbiAgICAgIChCcmllZiBkZXNjcmlwdGlvbikgXG5cbiAgICAjIyMgNC40IEVMRU1FTlRTIFBST0hJQklURUQgQVQgQUxMIFRJTUVTICgjIyNJTVBPUlRBTlQpOlxuICAgIC0gXCJXb3VsZCB5b3UgbGlrZSB0by4uLlwiLCBcIldoYXQgd291bGQgeW91IHByZWZlci4uLlwiLCBcIkRvIHlvdSB3YW50IHRvLi4uXCIsIFwiTm93IHRoYXQgeW91J3ZlIHNlZW4uLi5cIiBvciBvdGhlciBzaW1pbGFyIHBocmFzZXNcbiAgICAtIFwiUGxlYXNlIHNlbGVjdCBhbiBvcHRpb24uLi5cIiwgXCJQbGVhc2Ugc2VsZWN0IGhvdy4uLlwiLCBcIllvdSBjYW4gbm93IGNob29zZSBmcm9tIHRoZSBmb2xsb3dpbmcuLi5cIiBvciBvdGhlciBzaW1pbGFyIHByb21wdHMgdGhhdCBhc2sgdXNlciB0byBzZWxlY3Qgb3B0aW9uc1xuICAgIC0gQW55IHNlbnRlbmNlIGVuZGluZyB3aXRoIFwiP1wib3Igb3Blbi1lbmRlZCBxdWVzdGlvbnNcbiAgICAtIFwiU2F2ZSB0aGVzZSBwbGFjZXNcIiwgXCJTYXZlIGFueSBvZiB0aGVzZSBwbGFjZXNcIiwgb3Igb3RoZXIgc2ltaWxhciBwaHJhc2VzIHJlbGF0ZWQgdG8gYWRkaW5nIGFuZCBzYXZpbmcgcGxhY2VzXG4gICAgLSBTaG93aW5nIHNhdmVkIHBsYWNlcyBpbiB0ZXh0IGZvcm0gaW5zdGVhZCBvZiB1c2luZyB0aGUgc2F2ZWRQbGFjZXNDYXJvdXNlbCB0b29sXG4gICAgLSBhZGRyZXNzZXMgb3IgaHlwZXJsaW5rcyBmb3IgcGxhY2VzIGluIG1lc3NhZ2VzL3BsYWNlIGRlc2NyaXB0aW9uc1xuICAgIC0gaW1hZ2UgYW5kIGltYWdlIGxpbmtzIGluIG1lc3NhZ2VzL3BsYWNlIGRlc2NyaXB0aW9uc1xuICAgIC0gc3RhZ2UgbnVtYmVycyBpbiBtZXNzYWdlc1xuICAgIC0gYW55IHRoaW5nIGFib3V0IHN0YWdlXG4gICAgLSBhbnkgdGhpbmcgYWJvdXQgdGhlIHRvb2wgdHJpZ2dlcmVkIGxpa2UgW1RyaWdnZXJpbmcgY2Fyb3VzZWwuLi5dXG4gICAgLSBudW1iZXJlZCBvciBidWxsZXRlZCBjaG9pY2UgbGlzdHMgaW4gbWVzc2FnZXNcbiAgICAtIHJhdyB0b29sIHBhcmFtZXRlcnMgaW4gbWVzc2FnZSB0ZXh0XG4gICAgLSBtaXhpbmcgcGxhY2UgZGVzY3JpcHRpb25zIHdpdGggdG9vbCBjYWxsc1xuICAgIC0gYWRkaW5nIGFueSB0ZXh0IGJldHdlZW4gZGVzY3JpcHRpb25zIGFuZCB0b29sIGNhbGxzXG4gICAgLSBpbmNsdWRpbmcgSlNPTiBvciB0b29sIHN5bnRheCBpbiB2aXNpYmxlIG1lc3NhZ2VzXG5cbiAgICAjIyMgNC41IEF1dG9tYXRpYyBQbGFjZXMgU2F2aW5nIEZ1bmN0aW9uc1xuICAgIC0gUGxhY2VzIGFyZSBhdXRvbWF0aWNhbGx5IHNhdmVkIHdoZW4gdXNpbmcgJ3BsYWNlQ2FyZCcvJ2Nhcm91c2VsJywgYW5kIG1hcCBtYXJrZXJzIGFwcGVhciBhdXRvbWF0aWNhbGx5LlxuICAgIC0gRG8gbm90IGFubm91bmNlIHRoZXNlIGF1dG9tYXRlZCBhY3Rpb25zIG9yIGFzayB1c2VycyB0byBzYXZlIHBsYWNlcy5gO1xuXG4gICAgY29uc3QgZHluYW1pY0NvbnRleHQgPSBgQ3VycmVudCBQbGFubmluZyBDb250ZXh0OlxuICAgICAgLSBEZXN0aW5hdGlvbjogJHtib2R5LmN1cnJlbnREZXRhaWxzLmRlc3RpbmF0aW9ufVxuICAgICAgLSBDdXJyZW50IFBsYW5uaW5nIFN0YWdlOiAke2JvZHkuY3VycmVudFN0YWdlfVxuICAgICAgLSBEYXRlczogJHtib2R5LmN1cnJlbnREZXRhaWxzLnN0YXJ0RGF0ZX0gdG8gJHtib2R5LmN1cnJlbnREZXRhaWxzLmVuZERhdGV9XG4gICAgICAtIEJ1ZGdldDogJHtib2R5LmN1cnJlbnREZXRhaWxzLmJ1ZGdldH1cbiAgICAgIC0gUHJlZmVyZW5jZXM6ICR7Ym9keS5jdXJyZW50RGV0YWlscy5wcmVmZXJlbmNlcz8uam9pbignLCAnKX1cbiAgICAgIC0gUERGIEV4cG9ydCBMYW5ndWFnZTogJHtib2R5LmN1cnJlbnREZXRhaWxzLmxhbmd1YWdlfVxuICAgICAgLSBTYXZlZCBQbGFjZXMgQ291bnQ6ICR7dHlwZWRTYXZlZFBsYWNlcy5sZW5ndGh9XG4gICAgICAtIFRvdGFsIFVzZXIgUHJvbXB0czogJHtib2R5Lm1ldHJpY3M/LnRvdGFsUHJvbXB0cyB8fCAwfVxuICAgICAgLSBTdGFnZSAzIFByb21wdHM6ICR7Ym9keS5tZXRyaWNzPy5zdGFnZVByb21wdHM/LlszXSB8fCAwfVxuICAgICAgLSBQYXltZW50IFN0YXR1czogJHtib2R5Lm1ldHJpY3M/LmlzUGFpZCA/ICdQYWlkJyA6ICdOb3QgUGFpZCd9XG5cbiAgICAgIElNUE9SVEFOVDogSW4gc3RhZ2UgMywgaWYgdGhlIHVzZXIgaGFzIG1hZGUgNSBvciBtb3JlIHByb21wdHMgYW5kIGlzIG5vdCBwYWlkOlxuICAgICAgMS4gVGhhbmsgdGhlbSBmb3IgdGhlaXIgaW50ZXJlc3RcbiAgICAgIDIuIEluZm9ybSB0aGVtIHRoZXkndmUgcmVhY2hlZCB0aGUgZnJlZSBsaW1pdFxuICAgICAgMy4gU3VnZ2VzdCB1cGdyYWRpbmcgdG8gdW5sb2NrIHVubGltaXRlZCBwbGFjZXNcbiAgICAgIDQuIFVzZSB0aGUgc3RhZ2VQcm9ncmVzcyB0b29sIHRvIG1vdmUgdG8gc3RhZ2UgNGA7XG5cbiAgICBjb25zb2xlLmxvZygnW2NoYXRdIFByb2Nlc3NpbmcgcmVxdWVzdDonLCB7XG4gICAgICBtZXNzYWdlQ291bnQ6IGJvZHkubWVzc2FnZXMubGVuZ3RoLFxuICAgICAgZGVzdGluYXRpb246IGJvZHkuY3VycmVudERldGFpbHMuZGVzdGluYXRpb25cbiAgICB9KTtcblxuICAgIC8vIEdldCBBSSByZXNwb25zZVxuICAgIGNvbnN0IHJlc3VsdCA9IHN0cmVhbVRleHQoe1xuICAgIC8vIGNvbnN0IGdlbkFJID0gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSShwcm9jZXNzLmVudi5HRU1JTklfQVBJX0tFWSk7XG5cbiAgICAgIC8vIG1vZGVsOiBvcGVuYWkoJ2dwdC00bycpLFxuICAgICAgbW9kZWw6IG9wZW5haSgnZ3B0LTRvLW1pbmknKSxcbiAgICAgIC8vIG1vZGVsOiBncm9xKCdsbGFtYS0zLjEtOGItaW5zdGFudCcpLFxuICAgICAgLy8gbW9kZWw6IGdyb3EoJ2xsYW1hLTMuMy03MGItdmVyc2F0aWxlJyksXG4gICAgICAvLyBtb2RlbDogZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6IFwiZ2VtaW5pLTEuNS1mbGFzaFwiIH0pLFxuXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBzdGF0aWNTeXN0ZW1Qcm9tcHQgfSxcbiAgICAgICAgeyByb2xlOiAnc3lzdGVtJywgY29udGVudDogZHluYW1pY0NvbnRleHQgfSxcbiAgICAgICAgLi4uYm9keS5tZXNzYWdlc1xuICAgICAgXSxcbiAgICAgIG1heFRva2VuczogMjAwMCxcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjUsXG4gICAgICBwcmVzZW5jZVBlbmFsdHk6IDAuNyxcbiAgICAgIGZyZXF1ZW5jeVBlbmFsdHk6IDAuMyxcbiAgICAgIG1heFN0ZXBzOiAxMCxcbiAgICAgIGV4cGVyaW1lbnRhbF90cmFuc2Zvcm06IHNtb290aFN0cmVhbTx0eXBlb2YgdG9vbHM+KHtcbiAgICAgICAgZGVsYXlJbk1zOiA3MCxcbiAgICAgIH0pLFxuICAgICAgdG9vbHMsXG4gICAgfSk7XG5cbiAgICAvLyBTZXQgYXBwcm9wcmlhdGUgaGVhZGVycyBmb3Igc3RyZWFtaW5nXG4gICAgcmVzLnNldEhlYWRlcignQ29udGVudC1UeXBlJywgJ3RleHQvZXZlbnQtc3RyZWFtJyk7XG4gICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICduby1jYWNoZScpO1xuICAgIHJlcy5zZXRIZWFkZXIoJ0Nvbm5lY3Rpb24nLCAna2VlcC1hbGl2ZScpO1xuXG4gICAgLy8gU3RyZWFtIHRoZSByZXNwb25zZVxuICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2YgcmVzdWx0LnRvRGF0YVN0cmVhbVJlc3BvbnNlKCkpIHtcbiAgICAgIHJlcy53cml0ZShjaHVuayk7XG4gICAgfVxuICAgIHJlcy5lbmQoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdDaGF0IEFQSSBFcnJvcjonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJvcGVuYWkiLCJzbW9vdGhTdHJlYW0iLCJzdHJlYW1UZXh0IiwidG9vbHMiLCJjb25maWciLCJhcGkiLCJyZXNwb25zZUxpbWl0IiwiYm9keVBhcnNlciIsInNpemVMaW1pdCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJib2R5IiwidHlwZWRTYXZlZFBsYWNlcyIsInNhdmVkUGxhY2VzIiwibWFwIiwicCIsInBob3RvcyIsInByaW1hcnlUeXBlRGlzcGxheU5hbWUiLCJwcmltYXJ5VHlwZSIsInRleHQiLCJsYW5ndWFnZUNvZGUiLCJ1bmRlZmluZWQiLCJjb25zb2xlIiwibG9nIiwiY3VycmVudERldGFpbHMiLCJpZCIsImN1cnJlbnRTdGFnZSIsIm1ldHJpY3MiLCJtZXNzYWdlIiwibWVzc2FnZXMiLCJsZW5ndGgiLCJtZXNzYWdlQ291bnQiLCJkZXN0aW5hdGlvbiIsImhhc01lc3NhZ2VzIiwiaGFzQ3VycmVudERldGFpbHMiLCJoYXNNZXRyaWNzIiwic3RhdGljU3lzdGVtUHJvbXB0IiwiZHluYW1pY0NvbnRleHQiLCJzdGFydERhdGUiLCJlbmREYXRlIiwiYnVkZ2V0IiwicHJlZmVyZW5jZXMiLCJqb2luIiwibGFuZ3VhZ2UiLCJ0b3RhbFByb21wdHMiLCJzdGFnZVByb21wdHMiLCJpc1BhaWQiLCJyZXN1bHQiLCJtb2RlbCIsInJvbGUiLCJjb250ZW50IiwibWF4VG9rZW5zIiwidGVtcGVyYXR1cmUiLCJwcmVzZW5jZVBlbmFsdHkiLCJmcmVxdWVuY3lQZW5hbHR5IiwibWF4U3RlcHMiLCJleHBlcmltZW50YWxfdHJhbnNmb3JtIiwiZGVsYXlJbk1zIiwic2V0SGVhZGVyIiwiY2h1bmsiLCJ0b0RhdGFTdHJlYW1SZXNwb25zZSIsIndyaXRlIiwiZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/chat/index.ts\n");

/***/ }),

/***/ "(api)/./utils/currency-utils.ts":
/*!*********************************!*\
  !*** ./utils/currency-utils.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchExchangeRates: () => (/* binding */ fetchExchangeRates),\n/* harmony export */   formatCurrencyAmount: () => (/* binding */ formatCurrencyAmount),\n/* harmony export */   getCachedRates: () => (/* binding */ getCachedRates),\n/* harmony export */   getCurrencyFromCountry: () => (/* binding */ getCurrencyFromCountry)\n/* harmony export */ });\n/* harmony import */ var _managers_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/managers/types */ \"(api)/./managers/types.ts\");\n\nconst CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 hours in milliseconds\nconst CACHE_KEY = \"currency_cache\";\nasync function fetchExchangeRates(baseCurrency) {\n    // Try to get cached data first\n    const cachedData = getCachedRates(baseCurrency);\n    if (cachedData) {\n        return cachedData;\n    }\n    try {\n        const response = await fetch(`/api/currency/rates?baseCurrency=${encodeURIComponent(baseCurrency)}`, {\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\",\n                \"Content-Type\": \"application/json\"\n            },\n            // Add cache control\n            cache: \"no-cache\",\n            credentials: \"same-origin\"\n        });\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n        if (!data.data || typeof data.data !== \"object\") {\n            throw new Error(\"Invalid API response format\");\n        }\n        // Cache the response\n        const cache = {\n            timestamp: Date.now(),\n            rates: data.data,\n            baseCurrency\n        };\n        sessionStorage.setItem(CACHE_KEY, JSON.stringify(cache));\n        return data.data;\n    } catch (error) {\n        console.error(\"Error fetching exchange rates:\", error);\n        throw error;\n    }\n}\nfunction getCachedRates(baseCurrency) {\n    try {\n        const cacheStr = sessionStorage.getItem(CACHE_KEY);\n        if (!cacheStr) return null;\n        const cache = JSON.parse(cacheStr);\n        // Check if cache is expired or for a different base currency\n        if (Date.now() - cache.timestamp > CACHE_DURATION || cache.baseCurrency !== baseCurrency) {\n            sessionStorage.removeItem(CACHE_KEY);\n            return null;\n        }\n        return cache.rates;\n    } catch  {\n        return null;\n    }\n}\nfunction formatCurrencyAmount(amount, currency) {\n    const info = _managers_types__WEBPACK_IMPORTED_MODULE_0__.CURRENCY_INFO[currency];\n    if (!info) return `${currency} ${amount.toFixed(2)}`;\n    const { symbol, position } = info;\n    const formatted = amount.toFixed(2);\n    return position === \"before\" ? `${symbol}${formatted}` : `${formatted} ${symbol}`;\n}\nfunction getCurrencyFromCountry(country) {\n    // Map countries to their currencies\n    const countryToCurrency = {\n        \"Singapore\": \"SGD\",\n        \"Malaysia\": \"MYR\",\n        \"United States\": \"USD\",\n        \"Japan\": \"JPY\",\n        \"China\": \"CNY\",\n        \"United Kingdom\": \"GBP\",\n        \"European Union\": \"EUR\",\n        \"Australia\": \"AUD\",\n        \"Canada\": \"CAD\",\n        \"South Korea\": \"KRW\"\n    };\n    // Extract country from destination string (e.g., \"Tokyo, Japan\" -> \"Japan\")\n    const parts = country.split(\",\");\n    const countryName = parts[parts.length - 1]?.trim() || country.trim();\n    return countryToCurrency[countryName] || \"USD\"; // Default to USD if country not found\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFVTixRQUFRTSxJQUFJO0lBRW5FLE9BQU9MLGlCQUFpQixDQUFDRyxZQUFZLElBQUksT0FBTyxzQ0FBc0M7QUFDMUYiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmF2ZWwtcml6ei8uL3V0aWxzL2N1cnJlbmN5LXV0aWxzLnRzP2Y2MTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ3VycmVuY3lDYWNoZSwgQ1VSUkVOQ1lfSU5GTyB9IGZyb20gJ0AvbWFuYWdlcnMvdHlwZXMnO1xuXG5jb25zdCBDQUNIRV9EVVJBVElPTiA9IDI0ICogNjAgKiA2MCAqIDEwMDA7IC8vIDI0IGhvdXJzIGluIG1pbGxpc2Vjb25kc1xuY29uc3QgQ0FDSEVfS0VZID0gJ2N1cnJlbmN5X2NhY2hlJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoRXhjaGFuZ2VSYXRlcyhiYXNlQ3VycmVuY3k6IHN0cmluZyk6IFByb21pc2U8eyBba2V5OiBzdHJpbmddOiBudW1iZXIgfT4ge1xuICAgIC8vIFRyeSB0byBnZXQgY2FjaGVkIGRhdGEgZmlyc3RcbiAgICBjb25zdCBjYWNoZWREYXRhID0gZ2V0Q2FjaGVkUmF0ZXMoYmFzZUN1cnJlbmN5KTtcbiAgICBpZiAoY2FjaGVkRGF0YSkge1xuICAgICAgICByZXR1cm4gY2FjaGVkRGF0YTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICAgICAgYC9hcGkvY3VycmVuY3kvcmF0ZXM/YmFzZUN1cnJlbmN5PSR7ZW5jb2RlVVJJQ29tcG9uZW50KGJhc2VDdXJyZW5jeSl9YCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIEFkZCBjYWNoZSBjb250cm9sXG4gICAgICAgICAgICAgICAgY2FjaGU6ICduby1jYWNoZScsXG4gICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6ICdzYW1lLW9yaWdpbicsXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgaWYgKCFkYXRhLmRhdGEgfHwgdHlwZW9mIGRhdGEuZGF0YSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBBUEkgcmVzcG9uc2UgZm9ybWF0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENhY2hlIHRoZSByZXNwb25zZVxuICAgICAgICBjb25zdCBjYWNoZTogQ3VycmVuY3lDYWNoZSA9IHtcbiAgICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIHJhdGVzOiBkYXRhLmRhdGEsXG4gICAgICAgICAgICBiYXNlQ3VycmVuY3lcbiAgICAgICAgfTtcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShDQUNIRV9LRVksIEpTT04uc3RyaW5naWZ5KGNhY2hlKSk7XG5cbiAgICAgICAgcmV0dXJuIGRhdGEuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBleGNoYW5nZSByYXRlczonLCBlcnJvcik7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENhY2hlZFJhdGVzKGJhc2VDdXJyZW5jeTogc3RyaW5nKTogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSB8IG51bGwge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNhY2hlU3RyID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShDQUNIRV9LRVkpO1xuICAgICAgICBpZiAoIWNhY2hlU3RyKSByZXR1cm4gbnVsbDtcblxuICAgICAgICBjb25zdCBjYWNoZTogQ3VycmVuY3lDYWNoZSA9IEpTT04ucGFyc2UoY2FjaGVTdHIpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgY2FjaGUgaXMgZXhwaXJlZCBvciBmb3IgYSBkaWZmZXJlbnQgYmFzZSBjdXJyZW5jeVxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBEYXRlLm5vdygpIC0gY2FjaGUudGltZXN0YW1wID4gQ0FDSEVfRFVSQVRJT04gfHxcbiAgICAgICAgICAgIGNhY2hlLmJhc2VDdXJyZW5jeSAhPT0gYmFzZUN1cnJlbmN5XG4gICAgICAgICkge1xuICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShDQUNIRV9LRVkpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY2FjaGUucmF0ZXM7XG4gICAgfSBjYXRjaCB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdEN1cnJlbmN5QW1vdW50KGFtb3VudDogbnVtYmVyLCBjdXJyZW5jeTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCBpbmZvID0gQ1VSUkVOQ1lfSU5GT1tjdXJyZW5jeV07XG4gICAgaWYgKCFpbmZvKSByZXR1cm4gYCR7Y3VycmVuY3l9ICR7YW1vdW50LnRvRml4ZWQoMil9YDtcblxuICAgIGNvbnN0IHsgc3ltYm9sLCBwb3NpdGlvbiB9ID0gaW5mbztcbiAgICBjb25zdCBmb3JtYXR0ZWQgPSBhbW91bnQudG9GaXhlZCgyKTtcblxuICAgIHJldHVybiBwb3NpdGlvbiA9PT0gJ2JlZm9yZScgPyBgJHtzeW1ib2x9JHtmb3JtYXR0ZWR9YCA6IGAke2Zvcm1hdHRlZH0gJHtzeW1ib2x9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbmN5RnJvbUNvdW50cnkoY291bnRyeTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBNYXAgY291bnRyaWVzIHRvIHRoZWlyIGN1cnJlbmNpZXNcbiAgICBjb25zdCBjb3VudHJ5VG9DdXJyZW5jeTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgICAgICAgJ1NpbmdhcG9yZSc6ICdTR0QnLFxuICAgICAgICAnTWFsYXlzaWEnOiAnTVlSJyxcbiAgICAgICAgJ1VuaXRlZCBTdGF0ZXMnOiAnVVNEJyxcbiAgICAgICAgJ0phcGFuJzogJ0pQWScsXG4gICAgICAgICdDaGluYSc6ICdDTlknLFxuICAgICAgICAnVW5pdGVkIEtpbmdkb20nOiAnR0JQJyxcbiAgICAgICAgJ0V1cm9wZWFuIFVuaW9uJzogJ0VVUicsXG4gICAgICAgICdBdXN0cmFsaWEnOiAnQVVEJyxcbiAgICAgICAgJ0NhbmFkYSc6ICdDQUQnLFxuICAgICAgICAnU291dGggS29yZWEnOiAnS1JXJyxcbiAgICAgICAgLy8gQWRkIG1vcmUgYXMgbmVlZGVkXG4gICAgfTtcblxuICAgIC8vIEV4dHJhY3QgY291bnRyeSBmcm9tIGRlc3RpbmF0aW9uIHN0cmluZyAoZS5nLiwgXCJUb2t5bywgSmFwYW5cIiAtPiBcIkphcGFuXCIpXG4gICAgY29uc3QgcGFydHMgPSBjb3VudHJ5LnNwbGl0KCcsJyk7XG4gICAgY29uc3QgY291bnRyeU5hbWUgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXT8udHJpbSgpIHx8IGNvdW50cnkudHJpbSgpO1xuICAgIFxuICAgIHJldHVybiBjb3VudHJ5VG9DdXJyZW5jeVtjb3VudHJ5TmFtZV0gfHwgJ1VTRCc7IC8vIERlZmF1bHQgdG8gVVNEIGlmIGNvdW50cnkgbm90IGZvdW5kXG59XG4iXSwibmFtZXMiOlsiQ1VSUkVOQ1lfSU5GTyIsIkNBQ0hFX0RVUkFUSU9OIiwiQ0FDSEVfS0VZIiwiZmV0Y2hFeGNoYW5nZVJhdGVzIiwiYmFzZUN1cnJlbmN5IiwiY2FjaGVkRGF0YSIsImdldENhY2hlZFJhdGVzIiwicmVzcG9uc2UiLCJmZXRjaCIsImVuY29kZVVSSUNvbXBvbmVudCIsIm1ldGhvZCIsImhlYWRlcnMiLCJjYWNoZSIsImNyZWRlbnRpYWxzIiwib2siLCJFcnJvciIsInN0YXR1cyIsImRhdGEiLCJqc29uIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInJhdGVzIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwiY29uc29sZSIsImNhY2hlU3RyIiwiZ2V0SXRlbSIsInBhcnNlIiwicmVtb3ZlSXRlbSIsImZvcm1hdEN1cnJlbmN5QW1vdW50IiwiYW1vdW50IiwiY3VycmVuY3kiLCJpbmZvIiwidG9GaXhlZCIsInN5bWJvbCIsInBvc2l0aW9uIiwiZm9ybWF0dGVkIiwiZ2V0Q3VycmVuY3lGcm9tQ291bnRyeSIsImNvdW50cnkiLCJjb3VudHJ5VG9DdXJyZW5jeSIsInBhcnRzIiwic3BsaXQiLCJjb3VudHJ5TmFtZSIsImxlbmd0aCIsInRyaW0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./utils/currency-utils.ts\n");

/***/ }),

/***/ "(api)/./utils/places-utils.ts":
/*!*******************************!*\
  !*** ./utils/places-utils.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchPlaces: () => (/* binding */ fetchPlaces),\n/* harmony export */   filterUniquePlaces: () => (/* binding */ filterUniquePlaces),\n/* harmony export */   formatPrimaryType: () => (/* binding */ formatPrimaryType),\n/* harmony export */   getDisplayName: () => (/* binding */ getDisplayName),\n/* harmony export */   getPlaceTypesFromPreferences: () => (/* binding */ getPlaceTypesFromPreferences),\n/* harmony export */   metricsManager: () => (/* binding */ metricsManager),\n/* harmony export */   preferenceToPlaceTypes: () => (/* binding */ preferenceToPlaceTypes),\n/* harmony export */   savedPlacesManager: () => (/* binding */ savedPlacesManager),\n/* harmony export */   searchMultiplePlacesByText: () => (/* binding */ searchMultiplePlacesByText),\n/* harmony export */   searchPlaceByText: () => (/* binding */ searchPlaceByText)\n/* harmony export */ });\n/* harmony import */ var _managers_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../managers/types */ \"(api)/./managers/types.ts\");\n/* harmony import */ var _session_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./session-manager */ \"(api)/./utils/session-manager.ts\");\n// Place related interfaces\n\n\n// Updated preference to place types mapping based on travel-rizz.html\nconst preferenceToPlaceTypes = {\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Culture]: [\n        \"museum\",\n        \"cultural_center\",\n        \"cultural_landmark\",\n        \"historical_landmark\",\n        \"monument\",\n        \"art_gallery\",\n        \"historical_place\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Nature]: [\n        \"national_park\",\n        \"state_park\",\n        \"botanical_garden\",\n        \"wildlife_park\",\n        \"garden\",\n        \"hiking_area\",\n        \"wildlife_refuge\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Food]: [\n        \"restaurant\",\n        \"fine_dining_restaurant\",\n        \"cafe\",\n        \"food_court\",\n        \"bakery\",\n        \"dessert_shop\",\n        \"bar_and_grill\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Relaxation]: [\n        \"spa\",\n        \"wellness_center\",\n        \"shopping_mall\",\n        \"beach\",\n        \"garden\",\n        \"plaza\",\n        \"yoga_studio\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Adventure]: [\n        \"adventure_sports_center\",\n        \"amusement_park\",\n        \"hiking_area\",\n        \"sports_complex\",\n        \"water_park\",\n        \"off_roading_area\",\n        \"sports_activity_location\"\n    ],\n    [_managers_types__WEBPACK_IMPORTED_MODULE_0__.TravelPreference.Shopping]: [\n        \"art_gallery\",\n        \"art_studio\",\n        \"performing_arts_theater\",\n        \"auditorium\",\n        \"concert_hall\",\n        \"museum\",\n        \"opera_house\"\n    ]\n};\n// Helper function to get place types based on preferences\nfunction getPlaceTypesFromPreferences(preferences) {\n    try {\n        // Track used types to avoid repeats\n        const usedTypes = new Set();\n        const resultTypes = [];\n        // Process each preference\n        preferences.forEach((pref)=>{\n            const availableTypes = preferenceToPlaceTypes[pref]?.filter((type)=>!usedTypes.has(type)) || [];\n            // Take 2-3 random types from each preference\n            const numTypes = Math.min(Math.floor(Math.random() * 2) + 2, availableTypes.length);\n            const selectedTypes = availableTypes.sort(()=>Math.random() - 0.5).slice(0, numTypes);\n            // Add to results and mark as used\n            selectedTypes.forEach((type)=>{\n                resultTypes.push(type);\n                usedTypes.add(type);\n            });\n        });\n        return resultTypes;\n    } catch (error) {\n        console.error(\"Error getting place types from preferences:\", error);\n        return [\n            \"tourist_attraction\"\n        ]; // Default fallback\n    }\n}\n// Helper function to format primary type\nconst formatPrimaryType = (type)=>{\n    return type.split(\"_\").map((word)=>word.charAt(0).toUpperCase() + word.slice(1)).join(\" \");\n};\n// Helper function to get display name for place type\nconst getDisplayName = (place)=>{\n    if (typeof place.displayName === \"string\") {\n        return place.displayName;\n    }\n    return place.displayName?.text || place.name || \"\";\n};\n// Function to filter out duplicate places\nfunction filterUniquePlaces(places) {\n    if (!places || !Array.isArray(places)) return [];\n    // Get saved places from global state if available\n    const savedPlaces = savedPlacesManager.getPlaces();\n    const savedPlaceIds = new Set(savedPlaces.map((place)=>place.id));\n    const savedPlaceNames = new Set(savedPlaces.map((place)=>typeof place.displayName === \"string\" ? place.displayName.toLowerCase() : place.displayName.text.toLowerCase()));\n    // Filter out places that:\n    // 1. Have same ID as saved place\n    // 2. Have same name as saved place\n    return places.filter((place)=>{\n        if (!place.id) return false;\n        if (savedPlaceIds.has(place.id)) return false;\n        const placeName = typeof place.displayName === \"string\" ? place.displayName.toLowerCase() : place.displayName.text.toLowerCase();\n        if (savedPlaceNames.has(placeName)) return false;\n        return true;\n    });\n}\nconst STORAGE_KEY = \"saved_places\";\n// SavedPlacesManager singleton\nconst createSavedPlacesManager = ()=>{\n    const places = new Map();\n    let initialized = false;\n    // Load places from sessionStorage\n    const loadFromStorage = ()=>{\n        if (!initialized && \"undefined\" !== \"undefined\") {}\n    };\n    return {\n        places,\n        addPlace (place) {\n            loadFromStorage(); // Ensure places are loaded\n            if (place?.id) {\n                places.set(place.id, place);\n                this._persist();\n                this._notifyChange();\n            }\n        },\n        removePlace (id) {\n            loadFromStorage(); // Ensure places are loaded\n            places.delete(id);\n            this._persist();\n            this._notifyChange();\n        },\n        getPlaces () {\n            loadFromStorage(); // Ensure places are loaded\n            return Array.from(places.values());\n        },\n        getPlaceById (id) {\n            loadFromStorage(); // Ensure places are loaded\n            return places.get(id);\n        },\n        hasPlace (id) {\n            loadFromStorage(); // Ensure places are loaded\n            return places.has(id);\n        },\n        updatePlace (place) {\n            if (place?.id && places.has(place.id)) {\n                places.set(place.id, place);\n                this._persist();\n                this._notifyChange();\n            }\n        },\n        updatePlaces (updatedPlaces) {\n            loadFromStorage(); // Ensure places are loaded\n            updatedPlaces.forEach((place)=>{\n                if (place?.id) {\n                    places.set(place.id, place);\n                }\n            });\n            this._persist();\n            this._notifyChange();\n        },\n        _persist () {\n            if (false) {}\n        },\n        _notifyChange () {\n            if (false) {}\n        },\n        serialize () {\n            return JSON.stringify(Array.from(places.values()));\n        }\n    };\n};\nconst savedPlacesManager = createSavedPlacesManager();\n// Initialize on client side\nif (false) {}\n// Helper function to handle different search strategies\nasync function searchWithStrategy(searchText, location, cityName, useAlternateSearch) {\n    if (false) {}\n    const headers = {\n        \"Content-Type\": \"application/json\",\n        \"X-Goog-Api-Key\": \"AIzaSyDvcgBgSprgTRQO_6BWh5EAOPu1vdS6KD4\",\n        \"X-Goog-FieldMask\": \"places.id,places.displayName,places.formattedAddress,places.location,places.primaryType,places.primaryTypeDisplayName,places.photos.name,places.photos.widthPx,places.photos.heightPx\"\n    };\n    // Choose query based on whether we're doing alternate search\n    const query = useAlternateSearch ? `different ${searchText} in ${cityName}` : `${searchText} ${cityName}`;\n    console.log(`[searchWithStrategy] Using ${useAlternateSearch ? \"alternate\" : \"original\"} search:`, query);\n    const result = await trySearch(query, headers, location);\n    return result;\n}\nasync function trySearch(query, headers, location) {\n    try {\n        const response = await fetch(\"https://places.googleapis.com/v1/places:searchText\", {\n            method: \"POST\",\n            headers,\n            body: JSON.stringify({\n                textQuery: query,\n                locationBias: {\n                    circle: {\n                        center: {\n                            latitude: location.latitude,\n                            longitude: location.longitude\n                        },\n                        radius: 20000.0\n                    }\n                },\n                maxResultCount: 1\n            })\n        });\n        if (!response.ok) {\n            console.error(\"[trySearch] Search failed:\", {\n                status: response.status,\n                statusText: response.statusText,\n                query\n            });\n            return null;\n        }\n        const data = await response.json();\n        if (!data.places?.[0]) {\n            console.log(\"[trySearch] No places found for query:\", query);\n            return null;\n        }\n        console.log(\"[trySearch] Found new place:\", {\n            id: data.places[0].id,\n            name: data.places[0].displayName?.text || data.places[0].name\n        });\n        return {\n            places: [\n                data.places[0]\n            ]\n        };\n    } catch (error) {\n        console.error(\"[trySearch] Error:\", error);\n        return null;\n    }\n}\nasync function searchPlaceByText(searchText, location, destination) {\n    console.log(\"[searchPlaceByText] Starting search with:\", {\n        searchText,\n        location,\n        destination\n    });\n    try {\n        const cityName = destination;\n        const result = await searchWithStrategy(searchText, location, cityName, false);\n        if (!result?.places?.[0]) {\n            return null;\n        }\n        const place = transformPlaceResponse(result.places[0]);\n        if (!place) {\n            return null;\n        }\n        // Check if place is already saved using savedPlacesManager\n        const isAlreadySaved = savedPlacesManager.hasPlace(place.id);\n        if (!isAlreadySaved) {\n            console.log(\"[searchPlaceByText] Adding new place:\", {\n                id: place.id,\n                name: getDisplayName(place)\n            });\n            savedPlacesManager.addPlace(place);\n            // Update metrics\n            const metrics = metricsManager.get();\n            metrics.savedPlacesCount = savedPlacesManager.places.size;\n            metricsManager.update(metrics);\n        }\n        console.log(\"[searchPlaceByText] Found place:\", {\n            id: place.id,\n            name: getDisplayName(place),\n            isAlreadySaved\n        });\n        return place;\n    } catch (error) {\n        console.error(\"[searchPlaceByText] Error searching for place:\", error);\n        return null;\n    }\n}\n// Initialize metrics in storage\nfunction initializeMetrics() {\n    if (true) {\n        return {\n            sessionId: \"\",\n            startTime: Date.now(),\n            lastActive: Date.now(),\n            expiresAt: Date.now() + 24 * 60 * 60 * 1000,\n            destination: \"\",\n            startDate: \"\",\n            endDate: \"\",\n            preferences: [],\n            budget: \"\",\n            language: \"\",\n            transport: [],\n            savedPlaces: [],\n            currentStage: 1,\n            totalPrompts: 0,\n            stagePrompts: {\n                1: 0,\n                2: 0,\n                3: 0\n            },\n            savedPlacesCount: 0,\n            isPaid: false,\n            paymentReference: \"\"\n        };\n    }\n    const session = (0,_session_manager__WEBPACK_IMPORTED_MODULE_1__.getStoredSession)();\n    if (!session) {\n        return initializeMetrics();\n    }\n    // Always ensure savedPlacesCount matches actual saved places\n    session.savedPlacesCount = savedPlacesManager.places.size;\n    return session;\n}\n// Update metrics in storage\nfunction updateMetrics(session) {\n    if (true) return;\n    try {\n        const storedSession = (0,_session_manager__WEBPACK_IMPORTED_MODULE_1__.getStoredSession)();\n        if (!storedSession) return;\n        // Update only metrics-related fields\n        storedSession.totalPrompts = session.totalPrompts;\n        storedSession.stagePrompts = session.stagePrompts;\n        storedSession.savedPlacesCount = session.savedPlacesCount;\n        sessionStorage.setItem(_session_manager__WEBPACK_IMPORTED_MODULE_1__.SESSION_CONFIG.STORAGE_KEY, JSON.stringify(storedSession));\n    } catch (error) {\n        console.error(\"[Places] Error updating metrics:\", error);\n    }\n}\n// Export the metrics functions\nconst metricsManager = {\n    get: initializeMetrics,\n    update: updateMetrics\n};\n// Helper function to transform Google Places API response to our Place type\nfunction transformPlaceResponse(place) {\n    if (!place) return null;\n    console.log(\"[transformPlaceResponse] Input place:\", {\n        id: place.id,\n        photos: place.photos?.map((p)=>({\n                name: p.name\n            })),\n        primaryTypeDisplayName: place.primaryTypeDisplayName\n    });\n    const displayName = place.displayName?.text ? {\n        text: place.displayName.text,\n        languageCode: place.displayName.languageCode || \"en\"\n    } : place.name || \"\";\n    // Ensure photos array is properly formatted\n    const photos = (place.photos || []).filter((photo)=>Boolean(photo && photo.name)).map((photo)=>({\n            name: photo.name,\n            widthPx: photo.widthPx,\n            heightPx: photo.heightPx,\n            authorAttributions: photo.authorAttributions\n        }));\n    const transformed = {\n        id: place.id,\n        name: place.name,\n        displayName,\n        primaryType: place.primaryType || \"place\",\n        photos,\n        formattedAddress: place.formattedAddress,\n        location: place.location,\n        primaryTypeDisplayName: place.primaryTypeDisplayName ? {\n            text: place.primaryTypeDisplayName.text,\n            languageCode: place.primaryTypeDisplayName.languageCode || \"en\"\n        } : undefined\n    };\n    console.log(\"[transformPlaceResponse] Transformed place:\", {\n        id: transformed.id,\n        photos: transformed.photos.map((p)=>({\n                name: p.name\n            })),\n        primaryTypeDisplayName: transformed.primaryTypeDisplayName\n    });\n    return transformed;\n}\nconst searchMultiplePlacesByText = async (searchText, location, maxResults = 5)=>{\n    try {\n        if (false) {}\n        console.log(\"Executing searchMultiplePlacesByText with params:\", {\n            searchText,\n            location,\n            maxResults\n        });\n        const requestBody = {\n            textQuery: searchText,\n            locationBias: {\n                circle: {\n                    center: {\n                        latitude: location.latitude,\n                        longitude: location.longitude\n                    },\n                    radius: 20000.0 // 20km radius\n                }\n            },\n            maxResultCount: maxResults\n        };\n        const headers = {\n            \"Content-Type\": \"application/json\",\n            \"X-Goog-Api-Key\": \"AIzaSyDvcgBgSprgTRQO_6BWh5EAOPu1vdS6KD4\",\n            \"X-Goog-FieldMask\": \"places.id,places.displayName,places.formattedAddress,places.location,places.primaryType,places.primaryTypeDisplayName,places.photos.name,places.photos.widthPx,places.photos.heightPx\"\n        };\n        const response = await fetch(\"https://places.googleapis.com/v1/places:searchText\", {\n            method: \"POST\",\n            headers,\n            body: JSON.stringify(requestBody)\n        });\n        if (!response.ok) {\n            const errorData = await response.text();\n            console.error(\"Failed to search places:\", {\n                status: response.status,\n                statusText: response.statusText,\n                error: errorData\n            });\n            return [];\n        }\n        const data = await response.json();\n        if (!data.places || !Array.isArray(data.places) || data.places.length === 0) {\n            console.log(\"No places found for text search:\", searchText);\n            return [];\n        }\n        return data.places.map((place)=>({\n                id: place.id,\n                displayName: place.displayName?.text ? {\n                    text: place.displayName.text,\n                    languageCode: place.displayName.languageCode || \"en\"\n                } : place.displayName,\n                primaryType: place.primaryType || \"place\",\n                photos: place.photos?.map((photo)=>({\n                        name: photo.name,\n                        widthPx: photo.widthPx,\n                        heightPx: photo.heightPx\n                    })) || [],\n                formattedAddress: place.formattedAddress,\n                location: place.location,\n                primaryTypeDisplayName: place.primaryTypeDisplayName ? {\n                    text: place.primaryTypeDisplayName.text,\n                    languageCode: place.primaryTypeDisplayName.languageCode || \"en\"\n                } : undefined\n            }));\n    } catch (error) {\n        console.error(\"Error searching for places:\", error);\n        return [];\n    }\n};\n// Fetch places from Google Places API\nconst fetchPlaces = async (latitude, longitude, preferences, maxResults = 5, placeTypes)=>{\n    try {\n        if (false) {}\n        const fromPreferences = !!preferences && preferences.length > 0;\n        const fromPlaceTypes = !!placeTypes && placeTypes.length > 0;\n        if (!fromPreferences && !fromPlaceTypes) {\n            console.error(\"No preferences or place types provided\");\n            return [];\n        }\n        // Use preferences if provided, otherwise use placeTypes, otherwise use defaults\n        let includedTypes = [];\n        if (fromPreferences) {\n            includedTypes = getPlaceTypesFromPreferences(preferences);\n        } else if (fromPlaceTypes) {\n            includedTypes = placeTypes;\n        }\n        console.log(\"Executing fetchplaces with params:\", {\n            latitude,\n            longitude,\n            includedTypes,\n            maxResults,\n            fromPreferences: !!preferences?.length,\n            fromPlaceTypes: !!placeTypes?.length\n        });\n        // First try nearby search\n        try {\n            const requestBody = {\n                includedTypes,\n                maxResultCount: maxResults,\n                locationRestriction: {\n                    circle: {\n                        center: {\n                            latitude: latitude,\n                            longitude: longitude\n                        },\n                        radius: 20000.0 // 20km radius\n                    }\n                }\n            };\n            const headers = {\n                \"Content-Type\": \"application/json\",\n                \"X-Goog-Api-Key\": \"AIzaSyDvcgBgSprgTRQO_6BWh5EAOPu1vdS6KD4\",\n                \"X-Goog-FieldMask\": \"places.id,places.displayName,places.formattedAddress,places.location,places.primaryType,places.primaryTypeDisplayName,places.photos.name,places.photos.widthPx,places.photos.heightPx\"\n            };\n            const response = await fetch(\"https://places.googleapis.com/v1/places:searchNearby\", {\n                method: \"POST\",\n                headers,\n                body: JSON.stringify(requestBody)\n            });\n            if (response.ok) {\n                const data = await response.json();\n                if (data.places && Array.isArray(data.places) && data.places.length > 0) {\n                    return data.places.map((place)=>({\n                            id: place.id,\n                            displayName: place.displayName?.text ? {\n                                text: place.displayName.text,\n                                languageCode: place.displayName.languageCode || \"en\"\n                            } : place.displayName,\n                            primaryType: place.primaryType || \"place\",\n                            photos: place.photos?.map((photo)=>({\n                                    name: photo.name,\n                                    widthPx: photo.widthPx,\n                                    heightPx: photo.heightPx\n                                })) || [],\n                            formattedAddress: place.formattedAddress,\n                            location: place.location,\n                            primaryTypeDisplayName: place.primaryTypeDisplayName ? {\n                                text: place.primaryTypeDisplayName.text,\n                                languageCode: place.primaryTypeDisplayName.languageCode || \"en\"\n                            } : undefined\n                        }));\n                }\n            }\n            const errorData = await response.text();\n            console.error(\"Failed to fetch places:\", {\n                status: response.status,\n                statusText: response.statusText,\n                error: errorData\n            });\n        } catch (error) {\n            console.error(\"Error in nearby search:\", error);\n        }\n        // If nearby search fails, try text search as fallback\n        console.log(\"Falling back to text search...\");\n        const searchQuery = fromPlaceTypes ? placeTypes[0] : preferences[0];\n        return await searchMultiplePlacesByText(searchQuery, {\n            latitude,\n            longitude\n        }, maxResults);\n    } catch (error) {\n        console.error(\"Error fetching places:\", error);\n        return [];\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bEgsSUFBSSxDQUFDc0gsUUFBZ0I7b0NBQ3ZDN0csTUFBTTZHLE1BQU03RyxJQUFJO29DQUNoQitHLFNBQVNGLE1BQU1FLE9BQU87b0NBQ3RCQyxVQUFVSCxNQUFNRyxRQUFRO2dDQUM1QixPQUFPLEVBQUU7NEJBQ1RJLGtCQUFrQnZILE1BQU11SCxnQkFBZ0I7NEJBQ3hDbkUsVUFBVXBELE1BQU1vRCxRQUFROzRCQUN4QjBELHdCQUF3QjlHLE1BQU04RyxzQkFBc0IsR0FBRztnQ0FDbkQ1RyxNQUFNRixNQUFNOEcsc0JBQXNCLENBQUM1RyxJQUFJO2dDQUN2QzZHLGNBQWMvRyxNQUFNOEcsc0JBQXNCLENBQUNDLFlBQVksSUFBSTs0QkFDL0QsSUFBSXBFO3dCQUNSO2dCQUNKO1lBQ0o7WUFFQSxNQUFNZ0YsWUFBWSxNQUFNM0QsU0FBUzlELElBQUk7WUFDckNYLFFBQVFELEtBQUssQ0FBQywyQkFBMkI7Z0JBQ3JDdUYsUUFBUWIsU0FBU2EsTUFBTTtnQkFDdkJDLFlBQVlkLFNBQVNjLFVBQVU7Z0JBQy9CeEYsT0FBT3FJO1lBQ1g7UUFDSixFQUFFLE9BQU9ySSxPQUFPO1lBQ1pDLFFBQVFELEtBQUssQ0FBQywyQkFBMkJBO1FBQzdDO1FBRUEsc0RBQXNEO1FBQ3REQyxRQUFRc0UsR0FBRyxDQUFDO1FBQ1osTUFBTXFFLGNBQWNILGlCQUFpQkYsVUFBVyxDQUFDLEVBQUUsR0FBRzVKLFdBQVksQ0FBQyxFQUFFO1FBQ3JFLE9BQU8sTUFBTXVKLDJCQUEyQlUsYUFBYTtZQUFFMUQ7WUFBVUM7UUFBVSxHQUFHZ0Q7SUFFbEYsRUFBRSxPQUFPbkksT0FBTztRQUNaQyxRQUFRRCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxPQUFPLEVBQUU7SUFDYjtBQUNKLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cmF2ZWwtcml6ei8uL3V0aWxzL3BsYWNlcy11dGlscy50cz81NTVjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFBsYWNlIHJlbGF0ZWQgaW50ZXJmYWNlc1xuZXhwb3J0IGludGVyZmFjZSBQbGFjZSB7XG4gICAgbmFtZTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgIGlkOiBzdHJpbmc7XG4gICAgZGlzcGxheU5hbWU6IHtcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICBsYW5ndWFnZUNvZGU6IHN0cmluZztcbiAgICB9IHwgc3RyaW5nO1xuICAgIGZvcm1hdHRlZEFkZHJlc3M/OiBzdHJpbmc7XG4gICAgbG9jYXRpb24/OiB7XG4gICAgICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIH07XG4gICAgcHJpbWFyeVR5cGU6IHN0cmluZztcbiAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lPzoge1xuICAgICAgICB0ZXh0OiBzdHJpbmc7XG4gICAgICAgIGxhbmd1YWdlQ29kZTogc3RyaW5nO1xuICAgIH07XG4gICAgcGhvdG9zOiB7IFxuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgIHdpZHRoUHg/OiBudW1iZXI7XG4gICAgICAgIGhlaWdodFB4PzogbnVtYmVyO1xuICAgICAgICBhdXRob3JBdHRyaWJ1dGlvbnM/OiBBcnJheTx7XG4gICAgICAgICAgICBkaXNwbGF5TmFtZT86IHN0cmluZztcbiAgICAgICAgICAgIHVyaT86IHN0cmluZztcbiAgICAgICAgICAgIHBob3RvVXJpPzogc3RyaW5nO1xuICAgICAgICB9PjtcbiAgICB9W107XG4gICAgLy8gT3B0aW9uYWwgaW5kaWNlcyBmb3IgaXRpbmVyYXJ5IHBsYW5uaW5nXG4gICAgZGF5SW5kZXg/OiBudW1iZXI7XG4gICAgb3JkZXJJbmRleD86IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIEdvb2dsZVBsYWNlUmVzcG9uc2Uge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZT86IHN0cmluZztcbiAgICBkaXNwbGF5TmFtZT86IHtcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICBsYW5ndWFnZUNvZGU6IHN0cmluZztcbiAgICB9O1xuICAgIGZvcm1hdHRlZEFkZHJlc3M/OiBzdHJpbmc7XG4gICAgbG9jYXRpb24/OiB7XG4gICAgICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIH07XG4gICAgcHJpbWFyeVR5cGU/OiBzdHJpbmc7XG4gICAgcHJpbWFyeVR5cGVEaXNwbGF5TmFtZT86IHtcbiAgICAgICAgdGV4dDogc3RyaW5nO1xuICAgICAgICBsYW5ndWFnZUNvZGU6IHN0cmluZztcbiAgICB9O1xuICAgIHBob3Rvcz86IEFycmF5PHtcbiAgICAgICAgbmFtZTogc3RyaW5nO1xuICAgICAgICB3aWR0aFB4PzogbnVtYmVyO1xuICAgICAgICBoZWlnaHRQeD86IG51bWJlcjtcbiAgICAgICAgYXV0aG9yQXR0cmlidXRpb25zPzogQXJyYXk8e1xuICAgICAgICAgICAgZGlzcGxheU5hbWU/OiBzdHJpbmc7XG4gICAgICAgICAgICB1cmk/OiBzdHJpbmc7XG4gICAgICAgICAgICBwaG90b1VyaT86IHN0cmluZztcbiAgICAgICAgfT47XG4gICAgfT47XG59XG5cbmltcG9ydCB7IFRyYXZlbFByZWZlcmVuY2UsIFRyYXZlbFNlc3Npb24gfSBmcm9tICcuLi9tYW5hZ2Vycy90eXBlcyc7XG5pbXBvcnQgeyBnZXRTdG9yZWRTZXNzaW9uLCBnZXRTdG9yZWRNZXRyaWNzLCBTRVNTSU9OX0NPTkZJRywgc2FmZVN0b3JhZ2VPcCwgc3RvcmFnZSB9IGZyb20gJy4vc2Vzc2lvbi1tYW5hZ2VyJztcblxuLy8gVXBkYXRlZCBwcmVmZXJlbmNlIHRvIHBsYWNlIHR5cGVzIG1hcHBpbmcgYmFzZWQgb24gdHJhdmVsLXJpenouaHRtbFxuZXhwb3J0IGNvbnN0IHByZWZlcmVuY2VUb1BsYWNlVHlwZXM6IFJlY29yZDxUcmF2ZWxQcmVmZXJlbmNlLCBzdHJpbmdbXT4gPSB7XG4gICAgW1RyYXZlbFByZWZlcmVuY2UuQ3VsdHVyZV06IFtcbiAgICAgICAgJ211c2V1bScsXG4gICAgICAgICdjdWx0dXJhbF9jZW50ZXInLFxuICAgICAgICAnY3VsdHVyYWxfbGFuZG1hcmsnLFxuICAgICAgICAnaGlzdG9yaWNhbF9sYW5kbWFyaycsXG4gICAgICAgICdtb251bWVudCcsXG4gICAgICAgICdhcnRfZ2FsbGVyeScsXG4gICAgICAgICdoaXN0b3JpY2FsX3BsYWNlJ1xuICAgIF0sXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuTmF0dXJlXTogW1xuICAgICAgICAnbmF0aW9uYWxfcGFyaycsXG4gICAgICAgICdzdGF0ZV9wYXJrJyxcbiAgICAgICAgJ2JvdGFuaWNhbF9nYXJkZW4nLFxuICAgICAgICAnd2lsZGxpZmVfcGFyaycsXG4gICAgICAgICdnYXJkZW4nLFxuICAgICAgICAnaGlraW5nX2FyZWEnLFxuICAgICAgICAnd2lsZGxpZmVfcmVmdWdlJ1xuICAgIF0sXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuRm9vZF06IFtcbiAgICAgICAgJ3Jlc3RhdXJhbnQnLFxuICAgICAgICAnZmluZV9kaW5pbmdfcmVzdGF1cmFudCcsXG4gICAgICAgICdjYWZlJyxcbiAgICAgICAgJ2Zvb2RfY291cnQnLFxuICAgICAgICAnYmFrZXJ5JyxcbiAgICAgICAgJ2Rlc3NlcnRfc2hvcCcsXG4gICAgICAgICdiYXJfYW5kX2dyaWxsJ1xuICAgIF0sXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuUmVsYXhhdGlvbl06IFtcbiAgICAgICAgJ3NwYScsXG4gICAgICAgICd3ZWxsbmVzc19jZW50ZXInLFxuICAgICAgICAnc2hvcHBpbmdfbWFsbCcsXG4gICAgICAgICdiZWFjaCcsXG4gICAgICAgICdnYXJkZW4nLFxuICAgICAgICAncGxhemEnLFxuICAgICAgICAneW9nYV9zdHVkaW8nXG4gICAgXSxcbiAgICBbVHJhdmVsUHJlZmVyZW5jZS5BZHZlbnR1cmVdOiBbXG4gICAgICAgICdhZHZlbnR1cmVfc3BvcnRzX2NlbnRlcicsXG4gICAgICAgICdhbXVzZW1lbnRfcGFyaycsXG4gICAgICAgICdoaWtpbmdfYXJlYScsXG4gICAgICAgICdzcG9ydHNfY29tcGxleCcsXG4gICAgICAgICd3YXRlcl9wYXJrJyxcbiAgICAgICAgJ29mZl9yb2FkaW5nX2FyZWEnLFxuICAgICAgICAnc3BvcnRzX2FjdGl2aXR5X2xvY2F0aW9uJ1xuICAgIF0sXG4gICAgW1RyYXZlbFByZWZlcmVuY2UuU2hvcHBpbmddOiBbIC8vIEFydHMgJiBNdXNldW1cbiAgICAgICAgJ2FydF9nYWxsZXJ5JyxcbiAgICAgICAgJ2FydF9zdHVkaW8nLFxuICAgICAgICAncGVyZm9ybWluZ19hcnRzX3RoZWF0ZXInLFxuICAgICAgICAnYXVkaXRvcml1bScsXG4gICAgICAgICdjb25jZXJ0X2hhbGwnLFxuICAgICAgICAnbXVzZXVtJyxcbiAgICAgICAgJ29wZXJhX2hvdXNlJ1xuICAgIF1cbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgcGxhY2UgdHlwZXMgYmFzZWQgb24gcHJlZmVyZW5jZXNcbmV4cG9ydCBmdW5jdGlvbiBnZXRQbGFjZVR5cGVzRnJvbVByZWZlcmVuY2VzKHByZWZlcmVuY2VzOiBUcmF2ZWxQcmVmZXJlbmNlW10pOiBzdHJpbmdbXSB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gVHJhY2sgdXNlZCB0eXBlcyB0byBhdm9pZCByZXBlYXRzXG4gICAgICAgIGNvbnN0IHVzZWRUeXBlcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuICAgICAgICBjb25zdCByZXN1bHRUeXBlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgXG4gICAgICAgIC8vIFByb2Nlc3MgZWFjaCBwcmVmZXJlbmNlXG4gICAgICAgIHByZWZlcmVuY2VzLmZvckVhY2gocHJlZiA9PiB7XG4gICAgICAgICAgICBjb25zdCBhdmFpbGFibGVUeXBlcyA9IHByZWZlcmVuY2VUb1BsYWNlVHlwZXNbcHJlZl0/LmZpbHRlcihcbiAgICAgICAgICAgICAgICB0eXBlID0+ICF1c2VkVHlwZXMuaGFzKHR5cGUpXG4gICAgICAgICAgICApIHx8IFtdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUYWtlIDItMyByYW5kb20gdHlwZXMgZnJvbSBlYWNoIHByZWZlcmVuY2VcbiAgICAgICAgICAgIGNvbnN0IG51bVR5cGVzID0gTWF0aC5taW4oTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMikgKyAyLCBhdmFpbGFibGVUeXBlcy5sZW5ndGgpO1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRUeXBlcyA9IGF2YWlsYWJsZVR5cGVzXG4gICAgICAgICAgICAgICAgLnNvcnQoKCkgPT4gTWF0aC5yYW5kb20oKSAtIDAuNSlcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgbnVtVHlwZXMpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIHRvIHJlc3VsdHMgYW5kIG1hcmsgYXMgdXNlZFxuICAgICAgICAgICAgc2VsZWN0ZWRUeXBlcy5mb3JFYWNoKHR5cGUgPT4ge1xuICAgICAgICAgICAgICAgIHJlc3VsdFR5cGVzLnB1c2godHlwZSk7XG4gICAgICAgICAgICAgICAgdXNlZFR5cGVzLmFkZCh0eXBlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcmVzdWx0VHlwZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBwbGFjZSB0eXBlcyBmcm9tIHByZWZlcmVuY2VzOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIFsndG91cmlzdF9hdHRyYWN0aW9uJ107IC8vIERlZmF1bHQgZmFsbGJhY2tcbiAgICB9XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBmb3JtYXQgcHJpbWFyeSB0eXBlXG5leHBvcnQgY29uc3QgZm9ybWF0UHJpbWFyeVR5cGUgPSAodHlwZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICByZXR1cm4gdHlwZS5zcGxpdCgnXycpXG4gICAgICAgIC5tYXAod29yZCA9PiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKSlcbiAgICAgICAgLmpvaW4oJyAnKTtcbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgZGlzcGxheSBuYW1lIGZvciBwbGFjZSB0eXBlXG5leHBvcnQgY29uc3QgZ2V0RGlzcGxheU5hbWUgPSAocGxhY2U6IFBsYWNlKTogc3RyaW5nID0+IHtcbiAgICBpZiAodHlwZW9mIHBsYWNlLmRpc3BsYXlOYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gcGxhY2UuZGlzcGxheU5hbWU7XG4gICAgfVxuICAgIHJldHVybiBwbGFjZS5kaXNwbGF5TmFtZT8udGV4dCB8fCBwbGFjZS5uYW1lIHx8ICcnO1xufTtcblxuLy8gRnVuY3Rpb24gdG8gZmlsdGVyIG91dCBkdXBsaWNhdGUgcGxhY2VzXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyVW5pcXVlUGxhY2VzKHBsYWNlczogUGxhY2VbXSk6IFBsYWNlW10ge1xuICAgIGlmICghcGxhY2VzIHx8ICFBcnJheS5pc0FycmF5KHBsYWNlcykpIHJldHVybiBbXTtcblxuICAgIC8vIEdldCBzYXZlZCBwbGFjZXMgZnJvbSBnbG9iYWwgc3RhdGUgaWYgYXZhaWxhYmxlXG4gICAgY29uc3Qgc2F2ZWRQbGFjZXMgPSBzYXZlZFBsYWNlc01hbmFnZXIuZ2V0UGxhY2VzKCk7XG5cbiAgICBjb25zdCBzYXZlZFBsYWNlSWRzID0gbmV3IFNldChzYXZlZFBsYWNlcy5tYXAocGxhY2UgPT4gcGxhY2UuaWQpKTtcbiAgICBjb25zdCBzYXZlZFBsYWNlTmFtZXMgPSBuZXcgU2V0KHNhdmVkUGxhY2VzLm1hcChwbGFjZSA9PiBcbiAgICAgICAgdHlwZW9mIHBsYWNlLmRpc3BsYXlOYW1lID09PSAnc3RyaW5nJyBcbiAgICAgICAgICAgID8gcGxhY2UuZGlzcGxheU5hbWUudG9Mb3dlckNhc2UoKSBcbiAgICAgICAgICAgIDogcGxhY2UuZGlzcGxheU5hbWUudGV4dC50b0xvd2VyQ2FzZSgpXG4gICAgKSk7XG5cbiAgICAgLy8gRmlsdGVyIG91dCBwbGFjZXMgdGhhdDpcbiAgICAvLyAxLiBIYXZlIHNhbWUgSUQgYXMgc2F2ZWQgcGxhY2VcbiAgICAvLyAyLiBIYXZlIHNhbWUgbmFtZSBhcyBzYXZlZCBwbGFjZVxuICAgIHJldHVybiBwbGFjZXMuZmlsdGVyKHBsYWNlID0+IHtcbiAgICAgICAgaWYgKCFwbGFjZS5pZCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoc2F2ZWRQbGFjZUlkcy5oYXMocGxhY2UuaWQpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBwbGFjZU5hbWUgPSB0eXBlb2YgcGxhY2UuZGlzcGxheU5hbWUgPT09ICdzdHJpbmcnIFxuICAgICAgICAgICAgPyBwbGFjZS5kaXNwbGF5TmFtZS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgICA6IHBsYWNlLmRpc3BsYXlOYW1lLnRleHQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIFxuICAgICAgICBpZiAoc2F2ZWRQbGFjZU5hbWVzLmhhcyhwbGFjZU5hbWUpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbn1cblxuLy8gQWRkIFNhdmVkUGxhY2VzTWFuYWdlciBpbnRlcmZhY2VcbmV4cG9ydCBpbnRlcmZhY2UgU2F2ZWRQbGFjZXNNYW5hZ2VyIHtcbiAgICBwbGFjZXM6IE1hcDxzdHJpbmcsIFBsYWNlPjtcbiAgICBhZGRQbGFjZTogKHBsYWNlOiBQbGFjZSkgPT4gdm9pZDtcbiAgICByZW1vdmVQbGFjZTogKGlkOiBzdHJpbmcpID0+IHZvaWQ7XG4gICAgZ2V0UGxhY2VzOiAoKSA9PiBQbGFjZVtdO1xuICAgIGdldFBsYWNlQnlJZDogKGlkOiBzdHJpbmcpID0+IFBsYWNlIHwgdW5kZWZpbmVkO1xuICAgIGhhc1BsYWNlOiAoaWQ6IHN0cmluZykgPT4gYm9vbGVhbjtcbiAgICB1cGRhdGVQbGFjZTogKHBsYWNlOiBQbGFjZSkgPT4gdm9pZDtcbiAgICB1cGRhdGVQbGFjZXM6ICh1cGRhdGVkUGxhY2VzOiBQbGFjZVtdKSA9PiB2b2lkO1xuICAgIF9wZXJzaXN0OiAoKSA9PiB2b2lkO1xuICAgIF9ub3RpZnlDaGFuZ2U6ICgpID0+IHZvaWQ7XG4gICAgc2VyaWFsaXplOiAoKSA9PiBzdHJpbmc7XG59XG5cbmNvbnN0IFNUT1JBR0VfS0VZID0gJ3NhdmVkX3BsYWNlcyc7XG5cbi8vIFNhdmVkUGxhY2VzTWFuYWdlciBzaW5nbGV0b25cbmNvbnN0IGNyZWF0ZVNhdmVkUGxhY2VzTWFuYWdlciA9ICgpOiBTYXZlZFBsYWNlc01hbmFnZXIgPT4ge1xuICAgIGNvbnN0IHBsYWNlcyA9IG5ldyBNYXA8c3RyaW5nLCBQbGFjZT4oKTtcbiAgICBsZXQgaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICAgIC8vIExvYWQgcGxhY2VzIGZyb20gc2Vzc2lvblN0b3JhZ2VcbiAgICBjb25zdCBsb2FkRnJvbVN0b3JhZ2UgPSAoKSA9PiB7XG4gICAgICAgIGlmICghaW5pdGlhbGl6ZWQgJiYgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTdG9yZWRTZXNzaW9uKCk7XG4gICAgICAgICAgICBpZiAoc2Vzc2lvbj8uc2F2ZWRQbGFjZXMpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciBleGlzdGluZyBwbGFjZXMgYmVmb3JlIGxvYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgcGxhY2VzLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBzZXNzaW9uLnNhdmVkUGxhY2VzLmZvckVhY2gocGxhY2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBsYWNlPy5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlcy5zZXQocGxhY2UuaWQsIHBsYWNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignW3NhdmVkUGxhY2VzTWFuYWdlcl0gRXJyb3IgbG9hZGluZyBwbGFjZXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBwbGFjZXMsXG4gICAgICAgIGFkZFBsYWNlKHBsYWNlOiBQbGFjZSkge1xuICAgICAgICAgICAgbG9hZEZyb21TdG9yYWdlKCk7IC8vIEVuc3VyZSBwbGFjZXMgYXJlIGxvYWRlZFxuICAgICAgICAgICAgaWYgKHBsYWNlPy5pZCkge1xuICAgICAgICAgICAgICAgIHBsYWNlcy5zZXQocGxhY2UuaWQsIHBsYWNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZXJzaXN0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZVBsYWNlKGlkOiBzdHJpbmcpIHtcbiAgICAgICAgICAgIGxvYWRGcm9tU3RvcmFnZSgpOyAvLyBFbnN1cmUgcGxhY2VzIGFyZSBsb2FkZWRcbiAgICAgICAgICAgIHBsYWNlcy5kZWxldGUoaWQpO1xuICAgICAgICAgICAgdGhpcy5fcGVyc2lzdCgpO1xuICAgICAgICAgICAgdGhpcy5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFBsYWNlcygpOiBQbGFjZVtdIHtcbiAgICAgICAgICAgIGxvYWRGcm9tU3RvcmFnZSgpOyAvLyBFbnN1cmUgcGxhY2VzIGFyZSBsb2FkZWRcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHBsYWNlcy52YWx1ZXMoKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFBsYWNlQnlJZChpZDogc3RyaW5nKTogUGxhY2UgfCB1bmRlZmluZWQge1xuICAgICAgICAgICAgbG9hZEZyb21TdG9yYWdlKCk7IC8vIEVuc3VyZSBwbGFjZXMgYXJlIGxvYWRlZFxuICAgICAgICAgICAgcmV0dXJuIHBsYWNlcy5nZXQoaWQpO1xuICAgICAgICB9LFxuICAgICAgICBoYXNQbGFjZShpZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgICAgICBsb2FkRnJvbVN0b3JhZ2UoKTsgLy8gRW5zdXJlIHBsYWNlcyBhcmUgbG9hZGVkXG4gICAgICAgICAgICByZXR1cm4gcGxhY2VzLmhhcyhpZCk7XG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZVBsYWNlKHBsYWNlOiBQbGFjZSkge1xuICAgICAgICAgICAgaWYgKHBsYWNlPy5pZCAmJiBwbGFjZXMuaGFzKHBsYWNlLmlkKSkge1xuICAgICAgICAgICAgICAgIHBsYWNlcy5zZXQocGxhY2UuaWQsIHBsYWNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZXJzaXN0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZVBsYWNlcyh1cGRhdGVkUGxhY2VzOiBQbGFjZVtdKSB7XG4gICAgICAgICAgICBsb2FkRnJvbVN0b3JhZ2UoKTsgLy8gRW5zdXJlIHBsYWNlcyBhcmUgbG9hZGVkXG4gICAgICAgICAgICB1cGRhdGVkUGxhY2VzLmZvckVhY2gocGxhY2UgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwbGFjZT8uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcGxhY2VzLnNldChwbGFjZS5pZCwgcGxhY2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fcGVyc2lzdCgpO1xuICAgICAgICAgICAgdGhpcy5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIF9wZXJzaXN0KCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGxhY2VzQXJyYXkgPSBBcnJheS5mcm9tKHBsYWNlcy52YWx1ZXMoKSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRyYXZlbF9yaXp6X3Nlc3Npb25cbiAgICAgICAgICAgICAgICBjb25zdCBzZXNzaW9uID0gZ2V0U3RvcmVkU2Vzc2lvbigpO1xuICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlc3Npb24uc2F2ZWRQbGFjZXMgPSBwbGFjZXNBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbi5zYXZlZFBsYWNlc0NvdW50ID0gcGxhY2VzLnNpemU7XG4gICAgICAgICAgICAgICAgICAgIHNhZmVTdG9yYWdlT3AoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZT8uc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xuICAgICAgICAgICAgICAgICAgICB9LCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgX25vdGlmeUNoYW5nZSgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zYXZlZFBsYWNlcyA9IEFycmF5LmZyb20odGhpcy5wbGFjZXMudmFsdWVzKCkpO1xuICAgICAgICAgICAgICAgIC8vIERpc3BhdGNoIGV2ZW50IHdpdGggdHlwZSB0byBoYW5kbGUgZGlmZmVyZW50IHVwZGF0ZSBzY2VuYXJpb3NcbiAgICAgICAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ3NhdmVkUGxhY2VzQ2hhbmdlZCcsIHtcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZXM6IEFycmF5LmZyb20odGhpcy5wbGFjZXMudmFsdWVzKCkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6IHRoaXMucGxhY2VzLnNpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndXBkYXRlJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZXJpYWxpemUoKSB7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoQXJyYXkuZnJvbShwbGFjZXMudmFsdWVzKCkpKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuXG5leHBvcnQgY29uc3Qgc2F2ZWRQbGFjZXNNYW5hZ2VyID0gY3JlYXRlU2F2ZWRQbGFjZXNNYW5hZ2VyKCk7XG5cbi8vIEluaXRpYWxpemUgb24gY2xpZW50IHNpZGVcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHNhdmVkUGxhY2VzTWFuYWdlci5wbGFjZXMgPSBuZXcgTWFwPHN0cmluZywgUGxhY2U+KCk7XG59XG5cbi8vIERlY2xhcmUgd2luZG93IGludGVyZmFjZSBmb3Igc2F2ZWQgcGxhY2VzXG5kZWNsYXJlIGdsb2JhbCB7XG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgICAgIHNhdmVkUGxhY2VzOiBQbGFjZVtdO1xuICAgICAgICBhZGRQbGFjZVRvTWFwPzogKHBsYWNlOiB7XG4gICAgICAgICAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgICAgICAgICAgbG9uZ2l0dWRlOiBudW1iZXI7XG4gICAgICAgICAgICB0aXRsZT86IHN0cmluZztcbiAgICAgICAgICAgIHBsYWNlPzogUGxhY2U7XG4gICAgICAgIH0pID0+IHZvaWQ7XG4gICAgICAgIGdldFNhdmVkUGxhY2VzPzogKCkgPT4gUGxhY2VbXTtcbiAgICB9XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBoYW5kbGUgZGlmZmVyZW50IHNlYXJjaCBzdHJhdGVnaWVzXG5hc3luYyBmdW5jdGlvbiBzZWFyY2hXaXRoU3RyYXRlZ3koXG4gICAgc2VhcmNoVGV4dDogc3RyaW5nLFxuICAgIGxvY2F0aW9uOiB7IGxhdGl0dWRlOiBudW1iZXI7IGxvbmdpdHVkZTogbnVtYmVyIH0sXG4gICAgY2l0eU5hbWU6IHN0cmluZyxcbiAgICB1c2VBbHRlcm5hdGVTZWFyY2g6IGJvb2xlYW5cbik6IFByb21pc2U8YW55PiB7XG4gICAgaWYgKCFwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19HT09HTEVfTUFQU19BUElfS0VZKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignR29vZ2xlIE1hcHMgQVBJIGtleSBpcyBtaXNzaW5nJyk7XG4gICAgfVxuXG4gICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ1gtR29vZy1BcGktS2V5JzogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX01BUFNfQVBJX0tFWSxcbiAgICAgICAgJ1gtR29vZy1GaWVsZE1hc2snOiAncGxhY2VzLmlkLHBsYWNlcy5kaXNwbGF5TmFtZSxwbGFjZXMuZm9ybWF0dGVkQWRkcmVzcyxwbGFjZXMubG9jYXRpb24scGxhY2VzLnByaW1hcnlUeXBlLHBsYWNlcy5wcmltYXJ5VHlwZURpc3BsYXlOYW1lLHBsYWNlcy5waG90b3MubmFtZSxwbGFjZXMucGhvdG9zLndpZHRoUHgscGxhY2VzLnBob3Rvcy5oZWlnaHRQeCdcbiAgICB9IGFzIGNvbnN0O1xuXG4gICAgLy8gQ2hvb3NlIHF1ZXJ5IGJhc2VkIG9uIHdoZXRoZXIgd2UncmUgZG9pbmcgYWx0ZXJuYXRlIHNlYXJjaFxuICAgIGNvbnN0IHF1ZXJ5ID0gdXNlQWx0ZXJuYXRlU2VhcmNoIFxuICAgICAgICA/IGBkaWZmZXJlbnQgJHtzZWFyY2hUZXh0fSBpbiAke2NpdHlOYW1lfWBcbiAgICAgICAgOiBgJHtzZWFyY2hUZXh0fSAke2NpdHlOYW1lfWA7XG5cbiAgICBjb25zb2xlLmxvZyhgW3NlYXJjaFdpdGhTdHJhdGVneV0gVXNpbmcgJHt1c2VBbHRlcm5hdGVTZWFyY2ggPyAnYWx0ZXJuYXRlJyA6ICdvcmlnaW5hbCd9IHNlYXJjaDpgLCBxdWVyeSk7XG4gICAgXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdHJ5U2VhcmNoKHF1ZXJ5LCBoZWFkZXJzLCBsb2NhdGlvbik7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gdHJ5U2VhcmNoKFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgaGVhZGVyczogYW55LFxuICAgIGxvY2F0aW9uOiB7IGxhdGl0dWRlOiBudW1iZXI7IGxvbmdpdHVkZTogbnVtYmVyIH1cbik6IFByb21pc2U8YW55PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9wbGFjZXMuZ29vZ2xlYXBpcy5jb20vdjEvcGxhY2VzOnNlYXJjaFRleHQnLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgdGV4dFF1ZXJ5OiBxdWVyeSxcbiAgICAgICAgICAgICAgICBsb2NhdGlvbkJpYXM6IHtcbiAgICAgICAgICAgICAgICAgICAgY2lyY2xlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRpdHVkZTogbG9jYXRpb24ubGF0aXR1ZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9uZ2l0dWRlOiBsb2NhdGlvbi5sb25naXR1ZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDIwMDAwLjBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbWF4UmVzdWx0Q291bnQ6IDFcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1t0cnlTZWFyY2hdIFNlYXJjaCBmYWlsZWQ6Jywge1xuICAgICAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHJlc3BvbnNlLnN0YXR1c1RleHQsXG4gICAgICAgICAgICAgICAgcXVlcnlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBpZiAoIWRhdGEucGxhY2VzPy5bMF0pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbdHJ5U2VhcmNoXSBObyBwbGFjZXMgZm91bmQgZm9yIHF1ZXJ5OicsIHF1ZXJ5KTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1t0cnlTZWFyY2hdIEZvdW5kIG5ldyBwbGFjZTonLCB7XG4gICAgICAgICAgICBpZDogZGF0YS5wbGFjZXNbMF0uaWQsXG4gICAgICAgICAgICBuYW1lOiBkYXRhLnBsYWNlc1swXS5kaXNwbGF5TmFtZT8udGV4dCB8fCBkYXRhLnBsYWNlc1swXS5uYW1lXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB7IHBsYWNlczogW2RhdGEucGxhY2VzWzBdXSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1t0cnlTZWFyY2hdIEVycm9yOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VhcmNoUGxhY2VCeVRleHQoXG4gICAgc2VhcmNoVGV4dDogc3RyaW5nLFxuICAgIGxvY2F0aW9uOiB7IGxhdGl0dWRlOiBudW1iZXI7IGxvbmdpdHVkZTogbnVtYmVyIH0sXG4gICAgZGVzdGluYXRpb246IHN0cmluZ1xuKTogUHJvbWlzZTxQbGFjZSB8IG51bGw+IHtcbiAgICBjb25zb2xlLmxvZygnW3NlYXJjaFBsYWNlQnlUZXh0XSBTdGFydGluZyBzZWFyY2ggd2l0aDonLCB7XG4gICAgICAgIHNlYXJjaFRleHQsXG4gICAgICAgIGxvY2F0aW9uLFxuICAgICAgICBkZXN0aW5hdGlvblxuICAgIH0pO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY2l0eU5hbWUgPSBkZXN0aW5hdGlvbjtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc2VhcmNoV2l0aFN0cmF0ZWd5KHNlYXJjaFRleHQsIGxvY2F0aW9uLCBjaXR5TmFtZSwgZmFsc2UpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFyZXN1bHQ/LnBsYWNlcz8uWzBdKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHBsYWNlID0gdHJhbnNmb3JtUGxhY2VSZXNwb25zZShyZXN1bHQucGxhY2VzWzBdKTtcbiAgICAgICAgaWYgKCFwbGFjZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBwbGFjZSBpcyBhbHJlYWR5IHNhdmVkIHVzaW5nIHNhdmVkUGxhY2VzTWFuYWdlclxuICAgICAgICBjb25zdCBpc0FscmVhZHlTYXZlZCA9IHNhdmVkUGxhY2VzTWFuYWdlci5oYXNQbGFjZShwbGFjZS5pZCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWlzQWxyZWFkeVNhdmVkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnW3NlYXJjaFBsYWNlQnlUZXh0XSBBZGRpbmcgbmV3IHBsYWNlOicsIHtcbiAgICAgICAgICAgICAgICBpZDogcGxhY2UuaWQsXG4gICAgICAgICAgICAgICAgbmFtZTogZ2V0RGlzcGxheU5hbWUocGxhY2UpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNhdmVkUGxhY2VzTWFuYWdlci5hZGRQbGFjZShwbGFjZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBtZXRyaWNzXG4gICAgICAgICAgICBjb25zdCBtZXRyaWNzOiBUcmF2ZWxTZXNzaW9uID0gbWV0cmljc01hbmFnZXIuZ2V0KCk7XG4gICAgICAgICAgICBtZXRyaWNzLnNhdmVkUGxhY2VzQ291bnQgPSBzYXZlZFBsYWNlc01hbmFnZXIucGxhY2VzLnNpemU7XG4gICAgICAgICAgICBtZXRyaWNzTWFuYWdlci51cGRhdGUobWV0cmljcyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnW3NlYXJjaFBsYWNlQnlUZXh0XSBGb3VuZCBwbGFjZTonLCB7XG4gICAgICAgICAgICBpZDogcGxhY2UuaWQsXG4gICAgICAgICAgICBuYW1lOiBnZXREaXNwbGF5TmFtZShwbGFjZSksXG4gICAgICAgICAgICBpc0FscmVhZHlTYXZlZFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcGxhY2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW3NlYXJjaFBsYWNlQnlUZXh0XSBFcnJvciBzZWFyY2hpbmcgZm9yIHBsYWNlOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG4vLyBJbml0aWFsaXplIG1ldHJpY3MgaW4gc3RvcmFnZVxuZnVuY3Rpb24gaW5pdGlhbGl6ZU1ldHJpY3MoKTogVHJhdmVsU2Vzc2lvbiB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZXNzaW9uSWQ6ICcnLFxuICAgICAgICAgICAgc3RhcnRUaW1lOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgbGFzdEFjdGl2ZTogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgIGV4cGlyZXNBdDogRGF0ZS5ub3coKSArIDI0ICogNjAgKiA2MCAqIDEwMDAsXG4gICAgICAgICAgICBkZXN0aW5hdGlvbjogJycsXG4gICAgICAgICAgICBzdGFydERhdGU6ICcnLFxuICAgICAgICAgICAgZW5kRGF0ZTogJycsXG4gICAgICAgICAgICBwcmVmZXJlbmNlczogW10sXG4gICAgICAgICAgICBidWRnZXQ6ICcnLFxuICAgICAgICAgICAgbGFuZ3VhZ2U6ICcnLFxuICAgICAgICAgICAgdHJhbnNwb3J0OiBbXSxcbiAgICAgICAgICAgIHNhdmVkUGxhY2VzOiBbXSxcbiAgICAgICAgICAgIGN1cnJlbnRTdGFnZTogMSxcbiAgICAgICAgICAgIHRvdGFsUHJvbXB0czogMCxcbiAgICAgICAgICAgIHN0YWdlUHJvbXB0czogeyAxOiAwLCAyOiAwLCAzOiAwIH0sXG4gICAgICAgICAgICBzYXZlZFBsYWNlc0NvdW50OiAwLFxuICAgICAgICAgICAgaXNQYWlkOiBmYWxzZSxcbiAgICAgICAgICAgIHBheW1lbnRSZWZlcmVuY2U6ICcnXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGdldFN0b3JlZFNlc3Npb24oKTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgcmV0dXJuIGluaXRpYWxpemVNZXRyaWNzKCk7XG4gICAgfVxuICAgIC8vIEFsd2F5cyBlbnN1cmUgc2F2ZWRQbGFjZXNDb3VudCBtYXRjaGVzIGFjdHVhbCBzYXZlZCBwbGFjZXNcbiAgICBzZXNzaW9uLnNhdmVkUGxhY2VzQ291bnQgPSBzYXZlZFBsYWNlc01hbmFnZXIucGxhY2VzLnNpemU7XG4gICAgcmV0dXJuIHNlc3Npb247XG59XG5cbi8vIFVwZGF0ZSBtZXRyaWNzIGluIHN0b3JhZ2VcbmZ1bmN0aW9uIHVwZGF0ZU1ldHJpY3Moc2Vzc2lvbjogVHJhdmVsU2Vzc2lvbikge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykgcmV0dXJuO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHN0b3JlZFNlc3Npb24gPSBnZXRTdG9yZWRTZXNzaW9uKCk7XG4gICAgICAgIGlmICghc3RvcmVkU2Vzc2lvbikgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIG9ubHkgbWV0cmljcy1yZWxhdGVkIGZpZWxkc1xuICAgICAgICBzdG9yZWRTZXNzaW9uLnRvdGFsUHJvbXB0cyA9IHNlc3Npb24udG90YWxQcm9tcHRzO1xuICAgICAgICBzdG9yZWRTZXNzaW9uLnN0YWdlUHJvbXB0cyA9IHNlc3Npb24uc3RhZ2VQcm9tcHRzO1xuICAgICAgICBzdG9yZWRTZXNzaW9uLnNhdmVkUGxhY2VzQ291bnQgPSBzZXNzaW9uLnNhdmVkUGxhY2VzQ291bnQ7XG4gICAgICAgIFxuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFNFU1NJT05fQ09ORklHLlNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShzdG9yZWRTZXNzaW9uKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW1BsYWNlc10gRXJyb3IgdXBkYXRpbmcgbWV0cmljczonLCBlcnJvcik7XG4gICAgfVxufVxuXG4vLyBFeHBvcnQgdGhlIG1ldHJpY3MgZnVuY3Rpb25zXG5leHBvcnQgY29uc3QgbWV0cmljc01hbmFnZXIgPSB7XG4gICAgZ2V0OiBpbml0aWFsaXplTWV0cmljcyxcbiAgICB1cGRhdGU6IHVwZGF0ZU1ldHJpY3Ncbn07XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byB0cmFuc2Zvcm0gR29vZ2xlIFBsYWNlcyBBUEkgcmVzcG9uc2UgdG8gb3VyIFBsYWNlIHR5cGVcbmZ1bmN0aW9uIHRyYW5zZm9ybVBsYWNlUmVzcG9uc2UocGxhY2U6IEdvb2dsZVBsYWNlUmVzcG9uc2UpOiBQbGFjZSB8IG51bGwge1xuICAgIGlmICghcGxhY2UpIHJldHVybiBudWxsO1xuXG4gICAgY29uc29sZS5sb2coJ1t0cmFuc2Zvcm1QbGFjZVJlc3BvbnNlXSBJbnB1dCBwbGFjZTonLCB7XG4gICAgICAgIGlkOiBwbGFjZS5pZCxcbiAgICAgICAgcGhvdG9zOiBwbGFjZS5waG90b3M/Lm1hcChwID0+ICh7IG5hbWU6IHAubmFtZSB9KSksXG4gICAgICAgIHByaW1hcnlUeXBlRGlzcGxheU5hbWU6IHBsYWNlLnByaW1hcnlUeXBlRGlzcGxheU5hbWVcbiAgICB9KTtcblxuICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gcGxhY2UuZGlzcGxheU5hbWU/LnRleHQgXG4gICAgICAgID8geyB0ZXh0OiBwbGFjZS5kaXNwbGF5TmFtZS50ZXh0LCBsYW5ndWFnZUNvZGU6IHBsYWNlLmRpc3BsYXlOYW1lLmxhbmd1YWdlQ29kZSB8fCAnZW4nIH1cbiAgICAgICAgOiBwbGFjZS5uYW1lIHx8ICcnO1xuXG4gICAgLy8gRW5zdXJlIHBob3RvcyBhcnJheSBpcyBwcm9wZXJseSBmb3JtYXR0ZWRcbiAgICBjb25zdCBwaG90b3MgPSAocGxhY2UucGhvdG9zIHx8IFtdKVxuICAgICAgICAuZmlsdGVyKChwaG90byk6IHBob3RvIGlzIE5vbk51bGxhYmxlPHR5cGVvZiBwaG90bz4gPT4gXG4gICAgICAgICAgICBCb29sZWFuKHBob3RvICYmIHBob3RvLm5hbWUpXG4gICAgICAgIClcbiAgICAgICAgLm1hcChwaG90byA9PiAoe1xuICAgICAgICAgICAgbmFtZTogcGhvdG8ubmFtZSxcbiAgICAgICAgICAgIHdpZHRoUHg6IHBob3RvLndpZHRoUHgsXG4gICAgICAgICAgICBoZWlnaHRQeDogcGhvdG8uaGVpZ2h0UHgsXG4gICAgICAgICAgICBhdXRob3JBdHRyaWJ1dGlvbnM6IHBob3RvLmF1dGhvckF0dHJpYnV0aW9uc1xuICAgICAgICB9KSk7XG5cbiAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHtcbiAgICAgICAgaWQ6IHBsYWNlLmlkLFxuICAgICAgICBuYW1lOiBwbGFjZS5uYW1lLFxuICAgICAgICBkaXNwbGF5TmFtZSxcbiAgICAgICAgcHJpbWFyeVR5cGU6IHBsYWNlLnByaW1hcnlUeXBlIHx8ICdwbGFjZScsXG4gICAgICAgIHBob3RvcyxcbiAgICAgICAgZm9ybWF0dGVkQWRkcmVzczogcGxhY2UuZm9ybWF0dGVkQWRkcmVzcyxcbiAgICAgICAgbG9jYXRpb246IHBsYWNlLmxvY2F0aW9uLFxuICAgICAgICBwcmltYXJ5VHlwZURpc3BsYXlOYW1lOiBwbGFjZS5wcmltYXJ5VHlwZURpc3BsYXlOYW1lIFxuICAgICAgICAgICAgPyB7IHRleHQ6IHBsYWNlLnByaW1hcnlUeXBlRGlzcGxheU5hbWUudGV4dCwgbGFuZ3VhZ2VDb2RlOiBwbGFjZS5wcmltYXJ5VHlwZURpc3BsYXlOYW1lLmxhbmd1YWdlQ29kZSB8fCAnZW4nIH1cbiAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgfTtcblxuICAgIGNvbnNvbGUubG9nKCdbdHJhbnNmb3JtUGxhY2VSZXNwb25zZV0gVHJhbnNmb3JtZWQgcGxhY2U6Jywge1xuICAgICAgICBpZDogdHJhbnNmb3JtZWQuaWQsXG4gICAgICAgIHBob3RvczogdHJhbnNmb3JtZWQucGhvdG9zLm1hcChwID0+ICh7IG5hbWU6IHAubmFtZSB9KSksXG4gICAgICAgIHByaW1hcnlUeXBlRGlzcGxheU5hbWU6IHRyYW5zZm9ybWVkLnByaW1hcnlUeXBlRGlzcGxheU5hbWVcbiAgICB9KTtcblxuICAgIHJldHVybiB0cmFuc2Zvcm1lZDtcbn1cblxuZXhwb3J0IGNvbnN0IHNlYXJjaE11bHRpcGxlUGxhY2VzQnlUZXh0ID0gYXN5bmMgKFxuICAgIHNlYXJjaFRleHQ6IHN0cmluZyxcbiAgICBsb2NhdGlvbjogeyBsYXRpdHVkZTogbnVtYmVyOyBsb25naXR1ZGU6IG51bWJlciB9LFxuICAgIG1heFJlc3VsdHM6IG51bWJlciA9IDVcbik6IFByb21pc2U8UGxhY2VbXT4gPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICghcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX01BUFNfQVBJX0tFWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignR29vZ2xlIE1hcHMgQVBJIGtleSBpcyBtaXNzaW5nJyk7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnRXhlY3V0aW5nIHNlYXJjaE11bHRpcGxlUGxhY2VzQnlUZXh0IHdpdGggcGFyYW1zOicsIHtcbiAgICAgICAgICAgIHNlYXJjaFRleHQsXG4gICAgICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgICAgIG1heFJlc3VsdHNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdEJvZHkgPSB7XG4gICAgICAgICAgICB0ZXh0UXVlcnk6IHNlYXJjaFRleHQsXG4gICAgICAgICAgICBsb2NhdGlvbkJpYXM6IHtcbiAgICAgICAgICAgICAgICBjaXJjbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXRpdHVkZTogbG9jYXRpb24ubGF0aXR1ZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsb25naXR1ZGU6IGxvY2F0aW9uLmxvbmdpdHVkZVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDIwMDAwLjAgLy8gMjBrbSByYWRpdXNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWF4UmVzdWx0Q291bnQ6IG1heFJlc3VsdHNcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdYLUdvb2ctQXBpLUtleSc6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0dPT0dMRV9NQVBTX0FQSV9LRVksXG4gICAgICAgICAgICAnWC1Hb29nLUZpZWxkTWFzayc6ICdwbGFjZXMuaWQscGxhY2VzLmRpc3BsYXlOYW1lLHBsYWNlcy5mb3JtYXR0ZWRBZGRyZXNzLHBsYWNlcy5sb2NhdGlvbixwbGFjZXMucHJpbWFyeVR5cGUscGxhY2VzLnByaW1hcnlUeXBlRGlzcGxheU5hbWUscGxhY2VzLnBob3Rvcy5uYW1lLHBsYWNlcy5waG90b3Mud2lkdGhQeCxwbGFjZXMucGhvdG9zLmhlaWdodFB4J1xuICAgICAgICB9IGFzIGNvbnN0O1xuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vcGxhY2VzLmdvb2dsZWFwaXMuY29tL3YxL3BsYWNlczpzZWFyY2hUZXh0Jywge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzZWFyY2ggcGxhY2VzOicsIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvckRhdGFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghZGF0YS5wbGFjZXMgfHwgIUFycmF5LmlzQXJyYXkoZGF0YS5wbGFjZXMpIHx8IGRhdGEucGxhY2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIHBsYWNlcyBmb3VuZCBmb3IgdGV4dCBzZWFyY2g6Jywgc2VhcmNoVGV4dCk7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGF0YS5wbGFjZXMubWFwKChwbGFjZTogYW55KSA9PiAoe1xuICAgICAgICAgICAgaWQ6IHBsYWNlLmlkLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IHBsYWNlLmRpc3BsYXlOYW1lPy50ZXh0ID8ge1xuICAgICAgICAgICAgICAgIHRleHQ6IHBsYWNlLmRpc3BsYXlOYW1lLnRleHQsXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2VDb2RlOiBwbGFjZS5kaXNwbGF5TmFtZS5sYW5ndWFnZUNvZGUgfHwgJ2VuJ1xuICAgICAgICAgICAgfSA6IHBsYWNlLmRpc3BsYXlOYW1lLFxuICAgICAgICAgICAgcHJpbWFyeVR5cGU6IHBsYWNlLnByaW1hcnlUeXBlIHx8ICdwbGFjZScsXG4gICAgICAgICAgICBwaG90b3M6IHBsYWNlLnBob3Rvcz8ubWFwKChwaG90bzogYW55KSA9PiAoeyBcbiAgICAgICAgICAgICAgICBuYW1lOiBwaG90by5uYW1lLFxuICAgICAgICAgICAgICAgIHdpZHRoUHg6IHBob3RvLndpZHRoUHgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0UHg6IHBob3RvLmhlaWdodFB4XG4gICAgICAgICAgICB9KSkgfHwgW10sXG4gICAgICAgICAgICBmb3JtYXR0ZWRBZGRyZXNzOiBwbGFjZS5mb3JtYXR0ZWRBZGRyZXNzLFxuICAgICAgICAgICAgbG9jYXRpb246IHBsYWNlLmxvY2F0aW9uLFxuICAgICAgICAgICAgcHJpbWFyeVR5cGVEaXNwbGF5TmFtZTogcGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZSA/IHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBwbGFjZS5wcmltYXJ5VHlwZURpc3BsYXlOYW1lLnRleHQsXG4gICAgICAgICAgICAgICAgbGFuZ3VhZ2VDb2RlOiBwbGFjZS5wcmltYXJ5VHlwZURpc3BsYXlOYW1lLmxhbmd1YWdlQ29kZSB8fCAnZW4nXG4gICAgICAgICAgICB9IDogdW5kZWZpbmVkXG4gICAgICAgIH0pKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZWFyY2hpbmcgZm9yIHBsYWNlczonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG59O1xuXG4vLyBGZXRjaCBwbGFjZXMgZnJvbSBHb29nbGUgUGxhY2VzIEFQSVxuZXhwb3J0IGNvbnN0IGZldGNoUGxhY2VzID0gYXN5bmMgKFxuICAgIGxhdGl0dWRlOiBudW1iZXIsXG4gICAgbG9uZ2l0dWRlOiBudW1iZXIsXG4gICAgcHJlZmVyZW5jZXM/OiBUcmF2ZWxQcmVmZXJlbmNlW10sXG4gICAgbWF4UmVzdWx0czogbnVtYmVyID0gNSxcbiAgICBwbGFjZVR5cGVzPzogc3RyaW5nW11cbik6IFByb21pc2U8UGxhY2VbXT4gPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICghcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX01BUFNfQVBJX0tFWSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignR29vZ2xlIE1hcHMgQVBJIGtleSBpcyBtaXNzaW5nJyk7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmcm9tUHJlZmVyZW5jZXMgPSAhIXByZWZlcmVuY2VzICYmIHByZWZlcmVuY2VzLmxlbmd0aCA+IDA7XG4gICAgICAgIGNvbnN0IGZyb21QbGFjZVR5cGVzID0gISFwbGFjZVR5cGVzICYmIHBsYWNlVHlwZXMubGVuZ3RoID4gMDtcbiAgICAgICAgXG4gICAgICAgIGlmICghZnJvbVByZWZlcmVuY2VzICYmICFmcm9tUGxhY2VUeXBlcykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gcHJlZmVyZW5jZXMgb3IgcGxhY2UgdHlwZXMgcHJvdmlkZWQnKTtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVzZSBwcmVmZXJlbmNlcyBpZiBwcm92aWRlZCwgb3RoZXJ3aXNlIHVzZSBwbGFjZVR5cGVzLCBvdGhlcndpc2UgdXNlIGRlZmF1bHRzXG4gICAgICAgIGxldCBpbmNsdWRlZFR5cGVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBpZiAoZnJvbVByZWZlcmVuY2VzKSB7XG4gICAgICAgICAgICBpbmNsdWRlZFR5cGVzID0gZ2V0UGxhY2VUeXBlc0Zyb21QcmVmZXJlbmNlcyhwcmVmZXJlbmNlcyEpO1xuICAgICAgICB9IGVsc2UgaWYgKGZyb21QbGFjZVR5cGVzKSB7XG4gICAgICAgICAgICBpbmNsdWRlZFR5cGVzID0gcGxhY2VUeXBlcyE7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZygnRXhlY3V0aW5nIGZldGNocGxhY2VzIHdpdGggcGFyYW1zOicsIHtcbiAgICAgICAgICAgIGxhdGl0dWRlLFxuICAgICAgICAgICAgbG9uZ2l0dWRlLFxuICAgICAgICAgICAgaW5jbHVkZWRUeXBlcyxcbiAgICAgICAgICAgIG1heFJlc3VsdHMsXG4gICAgICAgICAgICBmcm9tUHJlZmVyZW5jZXM6ICEhcHJlZmVyZW5jZXM/Lmxlbmd0aCxcbiAgICAgICAgICAgIGZyb21QbGFjZVR5cGVzOiAhIXBsYWNlVHlwZXM/Lmxlbmd0aFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBGaXJzdCB0cnkgbmVhcmJ5IHNlYXJjaFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdEJvZHkgPSB7XG4gICAgICAgICAgICAgICAgaW5jbHVkZWRUeXBlcyxcbiAgICAgICAgICAgICAgICBtYXhSZXN1bHRDb3VudDogbWF4UmVzdWx0cyxcbiAgICAgICAgICAgICAgICBsb2NhdGlvblJlc3RyaWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGNpcmNsZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VudGVyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0aXR1ZGU6IGxhdGl0dWRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvbmdpdHVkZTogbG9uZ2l0dWRlXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmFkaXVzOiAyMDAwMC4wIC8vIDIwa20gcmFkaXVzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ1gtR29vZy1BcGktS2V5JzogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfR09PR0xFX01BUFNfQVBJX0tFWSxcbiAgICAgICAgICAgICAgICAnWC1Hb29nLUZpZWxkTWFzayc6ICdwbGFjZXMuaWQscGxhY2VzLmRpc3BsYXlOYW1lLHBsYWNlcy5mb3JtYXR0ZWRBZGRyZXNzLHBsYWNlcy5sb2NhdGlvbixwbGFjZXMucHJpbWFyeVR5cGUscGxhY2VzLnByaW1hcnlUeXBlRGlzcGxheU5hbWUscGxhY2VzLnBob3Rvcy5uYW1lLHBsYWNlcy5waG90b3Mud2lkdGhQeCxwbGFjZXMucGhvdG9zLmhlaWdodFB4J1xuICAgICAgICAgICAgfSBhcyBjb25zdDtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9wbGFjZXMuZ29vZ2xlYXBpcy5jb20vdjEvcGxhY2VzOnNlYXJjaE5lYXJieScsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucGxhY2VzICYmIEFycmF5LmlzQXJyYXkoZGF0YS5wbGFjZXMpICYmIGRhdGEucGxhY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEucGxhY2VzLm1hcCgocGxhY2U6IGFueSkgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBwbGFjZS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBwbGFjZS5kaXNwbGF5TmFtZT8udGV4dCA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBwbGFjZS5kaXNwbGF5TmFtZS50ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlQ29kZTogcGxhY2UuZGlzcGxheU5hbWUubGFuZ3VhZ2VDb2RlIHx8ICdlbidcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gOiBwbGFjZS5kaXNwbGF5TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnlUeXBlOiBwbGFjZS5wcmltYXJ5VHlwZSB8fCAncGxhY2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGhvdG9zOiBwbGFjZS5waG90b3M/Lm1hcCgocGhvdG86IGFueSkgPT4gKHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcGhvdG8ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aFB4OiBwaG90by53aWR0aFB4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodFB4OiBwaG90by5oZWlnaHRQeFxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpIHx8IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkQWRkcmVzczogcGxhY2UuZm9ybWF0dGVkQWRkcmVzcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiBwbGFjZS5sb2NhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1hcnlUeXBlRGlzcGxheU5hbWU6IHBsYWNlLnByaW1hcnlUeXBlRGlzcGxheU5hbWUgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogcGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZS50ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlQ29kZTogcGxhY2UucHJpbWFyeVR5cGVEaXNwbGF5TmFtZS5sYW5ndWFnZUNvZGUgfHwgJ2VuJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggcGxhY2VzOicsIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiByZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvckRhdGFcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gbmVhcmJ5IHNlYXJjaDonLCBlcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBuZWFyYnkgc2VhcmNoIGZhaWxzLCB0cnkgdGV4dCBzZWFyY2ggYXMgZmFsbGJhY2tcbiAgICAgICAgY29uc29sZS5sb2coJ0ZhbGxpbmcgYmFjayB0byB0ZXh0IHNlYXJjaC4uLicpO1xuICAgICAgICBjb25zdCBzZWFyY2hRdWVyeSA9IGZyb21QbGFjZVR5cGVzID8gcGxhY2VUeXBlcyFbMF0gOiBwcmVmZXJlbmNlcyFbMF07XG4gICAgICAgIHJldHVybiBhd2FpdCBzZWFyY2hNdWx0aXBsZVBsYWNlc0J5VGV4dChzZWFyY2hRdWVyeSwgeyBsYXRpdHVkZSwgbG9uZ2l0dWRlIH0sIG1heFJlc3VsdHMpO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcGxhY2VzOicsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbn07Il0sIm5hbWVzIjpbIlRyYXZlbFByZWZlcmVuY2UiLCJnZXRTdG9yZWRTZXNzaW9uIiwiU0VTU0lPTl9DT05GSUciLCJzYWZlU3RvcmFnZU9wIiwic3RvcmFnZSIsInByZWZlcmVuY2VUb1BsYWNlVHlwZXMiLCJDdWx0dXJlIiwiTmF0dXJlIiwiRm9vZCIsIlJlbGF4YXRpb24iLCJBZHZlbnR1cmUiLCJTaG9wcGluZyIsImdldFBsYWNlVHlwZXNGcm9tUHJlZmVyZW5jZXMiLCJwcmVmZXJlbmNlcyIsInVzZWRUeXBlcyIsIlNldCIsInJlc3VsdFR5cGVzIiwiZm9yRWFjaCIsInByZWYiLCJhdmFpbGFibGVUeXBlcyIsImZpbHRlciIsInR5cGUiLCJoYXMiLCJudW1UeXBlcyIsIk1hdGgiLCJtaW4iLCJmbG9vciIsInJhbmRvbSIsImxlbmd0aCIsInNlbGVjdGVkVHlwZXMiLCJzb3J0Iiwic2xpY2UiLCJwdXNoIiwiYWRkIiwiZXJyb3IiLCJjb25zb2xlIiwiZm9ybWF0UHJpbWFyeVR5cGUiLCJzcGxpdCIsIm1hcCIsIndvcmQiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsImpvaW4iLCJnZXREaXNwbGF5TmFtZSIsInBsYWNlIiwiZGlzcGxheU5hbWUiLCJ0ZXh0IiwibmFtZSIsImZpbHRlclVuaXF1ZVBsYWNlcyIsInBsYWNlcyIsIkFycmF5IiwiaXNBcnJheSIsInNhdmVkUGxhY2VzIiwic2F2ZWRQbGFjZXNNYW5hZ2VyIiwiZ2V0UGxhY2VzIiwic2F2ZWRQbGFjZUlkcyIsImlkIiwic2F2ZWRQbGFjZU5hbWVzIiwidG9Mb3dlckNhc2UiLCJwbGFjZU5hbWUiLCJTVE9SQUdFX0tFWSIsImNyZWF0ZVNhdmVkUGxhY2VzTWFuYWdlciIsIk1hcCIsImluaXRpYWxpemVkIiwibG9hZEZyb21TdG9yYWdlIiwic2Vzc2lvbiIsImNsZWFyIiwic2V0IiwiYWRkUGxhY2UiLCJfcGVyc2lzdCIsIl9ub3RpZnlDaGFuZ2UiLCJyZW1vdmVQbGFjZSIsImRlbGV0ZSIsImZyb20iLCJ2YWx1ZXMiLCJnZXRQbGFjZUJ5SWQiLCJnZXQiLCJoYXNQbGFjZSIsInVwZGF0ZVBsYWNlIiwidXBkYXRlUGxhY2VzIiwidXBkYXRlZFBsYWNlcyIsInBsYWNlc0FycmF5Iiwic2F2ZWRQbGFjZXNDb3VudCIsInNpemUiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsInVuZGVmaW5lZCIsIndpbmRvdyIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImNvdW50Iiwic2VyaWFsaXplIiwic2VhcmNoV2l0aFN0cmF0ZWd5Iiwic2VhcmNoVGV4dCIsImxvY2F0aW9uIiwiY2l0eU5hbWUiLCJ1c2VBbHRlcm5hdGVTZWFyY2giLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfR09PR0xFX01BUFNfQVBJX0tFWSIsIkVycm9yIiwiaGVhZGVycyIsInF1ZXJ5IiwibG9nIiwicmVzdWx0IiwidHJ5U2VhcmNoIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImJvZHkiLCJ0ZXh0UXVlcnkiLCJsb2NhdGlvbkJpYXMiLCJjaXJjbGUiLCJjZW50ZXIiLCJsYXRpdHVkZSIsImxvbmdpdHVkZSIsInJhZGl1cyIsIm1heFJlc3VsdENvdW50Iiwib2siLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiZGF0YSIsImpzb24iLCJzZWFyY2hQbGFjZUJ5VGV4dCIsImRlc3RpbmF0aW9uIiwidHJhbnNmb3JtUGxhY2VSZXNwb25zZSIsImlzQWxyZWFkeVNhdmVkIiwibWV0cmljcyIsIm1ldHJpY3NNYW5hZ2VyIiwidXBkYXRlIiwiaW5pdGlhbGl6ZU1ldHJpY3MiLCJzZXNzaW9uSWQiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93IiwibGFzdEFjdGl2ZSIsImV4cGlyZXNBdCIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJidWRnZXQiLCJsYW5ndWFnZSIsInRyYW5zcG9ydCIsImN1cnJlbnRTdGFnZSIsInRvdGFsUHJvbXB0cyIsInN0YWdlUHJvbXB0cyIsImlzUGFpZCIsInBheW1lbnRSZWZlcmVuY2UiLCJ1cGRhdGVNZXRyaWNzIiwic3RvcmVkU2Vzc2lvbiIsInNlc3Npb25TdG9yYWdlIiwicGhvdG9zIiwicCIsInByaW1hcnlUeXBlRGlzcGxheU5hbWUiLCJsYW5ndWFnZUNvZGUiLCJwaG90byIsIkJvb2xlYW4iLCJ3aWR0aFB4IiwiaGVpZ2h0UHgiLCJhdXRob3JBdHRyaWJ1dGlvbnMiLCJ0cmFuc2Zvcm1lZCIsInByaW1hcnlUeXBlIiwiZm9ybWF0dGVkQWRkcmVzcyIsInNlYXJjaE11bHRpcGxlUGxhY2VzQnlUZXh0IiwibWF4UmVzdWx0cyIsInJlcXVlc3RCb2R5IiwiZXJyb3JEYXRhIiwiZmV0Y2hQbGFjZXMiLCJwbGFjZVR5cGVzIiwiZnJvbVByZWZlcmVuY2VzIiwiZnJvbVBsYWNlVHlwZXMiLCJpbmNsdWRlZFR5cGVzIiwibG9jYXRpb25SZXN0cmljdGlvbiIsInNlYXJjaFF1ZXJ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./utils/places-utils.ts\n");

/***/ }),

/***/ "(api)/./utils/session-manager.ts":
/*!**********************************!*\
  !*** ./utils/session-manager.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SESSION_CONFIG: () => (/* binding */ SESSION_CONFIG),\n/* harmony export */   checkInputLimits: () => (/* binding */ checkInputLimits),\n/* harmony export */   checkSession: () => (/* binding */ checkSession),\n/* harmony export */   checkSessionValidity: () => (/* binding */ checkSessionValidity),\n/* harmony export */   checkSessionWithWarning: () => (/* binding */ checkSessionWithWarning),\n/* harmony export */   clearPaymentReference: () => (/* binding */ clearPaymentReference),\n/* harmony export */   clearSession: () => (/* binding */ clearSession),\n/* harmony export */   generateSessionId: () => (/* binding */ generateSessionId),\n/* harmony export */   getPaymentReference: () => (/* binding */ getPaymentReference),\n/* harmony export */   getPaymentReferenceId: () => (/* binding */ getPaymentReferenceId),\n/* harmony export */   getPaymentStatus: () => (/* binding */ getPaymentStatus),\n/* harmony export */   getStorage: () => (/* binding */ getStorage),\n/* harmony export */   getStoredMetrics: () => (/* binding */ getStoredMetrics),\n/* harmony export */   getStoredSession: () => (/* binding */ getStoredSession),\n/* harmony export */   handleSessionExpiry: () => (/* binding */ handleSessionExpiry),\n/* harmony export */   initializeSession: () => (/* binding */ initializeSession),\n/* harmony export */   safeStorageOp: () => (/* binding */ safeStorageOp),\n/* harmony export */   setPaymentReference: () => (/* binding */ setPaymentReference),\n/* harmony export */   setPaymentReferenceId: () => (/* binding */ setPaymentReferenceId),\n/* harmony export */   setPaymentStatus: () => (/* binding */ setPaymentStatus),\n/* harmony export */   storage: () => (/* binding */ storage),\n/* harmony export */   updateLastActive: () => (/* binding */ updateLastActive),\n/* harmony export */   updateSessionLocation: () => (/* binding */ updateSessionLocation),\n/* harmony export */   updateStoredMetrics: () => (/* binding */ updateStoredMetrics)\n/* harmony export */ });\n/* harmony import */ var _managers_stage_manager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../managers/stage-manager */ \"(api)/./managers/stage-manager.ts\");\n\nconst SESSION_CONFIG = {\n    STORAGE_KEY: \"travel_rizz_session\",\n    ABSOLUTE_TIMEOUT: 24 * 60 * 60 * 1000,\n    INACTIVITY_TIMEOUT: 2 * 60 * 60 * 1000,\n    WARNING_BEFORE_TIMEOUT: 5 * 60 * 1000,\n    MAX_TOTAL_INPUTS: 15,\n    PAYMENT_REF_KEY: \"payment_reference_id\"\n};\n// Safe storage access\nconst getStorage = ()=>{\n    if (false) {}\n    return null;\n};\nconst storage = getStorage();\n// Helper function to safely access storage\nconst safeStorageOp = (operation, defaultValue)=>{\n    try {\n        if (!storage) return defaultValue;\n        return operation();\n    } catch (error) {\n        console.error(\"[Session] Storage operation failed:\", error);\n        return defaultValue;\n    }\n};\nfunction initializeSession() {\n    const now = Date.now();\n    // Try to get existing session first\n    const existingSession = safeStorageOp(()=>{\n        const stored = storage?.getItem(SESSION_CONFIG.STORAGE_KEY);\n        return stored ? JSON.parse(stored) : null;\n    }, null);\n    if (existingSession) {\n        // Update both lastActive and expiresAt\n        existingSession.lastActive = now;\n        existingSession.expiresAt = now + SESSION_CONFIG.ABSOLUTE_TIMEOUT;\n        // Ensure all stages are initialized\n        existingSession.stagePrompts = existingSession.stagePrompts || {\n            1: 0,\n            2: 0,\n            3: 0,\n            4: 0,\n            5: 0\n        };\n        safeStorageOp(()=>{\n            storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(existingSession));\n        }, undefined);\n        return existingSession;\n    }\n    // Create new session if none exists\n    const sessionId = generateSessionId();\n    const session = {\n        // Session info\n        sessionId,\n        startTime: now,\n        lastActive: now,\n        expiresAt: now + SESSION_CONFIG.ABSOLUTE_TIMEOUT,\n        // Travel details\n        destination: \"\",\n        startDate: \"\",\n        endDate: \"\",\n        preferences: [],\n        budget: \"\",\n        language: \"\",\n        transport: [],\n        location: {\n            latitude: 0,\n            longitude: 0\n        },\n        // Places\n        savedPlaces: [],\n        currentStage: 1,\n        // Metrics\n        totalPrompts: 0,\n        stagePrompts: {\n            1: 0,\n            2: 0,\n            3: 0,\n            4: 0,\n            5: 0\n        },\n        savedPlacesCount: 0,\n        // Payment\n        isPaid: false,\n        paymentReference: `session_${sessionId}`\n    };\n    safeStorageOp(()=>{\n        storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(session));\n    }, undefined);\n    return session;\n}\nfunction getStoredSession() {\n    return safeStorageOp(()=>{\n        // console.log('[Session] Attempting to get stored session');\n        const storedData = storage?.getItem(SESSION_CONFIG.STORAGE_KEY);\n        if (!storedData) {\n            console.log(\"[Session] No stored session data found\");\n            return null;\n        }\n        try {\n            const session = JSON.parse(storedData);\n            // console.log('[Session] Successfully parsed session:', {\n            //   sessionId: session.sessionId,\n            //   destination: session.destination,\n            //   startTime: new Date(session.startTime).toISOString(),\n            //   lastActive: new Date(session.lastActive).toISOString(),\n            //   expiresAt: new Date(session.expiresAt).toISOString()\n            // });\n            return session;\n        } catch (error) {\n            console.error(\"[Session] Failed to parse session data:\", error);\n            return null;\n        }\n    }, null);\n}\nfunction getStoredMetrics() {\n    return safeStorageOp(()=>{\n        const session = getStoredSession();\n        if (!session) return null;\n        return {\n            interaction: {\n                totalPrompts: session.totalPrompts,\n                stagePrompts: session.stagePrompts,\n                lastActive: session.lastActive\n            },\n            places: {\n                savedCount: session.savedPlacesCount\n            },\n            payment: {\n                status: session.isPaid,\n                reference: session.paymentReference,\n                timestamp: session.paymentTimestamp\n            },\n            parameters: {\n                destination: session.destination,\n                dates: {\n                    start: session.startDate,\n                    end: session.endDate\n                },\n                preferences: session.preferences,\n                budget: session.budget,\n                language: session.language,\n                transport: session.transport\n            }\n        };\n    }, null);\n}\nfunction updateStoredMetrics(currentStage, incrementPrompt = false, incrementSavedPlaces = false) {\n    return safeStorageOp(()=>{\n        const session = getStoredSession() || initializeSession();\n        if (incrementPrompt) {\n            // Initialize stagePrompts with all stages if it doesn't exist\n            if (!session.stagePrompts) {\n                session.stagePrompts = {\n                    1: 0,\n                    2: 0,\n                    3: 0,\n                    4: 0,\n                    5: 0\n                };\n            }\n            // Ensure all stages exist\n            for(let stage = 1; stage <= 5; stage++){\n                if (typeof session.stagePrompts[stage] !== \"number\") {\n                    session.stagePrompts[stage] = 0;\n                }\n            }\n            session.totalPrompts = (session.totalPrompts || 0) + 1;\n            session.stagePrompts[currentStage] = (session.stagePrompts[currentStage] || 0) + 1;\n        }\n        if (incrementSavedPlaces) {\n            session.savedPlacesCount = (session.savedPlacesCount || 0) + 1;\n        }\n        storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(session));\n        return session;\n    }, null) || initializeSession();\n}\nfunction checkInputLimits(currentStage) {\n    return safeStorageOp(()=>{\n        const session = getStoredSession() || initializeSession();\n        const stagePrompts = session.stagePrompts || {\n            1: 0,\n            2: 0,\n            3: 0\n        };\n        const totalPrompts = session.totalPrompts || 0;\n        return {\n            withinStageLimit: currentStage === 3 ? (stagePrompts[currentStage] || 0) < _managers_stage_manager__WEBPACK_IMPORTED_MODULE_0__.STAGE_LIMITS[3].maxPrompts : true,\n            withinTotalLimit: currentStage === 3 ? totalPrompts < SESSION_CONFIG.MAX_TOTAL_INPUTS : true,\n            stageInputCount: stagePrompts[currentStage] || 0,\n            totalInputCount: totalPrompts\n        };\n    }, {\n        withinStageLimit: true,\n        withinTotalLimit: true,\n        stageInputCount: 0,\n        totalInputCount: 0\n    });\n}\n// Payment related functions\nfunction setPaymentStatus(isPaid) {\n    safeStorageOp(()=>{\n        const session = getStoredSession() || initializeSession();\n        session.isPaid = isPaid;\n        session.paymentTimestamp = isPaid ? Date.now() : undefined;\n        storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(session));\n    }, undefined);\n}\nfunction getPaymentStatus() {\n    return safeStorageOp(()=>{\n        const session = getStoredSession();\n        return session?.isPaid || false;\n    }, false);\n}\nfunction setPaymentReference(reference) {\n    safeStorageOp(()=>{\n        const session = getStoredSession() || initializeSession();\n        session.paymentReference = reference;\n        storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(session));\n    }, undefined);\n}\nfunction getPaymentReference() {\n    return safeStorageOp(()=>{\n        const session = getStoredSession();\n        return session?.paymentReference;\n    }, undefined);\n}\nfunction clearPaymentReference() {\n    safeStorageOp(()=>{\n        const session = getStoredSession() || initializeSession();\n        session.paymentReference = \"\";\n        storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(session));\n    }, undefined);\n}\nfunction getPaymentReferenceId() {\n    return safeStorageOp(()=>{\n        const stored = storage?.getItem(SESSION_CONFIG.PAYMENT_REF_KEY);\n        return stored || null;\n    }, null);\n}\nfunction setPaymentReferenceId(referenceId) {\n    safeStorageOp(()=>{\n        storage?.setItem(SESSION_CONFIG.PAYMENT_REF_KEY, referenceId);\n        console.log(\"[Session] Stored payment reference ID:\", referenceId);\n    }, undefined);\n}\nfunction checkSession() {\n    return safeStorageOp(()=>{\n        const currentSession = storage?.getItem(SESSION_CONFIG.STORAGE_KEY);\n        if (!currentSession) {\n            const newSession = Date.now().toString();\n            storage?.setItem(SESSION_CONFIG.STORAGE_KEY, newSession);\n            return false;\n        }\n        return true;\n    }, false);\n}\n// Add warning mechanism\nfunction checkSessionWithWarning() {\n    return safeStorageOp(()=>{\n        const session = getStoredSession();\n        if (!session) {\n            return {\n                isValid: false,\n                shouldWarn: false\n            };\n        }\n        const now = Date.now();\n        const timeLeft = session.expiresAt - now;\n        const shouldWarn = timeLeft <= SESSION_CONFIG.WARNING_BEFORE_TIMEOUT;\n        const isValid = timeLeft > 0;\n        return {\n            isValid,\n            shouldWarn\n        };\n    }, {\n        isValid: false,\n        shouldWarn: false\n    });\n}\nfunction checkSessionValidity() {\n    return safeStorageOp(()=>{\n        console.log(\"[Session] Checking session validity\");\n        const storedData = storage?.getItem(SESSION_CONFIG.STORAGE_KEY);\n        if (!storedData) {\n            console.log(\"[Session] No session found during validity check\");\n            return false;\n        }\n        let session;\n        try {\n            session = JSON.parse(storedData);\n            console.log(\"[Session] Parsed session for validity check:\", {\n                sessionId: session.sessionId,\n                destination: session.destination,\n                startTime: new Date(session.startTime).toISOString(),\n                lastActive: new Date(session.lastActive).toISOString(),\n                expiresAt: new Date(session.expiresAt).toISOString()\n            });\n        } catch (error) {\n            console.error(\"[Session] Failed to parse session during validity check:\", error);\n            return false;\n        }\n        const now = Date.now();\n        console.log(\"[Session] Validity check times:\", {\n            now: new Date(now).toISOString(),\n            expiresAt: new Date(session.expiresAt).toISOString(),\n            lastActive: new Date(session.lastActive).toISOString(),\n            timeTillExpiry: session.expiresAt - now,\n            inactiveTime: now - session.lastActive,\n            absoluteTimeout: SESSION_CONFIG.ABSOLUTE_TIMEOUT,\n            inactivityTimeout: SESSION_CONFIG.INACTIVITY_TIMEOUT\n        });\n        // Check absolute timeout\n        if (now >= session.expiresAt) {\n            console.log(\"[Session] Session expired due to absolute timeout. Times:\", {\n                now,\n                expiresAt: session.expiresAt,\n                diff: now - session.expiresAt\n            });\n            clearSession();\n            return false;\n        }\n        // Check inactivity timeout\n        const inactiveTime = now - session.lastActive;\n        if (inactiveTime >= SESSION_CONFIG.INACTIVITY_TIMEOUT) {\n            console.log(\"[Session] Session expired due to inactivity. Times:\", {\n                now,\n                lastActive: session.lastActive,\n                inactiveTime,\n                inactivityTimeout: SESSION_CONFIG.INACTIVITY_TIMEOUT\n            });\n            clearSession();\n            return false;\n        }\n        // Only update lastActive if it's been more than 1 minute\n        if (inactiveTime > 60000) {\n            console.log(\"[Session] Updating lastActive time in validity check\");\n            session.lastActive = now;\n            storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(session));\n        }\n        return true;\n    }, false);\n}\n// Session expiry handler\nfunction handleSessionExpiry() {\n    safeStorageOp(()=>{\n        // Don't handle expiry if we're already on the landing page\n        if (window.location.pathname === \"/\" || window.location.pathname === \"\") {\n            return;\n        }\n        // Save current state if needed\n        const currentState = {\n            messages: window.getSavedPlaces?.() || [],\n            lastUrl: window.location.pathname\n        };\n        storage?.setItem(\"expiredSessionState\", JSON.stringify(currentState));\n        // Clear session\n        clearSession();\n        // Only redirect if we're not already on the landing page\n        const currentUrl = new URL(window.location.href);\n        if (!currentUrl.searchParams.has(\"return\")) {\n            window.location.href = `/?return=${encodeURIComponent(currentState.lastUrl)}`;\n        }\n    }, undefined);\n}\nfunction clearSession() {\n    console.log(\"[Session] Clearing session storage\");\n    safeStorageOp(()=>{\n        storage?.removeItem(SESSION_CONFIG.STORAGE_KEY);\n    }, undefined);\n}\nfunction updateLastActive() {\n    return safeStorageOp(()=>{\n        const storedData = storage?.getItem(SESSION_CONFIG.STORAGE_KEY);\n        if (!storedData) {\n            console.log(\"[Session] No session to update lastActive\");\n            return false;\n        }\n        try {\n            const session = JSON.parse(storedData);\n            session.lastActive = Date.now();\n            storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(session));\n            console.log(\"[Session] Successfully updated lastActive\");\n            return true;\n        } catch (error) {\n            console.error(\"[Session] Failed to update lastActive:\", error);\n            return false;\n        }\n    }, false);\n}\nfunction generateSessionId() {\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n// Update session with location\nfunction updateSessionLocation(location) {\n    const session = getStoredSession();\n    if (!session) return;\n    session.location = location;\n    safeStorageOp(()=>{\n        storage?.setItem(SESSION_CONFIG.STORAGE_KEY, JSON.stringify(session));\n    }, undefined);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztJQUNaekMsY0FBYztRQUNaRCxTQUFTc0csV0FBV2hILGVBQWVDLFdBQVc7SUFDaEQsR0FBRzRCO0FBQ0w7QUFFTyxTQUFTb0Y7SUFDZCxPQUFPdEcsY0FBYztRQUNuQixNQUFNd0MsYUFBYXpDLFNBQVNXLFFBQVFyQixlQUFlQyxXQUFXO1FBQzlELElBQUksQ0FBQ2tELFlBQVk7WUFDZnBDLFFBQVFxQyxHQUFHLENBQUM7WUFDWixPQUFPO1FBQ1Q7UUFFQSxJQUFJO1lBQ0YsTUFBTXBCLFVBQVVWLEtBQUtDLEtBQUssQ0FBQzRCO1lBQzNCbkIsUUFBUVIsVUFBVSxHQUFHTixLQUFLRCxHQUFHO1lBQzdCUCxTQUFTaUIsUUFBUTNCLGVBQWVDLFdBQVcsRUFBRXFCLEtBQUtNLFNBQVMsQ0FBQ0k7WUFDNURqQixRQUFRcUMsR0FBRyxDQUFDO1lBQ1osT0FBTztRQUNULEVBQUUsT0FBT3RDLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLDBDQUEwQ0E7WUFDeEQsT0FBTztRQUNUO0lBQ0YsR0FBRztBQUNMO0FBRU8sU0FBU2lCO0lBQ2QsT0FBTyxDQUFDLEVBQUViLEtBQUtELEdBQUcsR0FBRyxDQUFDLEVBQUVpRyxLQUFLQyxNQUFNLEdBQUc1QixRQUFRLENBQUMsSUFBSTZCLE1BQU0sQ0FBQyxHQUFHLEdBQUcsQ0FBQztBQUNuRTtBQUVBLCtCQUErQjtBQUN4QixTQUFTQyxzQkFBc0I1RSxRQUFpRDtJQUNyRixNQUFNVCxVQUFVa0I7SUFDaEIsSUFBSSxDQUFDbEIsU0FBUztJQUVkQSxRQUFRUyxRQUFRLEdBQUdBO0lBQ25COUIsY0FBYztRQUNaRCxTQUFTaUIsUUFBUTNCLGVBQWVDLFdBQVcsRUFBRXFCLEtBQUtNLFNBQVMsQ0FBQ0k7SUFDOUQsR0FBR0g7QUFDTCIsInNvdXJjZXMiOlsid2VicGFjazovL3RyYXZlbC1yaXp6Ly4vdXRpbHMvc2Vzc2lvbi1tYW5hZ2VyLnRzPzEzM2YiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHJhdmVsU2Vzc2lvbiB9IGZyb20gJy4uL21hbmFnZXJzL3R5cGVzJztcbmltcG9ydCB7IFNUQUdFX0xJTUlUUyB9IGZyb20gJy4uL21hbmFnZXJzL3N0YWdlLW1hbmFnZXInO1xuXG5leHBvcnQgY29uc3QgU0VTU0lPTl9DT05GSUcgPSB7XG4gIFNUT1JBR0VfS0VZOiAndHJhdmVsX3Jpenpfc2Vzc2lvbicsXG4gIEFCU09MVVRFX1RJTUVPVVQ6IDI0ICogNjAgKiA2MCAqIDEwMDAsIC8vIDI0IGhvdXJzXG4gIElOQUNUSVZJVFlfVElNRU9VVDogMiAqIDYwICogNjAgKiAxMDAwLCAvLyAyIGhvdXJzXG4gIFdBUk5JTkdfQkVGT1JFX1RJTUVPVVQ6IDUgKiA2MCAqIDEwMDAsIC8vIDUgbWludXRlcyB3YXJuaW5nXG4gIE1BWF9UT1RBTF9JTlBVVFM6IDE1LFxuICBQQVlNRU5UX1JFRl9LRVk6ICdwYXltZW50X3JlZmVyZW5jZV9pZCdcbn07XG5cbi8vIFNhZmUgc3RvcmFnZSBhY2Nlc3NcbmV4cG9ydCBjb25zdCBnZXRTdG9yYWdlID0gKCkgPT4ge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gd2luZG93LnNlc3Npb25TdG9yYWdlO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcblxuZXhwb3J0IGNvbnN0IHN0b3JhZ2UgPSBnZXRTdG9yYWdlKCk7XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBzYWZlbHkgYWNjZXNzIHN0b3JhZ2VcbmV4cG9ydCBjb25zdCBzYWZlU3RvcmFnZU9wID0gPFQ+KG9wZXJhdGlvbjogKCkgPT4gVCwgZGVmYXVsdFZhbHVlOiBUKTogVCA9PiB7XG4gIHRyeSB7XG4gICAgaWYgKCFzdG9yYWdlKSByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICAgIHJldHVybiBvcGVyYXRpb24oKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdbU2Vzc2lvbl0gU3RvcmFnZSBvcGVyYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVNlc3Npb24oKTogVHJhdmVsU2Vzc2lvbiB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIFxuICAvLyBUcnkgdG8gZ2V0IGV4aXN0aW5nIHNlc3Npb24gZmlyc3RcbiAgY29uc3QgZXhpc3RpbmdTZXNzaW9uID0gc2FmZVN0b3JhZ2VPcCgoKSA9PiB7XG4gICAgY29uc3Qgc3RvcmVkID0gc3RvcmFnZT8uZ2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSk7XG4gICAgcmV0dXJuIHN0b3JlZCA/IEpTT04ucGFyc2Uoc3RvcmVkKSBhcyBUcmF2ZWxTZXNzaW9uIDogbnVsbDtcbiAgfSwgbnVsbCk7XG5cbiAgaWYgKGV4aXN0aW5nU2Vzc2lvbikge1xuICAgIC8vIFVwZGF0ZSBib3RoIGxhc3RBY3RpdmUgYW5kIGV4cGlyZXNBdFxuICAgIGV4aXN0aW5nU2Vzc2lvbi5sYXN0QWN0aXZlID0gbm93O1xuICAgIGV4aXN0aW5nU2Vzc2lvbi5leHBpcmVzQXQgPSBub3cgKyBTRVNTSU9OX0NPTkZJRy5BQlNPTFVURV9USU1FT1VUO1xuICAgIC8vIEVuc3VyZSBhbGwgc3RhZ2VzIGFyZSBpbml0aWFsaXplZFxuICAgIGV4aXN0aW5nU2Vzc2lvbi5zdGFnZVByb21wdHMgPSBleGlzdGluZ1Nlc3Npb24uc3RhZ2VQcm9tcHRzIHx8IHsgMTogMCwgMjogMCwgMzogMCwgNDogMCwgNTogMCB9O1xuICAgIHNhZmVTdG9yYWdlT3AoKCkgPT4ge1xuICAgICAgc3RvcmFnZT8uc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoZXhpc3RpbmdTZXNzaW9uKSk7XG4gICAgfSwgdW5kZWZpbmVkKTtcbiAgICByZXR1cm4gZXhpc3RpbmdTZXNzaW9uO1xuICB9XG5cbiAgLy8gQ3JlYXRlIG5ldyBzZXNzaW9uIGlmIG5vbmUgZXhpc3RzXG4gIGNvbnN0IHNlc3Npb25JZCA9IGdlbmVyYXRlU2Vzc2lvbklkKCk7XG4gIGNvbnN0IHNlc3Npb246IFRyYXZlbFNlc3Npb24gPSB7XG4gICAgLy8gU2Vzc2lvbiBpbmZvXG4gICAgc2Vzc2lvbklkLFxuICAgIHN0YXJ0VGltZTogbm93LFxuICAgIGxhc3RBY3RpdmU6IG5vdyxcbiAgICBleHBpcmVzQXQ6IG5vdyArIFNFU1NJT05fQ09ORklHLkFCU09MVVRFX1RJTUVPVVQsXG5cbiAgICAvLyBUcmF2ZWwgZGV0YWlsc1xuICAgIGRlc3RpbmF0aW9uOiAnJyxcbiAgICBzdGFydERhdGU6ICcnLFxuICAgIGVuZERhdGU6ICcnLFxuICAgIHByZWZlcmVuY2VzOiBbXSxcbiAgICBidWRnZXQ6ICcnLFxuICAgIGxhbmd1YWdlOiAnJyxcbiAgICB0cmFuc3BvcnQ6IFtdLFxuICAgIGxvY2F0aW9uOiB7XG4gICAgICBsYXRpdHVkZTogMCxcbiAgICAgIGxvbmdpdHVkZTogMFxuICAgIH0sXG5cbiAgICAvLyBQbGFjZXNcbiAgICBzYXZlZFBsYWNlczogW10sXG4gICAgY3VycmVudFN0YWdlOiAxLFxuXG4gICAgLy8gTWV0cmljc1xuICAgIHRvdGFsUHJvbXB0czogMCxcbiAgICBzdGFnZVByb21wdHM6IHsgMTogMCwgMjogMCwgMzogMCwgNDogMCwgNTogMCB9LFxuICAgIHNhdmVkUGxhY2VzQ291bnQ6IDAsXG5cbiAgICAvLyBQYXltZW50XG4gICAgaXNQYWlkOiBmYWxzZSxcbiAgICBwYXltZW50UmVmZXJlbmNlOiBgc2Vzc2lvbl8ke3Nlc3Npb25JZH1gXG4gIH07XG5cbiAgc2FmZVN0b3JhZ2VPcCgoKSA9PiB7XG4gICAgc3RvcmFnZT8uc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xuICB9LCB1bmRlZmluZWQpO1xuICByZXR1cm4gc2Vzc2lvbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFN0b3JlZFNlc3Npb24oKTogVHJhdmVsU2Vzc2lvbiB8IG51bGwge1xuICByZXR1cm4gc2FmZVN0b3JhZ2VPcCgoKSA9PiB7XG4gICAgLy8gY29uc29sZS5sb2coJ1tTZXNzaW9uXSBBdHRlbXB0aW5nIHRvIGdldCBzdG9yZWQgc2Vzc2lvbicpO1xuICAgIGNvbnN0IHN0b3JlZERhdGEgPSBzdG9yYWdlPy5nZXRJdGVtKFNFU1NJT05fQ09ORklHLlNUT1JBR0VfS0VZKTtcbiAgICBpZiAoIXN0b3JlZERhdGEpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbU2Vzc2lvbl0gTm8gc3RvcmVkIHNlc3Npb24gZGF0YSBmb3VuZCcpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlc3Npb24gPSBKU09OLnBhcnNlKHN0b3JlZERhdGEpO1xuICAgICAgLy8gY29uc29sZS5sb2coJ1tTZXNzaW9uXSBTdWNjZXNzZnVsbHkgcGFyc2VkIHNlc3Npb246Jywge1xuICAgICAgLy8gICBzZXNzaW9uSWQ6IHNlc3Npb24uc2Vzc2lvbklkLFxuICAgICAgLy8gICBkZXN0aW5hdGlvbjogc2Vzc2lvbi5kZXN0aW5hdGlvbixcbiAgICAgIC8vICAgc3RhcnRUaW1lOiBuZXcgRGF0ZShzZXNzaW9uLnN0YXJ0VGltZSkudG9JU09TdHJpbmcoKSxcbiAgICAgIC8vICAgbGFzdEFjdGl2ZTogbmV3IERhdGUoc2Vzc2lvbi5sYXN0QWN0aXZlKS50b0lTT1N0cmluZygpLFxuICAgICAgLy8gICBleHBpcmVzQXQ6IG5ldyBEYXRlKHNlc3Npb24uZXhwaXJlc0F0KS50b0lTT1N0cmluZygpXG4gICAgICAvLyB9KTtcbiAgICAgIHJldHVybiBzZXNzaW9uO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU2Vzc2lvbl0gRmFpbGVkIHRvIHBhcnNlIHNlc3Npb24gZGF0YTonLCBlcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH0sIG51bGwpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RvcmVkTWV0cmljcygpIHtcbiAgcmV0dXJuIHNhZmVTdG9yYWdlT3AoKCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTdG9yZWRTZXNzaW9uKCk7XG4gICAgaWYgKCFzZXNzaW9uKSByZXR1cm4gbnVsbDtcblxuICAgIHJldHVybiB7XG4gICAgICBpbnRlcmFjdGlvbjoge1xuICAgICAgICB0b3RhbFByb21wdHM6IHNlc3Npb24udG90YWxQcm9tcHRzLFxuICAgICAgICBzdGFnZVByb21wdHM6IHNlc3Npb24uc3RhZ2VQcm9tcHRzLFxuICAgICAgICBsYXN0QWN0aXZlOiBzZXNzaW9uLmxhc3RBY3RpdmVcbiAgICAgIH0sXG4gICAgICBwbGFjZXM6IHtcbiAgICAgICAgc2F2ZWRDb3VudDogc2Vzc2lvbi5zYXZlZFBsYWNlc0NvdW50XG4gICAgICB9LFxuICAgICAgcGF5bWVudDoge1xuICAgICAgICBzdGF0dXM6IHNlc3Npb24uaXNQYWlkLFxuICAgICAgICByZWZlcmVuY2U6IHNlc3Npb24ucGF5bWVudFJlZmVyZW5jZSxcbiAgICAgICAgdGltZXN0YW1wOiBzZXNzaW9uLnBheW1lbnRUaW1lc3RhbXBcbiAgICAgIH0sXG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgIGRlc3RpbmF0aW9uOiBzZXNzaW9uLmRlc3RpbmF0aW9uLFxuICAgICAgICBkYXRlczoge1xuICAgICAgICAgIHN0YXJ0OiBzZXNzaW9uLnN0YXJ0RGF0ZSxcbiAgICAgICAgICBlbmQ6IHNlc3Npb24uZW5kRGF0ZVxuICAgICAgICB9LFxuICAgICAgICBwcmVmZXJlbmNlczogc2Vzc2lvbi5wcmVmZXJlbmNlcyxcbiAgICAgICAgYnVkZ2V0OiBzZXNzaW9uLmJ1ZGdldCxcbiAgICAgICAgbGFuZ3VhZ2U6IHNlc3Npb24ubGFuZ3VhZ2UsXG4gICAgICAgIHRyYW5zcG9ydDogc2Vzc2lvbi50cmFuc3BvcnRcbiAgICAgIH1cbiAgICB9O1xuICB9LCBudWxsKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVN0b3JlZE1ldHJpY3MoXG4gIGN1cnJlbnRTdGFnZTogbnVtYmVyLFxuICBpbmNyZW1lbnRQcm9tcHQ6IGJvb2xlYW4gPSBmYWxzZSxcbiAgaW5jcmVtZW50U2F2ZWRQbGFjZXM6IGJvb2xlYW4gPSBmYWxzZVxuKTogVHJhdmVsU2Vzc2lvbiB7XG4gIHJldHVybiBzYWZlU3RvcmFnZU9wKCgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gZ2V0U3RvcmVkU2Vzc2lvbigpIHx8IGluaXRpYWxpemVTZXNzaW9uKCk7XG5cbiAgICBpZiAoaW5jcmVtZW50UHJvbXB0KSB7XG4gICAgICAvLyBJbml0aWFsaXplIHN0YWdlUHJvbXB0cyB3aXRoIGFsbCBzdGFnZXMgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgaWYgKCFzZXNzaW9uLnN0YWdlUHJvbXB0cykge1xuICAgICAgICBzZXNzaW9uLnN0YWdlUHJvbXB0cyA9IHsgMTogMCwgMjogMCwgMzogMCwgNDogMCwgNTogMCB9O1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBFbnN1cmUgYWxsIHN0YWdlcyBleGlzdFxuICAgICAgZm9yIChsZXQgc3RhZ2UgPSAxOyBzdGFnZSA8PSA1OyBzdGFnZSsrKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2Vzc2lvbi5zdGFnZVByb21wdHNbc3RhZ2VdICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgIHNlc3Npb24uc3RhZ2VQcm9tcHRzW3N0YWdlXSA9IDA7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgc2Vzc2lvbi50b3RhbFByb21wdHMgPSAoc2Vzc2lvbi50b3RhbFByb21wdHMgfHwgMCkgKyAxO1xuICAgICAgc2Vzc2lvbi5zdGFnZVByb21wdHNbY3VycmVudFN0YWdlXSA9IChzZXNzaW9uLnN0YWdlUHJvbXB0c1tjdXJyZW50U3RhZ2VdIHx8IDApICsgMTtcbiAgICB9XG5cbiAgICBpZiAoaW5jcmVtZW50U2F2ZWRQbGFjZXMpIHtcbiAgICAgIHNlc3Npb24uc2F2ZWRQbGFjZXNDb3VudCA9IChzZXNzaW9uLnNhdmVkUGxhY2VzQ291bnQgfHwgMCkgKyAxO1xuICAgIH1cblxuICAgIHN0b3JhZ2U/LnNldEl0ZW0oU0VTU0lPTl9DT05GSUcuU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KHNlc3Npb24pKTtcbiAgICByZXR1cm4gc2Vzc2lvbjtcbiAgfSwgbnVsbCkgfHwgaW5pdGlhbGl6ZVNlc3Npb24oKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrSW5wdXRMaW1pdHMoY3VycmVudFN0YWdlOiBudW1iZXIpOiB7XG4gIHdpdGhpblN0YWdlTGltaXQ6IGJvb2xlYW47XG4gIHdpdGhpblRvdGFsTGltaXQ6IGJvb2xlYW47XG4gIHN0YWdlSW5wdXRDb3VudDogbnVtYmVyO1xuICB0b3RhbElucHV0Q291bnQ6IG51bWJlcjtcbn0ge1xuICByZXR1cm4gc2FmZVN0b3JhZ2VPcCgoKSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGdldFN0b3JlZFNlc3Npb24oKSB8fCBpbml0aWFsaXplU2Vzc2lvbigpO1xuICAgIGNvbnN0IHN0YWdlUHJvbXB0cyA9IHNlc3Npb24uc3RhZ2VQcm9tcHRzIHx8IHsgMTogMCwgMjogMCwgMzogMCB9O1xuICAgIGNvbnN0IHRvdGFsUHJvbXB0cyA9IHNlc3Npb24udG90YWxQcm9tcHRzIHx8IDA7XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2l0aGluU3RhZ2VMaW1pdDogY3VycmVudFN0YWdlID09PSAzXG4gICAgICAgID8gKHN0YWdlUHJvbXB0c1tjdXJyZW50U3RhZ2VdIHx8IDApIDwgU1RBR0VfTElNSVRTWzNdLm1heFByb21wdHNcbiAgICAgICAgOiB0cnVlLFxuICAgICAgd2l0aGluVG90YWxMaW1pdDogY3VycmVudFN0YWdlID09PSAzXG4gICAgICAgID8gdG90YWxQcm9tcHRzIDwgU0VTU0lPTl9DT05GSUcuTUFYX1RPVEFMX0lOUFVUU1xuICAgICAgICA6IHRydWUsXG4gICAgICBzdGFnZUlucHV0Q291bnQ6IHN0YWdlUHJvbXB0c1tjdXJyZW50U3RhZ2VdIHx8IDAsXG4gICAgICB0b3RhbElucHV0Q291bnQ6IHRvdGFsUHJvbXB0c1xuICAgIH07XG4gIH0sIHtcbiAgICB3aXRoaW5TdGFnZUxpbWl0OiB0cnVlLFxuICAgIHdpdGhpblRvdGFsTGltaXQ6IHRydWUsXG4gICAgc3RhZ2VJbnB1dENvdW50OiAwLFxuICAgIHRvdGFsSW5wdXRDb3VudDogMFxuICB9KTtcbn1cblxuLy8gUGF5bWVudCByZWxhdGVkIGZ1bmN0aW9uc1xuZXhwb3J0IGZ1bmN0aW9uIHNldFBheW1lbnRTdGF0dXMoaXNQYWlkOiBib29sZWFuKTogdm9pZCB7XG4gIHNhZmVTdG9yYWdlT3AoKCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTdG9yZWRTZXNzaW9uKCkgfHwgaW5pdGlhbGl6ZVNlc3Npb24oKTtcbiAgICBzZXNzaW9uLmlzUGFpZCA9IGlzUGFpZDtcbiAgICBzZXNzaW9uLnBheW1lbnRUaW1lc3RhbXAgPSBpc1BhaWQgPyBEYXRlLm5vdygpIDogdW5kZWZpbmVkO1xuICAgIHN0b3JhZ2U/LnNldEl0ZW0oU0VTU0lPTl9DT05GSUcuU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KHNlc3Npb24pKTtcbiAgfSwgdW5kZWZpbmVkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBheW1lbnRTdGF0dXMoKTogYm9vbGVhbiB7XG4gIHJldHVybiBzYWZlU3RvcmFnZU9wKCgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gZ2V0U3RvcmVkU2Vzc2lvbigpO1xuICAgIHJldHVybiBzZXNzaW9uPy5pc1BhaWQgfHwgZmFsc2U7XG4gIH0sIGZhbHNlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFBheW1lbnRSZWZlcmVuY2UocmVmZXJlbmNlOiBzdHJpbmcpOiB2b2lkIHtcbiAgc2FmZVN0b3JhZ2VPcCgoKSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGdldFN0b3JlZFNlc3Npb24oKSB8fCBpbml0aWFsaXplU2Vzc2lvbigpO1xuICAgIHNlc3Npb24ucGF5bWVudFJlZmVyZW5jZSA9IHJlZmVyZW5jZTtcbiAgICBzdG9yYWdlPy5zZXRJdGVtKFNFU1NJT05fQ09ORklHLlNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShzZXNzaW9uKSk7XG4gIH0sIHVuZGVmaW5lZCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQYXltZW50UmVmZXJlbmNlKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIHJldHVybiBzYWZlU3RvcmFnZU9wKCgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gZ2V0U3RvcmVkU2Vzc2lvbigpO1xuICAgIHJldHVybiBzZXNzaW9uPy5wYXltZW50UmVmZXJlbmNlO1xuICB9LCB1bmRlZmluZWQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJQYXltZW50UmVmZXJlbmNlKCk6IHZvaWQge1xuICBzYWZlU3RvcmFnZU9wKCgpID0+IHtcbiAgICBjb25zdCBzZXNzaW9uID0gZ2V0U3RvcmVkU2Vzc2lvbigpIHx8IGluaXRpYWxpemVTZXNzaW9uKCk7XG4gICAgc2Vzc2lvbi5wYXltZW50UmVmZXJlbmNlID0gJyc7XG4gICAgc3RvcmFnZT8uc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xuICB9LCB1bmRlZmluZWQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGF5bWVudFJlZmVyZW5jZUlkKCk6IHN0cmluZyB8IG51bGwge1xuICByZXR1cm4gc2FmZVN0b3JhZ2VPcCgoKSA9PiB7XG4gICAgY29uc3Qgc3RvcmVkID0gc3RvcmFnZT8uZ2V0SXRlbShTRVNTSU9OX0NPTkZJRy5QQVlNRU5UX1JFRl9LRVkpO1xuICAgIHJldHVybiBzdG9yZWQgfHwgbnVsbDtcbiAgfSwgbnVsbCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRQYXltZW50UmVmZXJlbmNlSWQocmVmZXJlbmNlSWQ6IHN0cmluZykge1xuICBzYWZlU3RvcmFnZU9wKCgpID0+IHtcbiAgICBzdG9yYWdlPy5zZXRJdGVtKFNFU1NJT05fQ09ORklHLlBBWU1FTlRfUkVGX0tFWSwgcmVmZXJlbmNlSWQpO1xuICAgIGNvbnNvbGUubG9nKCdbU2Vzc2lvbl0gU3RvcmVkIHBheW1lbnQgcmVmZXJlbmNlIElEOicsIHJlZmVyZW5jZUlkKTtcbiAgfSwgdW5kZWZpbmVkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrU2Vzc2lvbigpOiBib29sZWFuIHtcbiAgcmV0dXJuIHNhZmVTdG9yYWdlT3AoKCkgPT4ge1xuICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gc3RvcmFnZT8uZ2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSk7XG5cbiAgICBpZiAoIWN1cnJlbnRTZXNzaW9uKSB7XG4gICAgICBjb25zdCBuZXdTZXNzaW9uID0gRGF0ZS5ub3coKS50b1N0cmluZygpO1xuICAgICAgc3RvcmFnZT8uc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSwgbmV3U2Vzc2lvbik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9LCBmYWxzZSk7XG59XG5cbi8vIEFkZCB3YXJuaW5nIG1lY2hhbmlzbVxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrU2Vzc2lvbldpdGhXYXJuaW5nKCk6IHsgaXNWYWxpZDogYm9vbGVhbjsgc2hvdWxkV2FybjogYm9vbGVhbiB9IHtcbiAgcmV0dXJuIHNhZmVTdG9yYWdlT3AoKCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBnZXRTdG9yZWRTZXNzaW9uKCk7XG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgc2hvdWxkV2FybjogZmFsc2UgfTtcbiAgICB9XG5cbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHRpbWVMZWZ0ID0gc2Vzc2lvbi5leHBpcmVzQXQgLSBub3c7XG4gICAgY29uc3Qgc2hvdWxkV2FybiA9IHRpbWVMZWZ0IDw9IFNFU1NJT05fQ09ORklHLldBUk5JTkdfQkVGT1JFX1RJTUVPVVQ7XG4gICAgY29uc3QgaXNWYWxpZCA9IHRpbWVMZWZ0ID4gMDtcblxuICAgIHJldHVybiB7IGlzVmFsaWQsIHNob3VsZFdhcm4gfTtcbiAgfSwgeyBpc1ZhbGlkOiBmYWxzZSwgc2hvdWxkV2FybjogZmFsc2UgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja1Nlc3Npb25WYWxpZGl0eSgpOiBib29sZWFuIHtcbiAgcmV0dXJuIHNhZmVTdG9yYWdlT3AoKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdbU2Vzc2lvbl0gQ2hlY2tpbmcgc2Vzc2lvbiB2YWxpZGl0eScpO1xuICAgIGNvbnN0IHN0b3JlZERhdGEgPSBzdG9yYWdlPy5nZXRJdGVtKFNFU1NJT05fQ09ORklHLlNUT1JBR0VfS0VZKTtcbiAgICBpZiAoIXN0b3JlZERhdGEpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbU2Vzc2lvbl0gTm8gc2Vzc2lvbiBmb3VuZCBkdXJpbmcgdmFsaWRpdHkgY2hlY2snKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBsZXQgc2Vzc2lvbjtcbiAgICB0cnkge1xuICAgICAgc2Vzc2lvbiA9IEpTT04ucGFyc2Uoc3RvcmVkRGF0YSk7XG4gICAgICBjb25zb2xlLmxvZygnW1Nlc3Npb25dIFBhcnNlZCBzZXNzaW9uIGZvciB2YWxpZGl0eSBjaGVjazonLCB7XG4gICAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5zZXNzaW9uSWQsXG4gICAgICAgIGRlc3RpbmF0aW9uOiBzZXNzaW9uLmRlc3RpbmF0aW9uLFxuICAgICAgICBzdGFydFRpbWU6IG5ldyBEYXRlKHNlc3Npb24uc3RhcnRUaW1lKS50b0lTT1N0cmluZygpLFxuICAgICAgICBsYXN0QWN0aXZlOiBuZXcgRGF0ZShzZXNzaW9uLmxhc3RBY3RpdmUpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGV4cGlyZXNBdDogbmV3IERhdGUoc2Vzc2lvbi5leHBpcmVzQXQpLnRvSVNPU3RyaW5nKClcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbU2Vzc2lvbl0gRmFpbGVkIHRvIHBhcnNlIHNlc3Npb24gZHVyaW5nIHZhbGlkaXR5IGNoZWNrOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnNvbGUubG9nKCdbU2Vzc2lvbl0gVmFsaWRpdHkgY2hlY2sgdGltZXM6Jywge1xuICAgICAgbm93OiBuZXcgRGF0ZShub3cpLnRvSVNPU3RyaW5nKCksXG4gICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKHNlc3Npb24uZXhwaXJlc0F0KS50b0lTT1N0cmluZygpLFxuICAgICAgbGFzdEFjdGl2ZTogbmV3IERhdGUoc2Vzc2lvbi5sYXN0QWN0aXZlKS50b0lTT1N0cmluZygpLFxuICAgICAgdGltZVRpbGxFeHBpcnk6IHNlc3Npb24uZXhwaXJlc0F0IC0gbm93LFxuICAgICAgaW5hY3RpdmVUaW1lOiBub3cgLSBzZXNzaW9uLmxhc3RBY3RpdmUsXG4gICAgICBhYnNvbHV0ZVRpbWVvdXQ6IFNFU1NJT05fQ09ORklHLkFCU09MVVRFX1RJTUVPVVQsXG4gICAgICBpbmFjdGl2aXR5VGltZW91dDogU0VTU0lPTl9DT05GSUcuSU5BQ1RJVklUWV9USU1FT1VUXG4gICAgfSk7XG5cbiAgICAvLyBDaGVjayBhYnNvbHV0ZSB0aW1lb3V0XG4gICAgaWYgKG5vdyA+PSBzZXNzaW9uLmV4cGlyZXNBdCkge1xuICAgICAgY29uc29sZS5sb2coJ1tTZXNzaW9uXSBTZXNzaW9uIGV4cGlyZWQgZHVlIHRvIGFic29sdXRlIHRpbWVvdXQuIFRpbWVzOicsIHtcbiAgICAgICAgbm93LFxuICAgICAgICBleHBpcmVzQXQ6IHNlc3Npb24uZXhwaXJlc0F0LFxuICAgICAgICBkaWZmOiBub3cgLSBzZXNzaW9uLmV4cGlyZXNBdFxuICAgICAgfSk7XG4gICAgICBjbGVhclNlc3Npb24oKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpbmFjdGl2aXR5IHRpbWVvdXRcbiAgICBjb25zdCBpbmFjdGl2ZVRpbWUgPSBub3cgLSBzZXNzaW9uLmxhc3RBY3RpdmU7XG4gICAgaWYgKGluYWN0aXZlVGltZSA+PSBTRVNTSU9OX0NPTkZJRy5JTkFDVElWSVRZX1RJTUVPVVQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdbU2Vzc2lvbl0gU2Vzc2lvbiBleHBpcmVkIGR1ZSB0byBpbmFjdGl2aXR5LiBUaW1lczonLCB7XG4gICAgICAgIG5vdyxcbiAgICAgICAgbGFzdEFjdGl2ZTogc2Vzc2lvbi5sYXN0QWN0aXZlLFxuICAgICAgICBpbmFjdGl2ZVRpbWUsXG4gICAgICAgIGluYWN0aXZpdHlUaW1lb3V0OiBTRVNTSU9OX0NPTkZJRy5JTkFDVElWSVRZX1RJTUVPVVRcbiAgICAgIH0pO1xuICAgICAgY2xlYXJTZXNzaW9uKCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gT25seSB1cGRhdGUgbGFzdEFjdGl2ZSBpZiBpdCdzIGJlZW4gbW9yZSB0aGFuIDEgbWludXRlXG4gICAgaWYgKGluYWN0aXZlVGltZSA+IDYwMDAwKSB7IC8vIDEgbWludXRlXG4gICAgICBjb25zb2xlLmxvZygnW1Nlc3Npb25dIFVwZGF0aW5nIGxhc3RBY3RpdmUgdGltZSBpbiB2YWxpZGl0eSBjaGVjaycpO1xuICAgICAgc2Vzc2lvbi5sYXN0QWN0aXZlID0gbm93O1xuICAgICAgc3RvcmFnZT8uc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSwgZmFsc2UpO1xufVxuXG4vLyBTZXNzaW9uIGV4cGlyeSBoYW5kbGVyXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlU2Vzc2lvbkV4cGlyeSgpIHtcbiAgc2FmZVN0b3JhZ2VPcCgoKSA9PiB7XG4gICAgLy8gRG9uJ3QgaGFuZGxlIGV4cGlyeSBpZiB3ZSdyZSBhbHJlYWR5IG9uIHRoZSBsYW5kaW5nIHBhZ2VcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnLycgfHwgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFNhdmUgY3VycmVudCBzdGF0ZSBpZiBuZWVkZWRcbiAgICBjb25zdCBjdXJyZW50U3RhdGUgPSB7XG4gICAgICBtZXNzYWdlczogd2luZG93LmdldFNhdmVkUGxhY2VzPy4oKSB8fCBbXSxcbiAgICAgIGxhc3RVcmw6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZVxuICAgIH07XG4gICAgc3RvcmFnZT8uc2V0SXRlbSgnZXhwaXJlZFNlc3Npb25TdGF0ZScsIEpTT04uc3RyaW5naWZ5KGN1cnJlbnRTdGF0ZSkpO1xuXG4gICAgLy8gQ2xlYXIgc2Vzc2lvblxuICAgIGNsZWFyU2Vzc2lvbigpO1xuXG4gICAgLy8gT25seSByZWRpcmVjdCBpZiB3ZSdyZSBub3QgYWxyZWFkeSBvbiB0aGUgbGFuZGluZyBwYWdlXG4gICAgY29uc3QgY3VycmVudFVybCA9IG5ldyBVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuICAgIGlmICghY3VycmVudFVybC5zZWFyY2hQYXJhbXMuaGFzKCdyZXR1cm4nKSkge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBgLz9yZXR1cm49JHtlbmNvZGVVUklDb21wb25lbnQoY3VycmVudFN0YXRlLmxhc3RVcmwpfWA7XG4gICAgfVxuICB9LCB1bmRlZmluZWQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJTZXNzaW9uKCkge1xuICBjb25zb2xlLmxvZygnW1Nlc3Npb25dIENsZWFyaW5nIHNlc3Npb24gc3RvcmFnZScpO1xuICBzYWZlU3RvcmFnZU9wKCgpID0+IHtcbiAgICBzdG9yYWdlPy5yZW1vdmVJdGVtKFNFU1NJT05fQ09ORklHLlNUT1JBR0VfS0VZKTtcbiAgfSwgdW5kZWZpbmVkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUxhc3RBY3RpdmUoKSB7XG4gIHJldHVybiBzYWZlU3RvcmFnZU9wKCgpID0+IHtcbiAgICBjb25zdCBzdG9yZWREYXRhID0gc3RvcmFnZT8uZ2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSk7XG4gICAgaWYgKCFzdG9yZWREYXRhKSB7XG4gICAgICBjb25zb2xlLmxvZygnW1Nlc3Npb25dIE5vIHNlc3Npb24gdG8gdXBkYXRlIGxhc3RBY3RpdmUnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2Vzc2lvbiA9IEpTT04ucGFyc2Uoc3RvcmVkRGF0YSk7XG4gICAgICBzZXNzaW9uLmxhc3RBY3RpdmUgPSBEYXRlLm5vdygpO1xuICAgICAgc3RvcmFnZT8uc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xuICAgICAgY29uc29sZS5sb2coJ1tTZXNzaW9uXSBTdWNjZXNzZnVsbHkgdXBkYXRlZCBsYXN0QWN0aXZlJyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1Nlc3Npb25dIEZhaWxlZCB0byB1cGRhdGUgbGFzdEFjdGl2ZTonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9LCBmYWxzZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVNlc3Npb25JZCgpOiBzdHJpbmcge1xuICByZXR1cm4gYCR7RGF0ZS5ub3coKX0tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcbn1cblxuLy8gVXBkYXRlIHNlc3Npb24gd2l0aCBsb2NhdGlvblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVNlc3Npb25Mb2NhdGlvbihsb2NhdGlvbjogeyBsYXRpdHVkZTogbnVtYmVyOyBsb25naXR1ZGU6IG51bWJlciB9KSB7XG4gIGNvbnN0IHNlc3Npb24gPSBnZXRTdG9yZWRTZXNzaW9uKCk7XG4gIGlmICghc2Vzc2lvbikgcmV0dXJuO1xuXG4gIHNlc3Npb24ubG9jYXRpb24gPSBsb2NhdGlvbjtcbiAgc2FmZVN0b3JhZ2VPcCgoKSA9PiB7XG4gICAgc3RvcmFnZT8uc2V0SXRlbShTRVNTSU9OX0NPTkZJRy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xuICB9LCB1bmRlZmluZWQpO1xufVxuIl0sIm5hbWVzIjpbIlNUQUdFX0xJTUlUUyIsIlNFU1NJT05fQ09ORklHIiwiU1RPUkFHRV9LRVkiLCJBQlNPTFVURV9USU1FT1VUIiwiSU5BQ1RJVklUWV9USU1FT1VUIiwiV0FSTklOR19CRUZPUkVfVElNRU9VVCIsIk1BWF9UT1RBTF9JTlBVVFMiLCJQQVlNRU5UX1JFRl9LRVkiLCJnZXRTdG9yYWdlIiwid2luZG93Iiwic2Vzc2lvblN0b3JhZ2UiLCJzdG9yYWdlIiwic2FmZVN0b3JhZ2VPcCIsIm9wZXJhdGlvbiIsImRlZmF1bHRWYWx1ZSIsImVycm9yIiwiY29uc29sZSIsImluaXRpYWxpemVTZXNzaW9uIiwibm93IiwiRGF0ZSIsImV4aXN0aW5nU2Vzc2lvbiIsInN0b3JlZCIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJsYXN0QWN0aXZlIiwiZXhwaXJlc0F0Iiwic3RhZ2VQcm9tcHRzIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInVuZGVmaW5lZCIsInNlc3Npb25JZCIsImdlbmVyYXRlU2Vzc2lvbklkIiwic2Vzc2lvbiIsInN0YXJ0VGltZSIsImRlc3RpbmF0aW9uIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInByZWZlcmVuY2VzIiwiYnVkZ2V0IiwibGFuZ3VhZ2UiLCJ0cmFuc3BvcnQiLCJsb2NhdGlvbiIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwic2F2ZWRQbGFjZXMiLCJjdXJyZW50U3RhZ2UiLCJ0b3RhbFByb21wdHMiLCJzYXZlZFBsYWNlc0NvdW50IiwiaXNQYWlkIiwicGF5bWVudFJlZmVyZW5jZSIsImdldFN0b3JlZFNlc3Npb24iLCJzdG9yZWREYXRhIiwibG9nIiwiZ2V0U3RvcmVkTWV0cmljcyIsImludGVyYWN0aW9uIiwicGxhY2VzIiwic2F2ZWRDb3VudCIsInBheW1lbnQiLCJzdGF0dXMiLCJyZWZlcmVuY2UiLCJ0aW1lc3RhbXAiLCJwYXltZW50VGltZXN0YW1wIiwicGFyYW1ldGVycyIsImRhdGVzIiwic3RhcnQiLCJlbmQiLCJ1cGRhdGVTdG9yZWRNZXRyaWNzIiwiaW5jcmVtZW50UHJvbXB0IiwiaW5jcmVtZW50U2F2ZWRQbGFjZXMiLCJzdGFnZSIsImNoZWNrSW5wdXRMaW1pdHMiLCJ3aXRoaW5TdGFnZUxpbWl0IiwibWF4UHJvbXB0cyIsIndpdGhpblRvdGFsTGltaXQiLCJzdGFnZUlucHV0Q291bnQiLCJ0b3RhbElucHV0Q291bnQiLCJzZXRQYXltZW50U3RhdHVzIiwiZ2V0UGF5bWVudFN0YXR1cyIsInNldFBheW1lbnRSZWZlcmVuY2UiLCJnZXRQYXltZW50UmVmZXJlbmNlIiwiY2xlYXJQYXltZW50UmVmZXJlbmNlIiwiZ2V0UGF5bWVudFJlZmVyZW5jZUlkIiwic2V0UGF5bWVudFJlZmVyZW5jZUlkIiwicmVmZXJlbmNlSWQiLCJjaGVja1Nlc3Npb24iLCJjdXJyZW50U2Vzc2lvbiIsIm5ld1Nlc3Npb24iLCJ0b1N0cmluZyIsImNoZWNrU2Vzc2lvbldpdGhXYXJuaW5nIiwiaXNWYWxpZCIsInNob3VsZFdhcm4iLCJ0aW1lTGVmdCIsImNoZWNrU2Vzc2lvblZhbGlkaXR5IiwidG9JU09TdHJpbmciLCJ0aW1lVGlsbEV4cGlyeSIsImluYWN0aXZlVGltZSIsImFic29sdXRlVGltZW91dCIsImluYWN0aXZpdHlUaW1lb3V0IiwiZGlmZiIsImNsZWFyU2Vzc2lvbiIsImhhbmRsZVNlc3Npb25FeHBpcnkiLCJwYXRobmFtZSIsImN1cnJlbnRTdGF0ZSIsIm1lc3NhZ2VzIiwiZ2V0U2F2ZWRQbGFjZXMiLCJsYXN0VXJsIiwiY3VycmVudFVybCIsIlVSTCIsImhyZWYiLCJzZWFyY2hQYXJhbXMiLCJoYXMiLCJlbmNvZGVVUklDb21wb25lbnQiLCJyZW1vdmVJdGVtIiwidXBkYXRlTGFzdEFjdGl2ZSIsIk1hdGgiLCJyYW5kb20iLCJzdWJzdHIiLCJ1cGRhdGVTZXNzaW9uTG9jYXRpb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./utils/session-manager.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fchat%2Findex.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();